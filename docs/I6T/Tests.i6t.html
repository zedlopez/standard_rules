<!doctype html>
<html lang="en">
<meta charset="utf-8">
<head><title>Tests</title>
  <style>
li { padding-bottom: .16rem; padding-top: .16rem; }
ul.unloaded { list-style-type: none; margin-top: 0; margin-bottom: 0; padding-left: 1rem; }
details summary { 
  cursor: pointer;
}
a { text-decoration: none;
padding-bottom: .5px;
border-bottom: 1px dotted black;
}
span.th, span.td { display: table-cell; }
span.td { padding-left: 2rem; padding-top: .1rem; padding-bottom: .1rem; }
span.th { width:4rem; text-align: right; }
td { padding-bottom: .16rem; padding-top: .16rem; }
span.tr { display: table-row; }
.pre-lines { font-family: monospace; margin-left: 3rem; line-height: 1.5rem; }
h1 { margin: 0; }
.fixed { font-family: monospace; background-color: #e7e7d7; }
.em { font-style: italic; }
.center { text-align: center; }
    body { font-family: sans-serif; margin: .75rem 0 3rem 3rem; background-color: #fafaf0; width: 80rem; }
    .pre { font-family: monospace; margin: auto; width: 80rem; }
#front_matter,.text { width: 48rem; }
/* h3 { margin-top: 1.5rem; padding-top: 1.5rem; }*/
.text { border-bottom: .5px solid black; border-top: .5px solid black; margin-top: 1rem;
padding-bottom: .5rem; margin-bottom: 1.5rem; margin-top: 1.75rem; padding-top: .25rem;}
footer { margin-top: 3rem; padding-top: 1rem; border-top: .5px solid black; margin-bottom: 0;}
/*.subtitle { font-weight: bold; font-size: 1.2rem; }*/
.dstring { font-weight: bold;
  color: #095097; }
.sstring { font-weight: bold;
  color: #095097; }
.comment {  
  color: #156D15; } /* #207D20; */
td.content { padding-right: 2rem; vertical-align: top;}
header { border-bottom: 1px solid black; padding-top: .75rem; padding-bottom: .75rem; margin-bottom: 1rem;}
    </style>
</head>
<body>
<header>
<h1>I6 Template Layer</h1>
<div class="subtitle"><a href="http://inform7.com/">Inform 7 6M62</a> &bull; <a href="./index.html">Contents</a> &bull; <a href="./Introduction.i6t.html">Introduction</a> 
&bull; <a href="fn_index.html">Function Index</a> 
&bull; <a href="rules_index.html">Rules Index</a> 
</div></header>
<div id="front_matter">
<h2><a href="./Tests.i6t.txt">Tests.i6t</a></h2><details><summary>Tests contents</summary><ul class="unloaded"><li><a href="./Tests.i6t.html#tests-abstract-command">Abstract Command</a></li><li><a href="./Tests.i6t.html#tests-actions-command">Actions Command</a></li><li><a href="./Tests.i6t.html#tests-gonear-command">Gonear Command</a></li><li><a href="./Tests.i6t.html#tests-purloin-command">Purloin Command</a></li><li><a href="./Tests.i6t.html#tests-random-command">Random Command</a></li><li><a href="./Tests.i6t.html#tests-relations-command">Relations Command</a></li><li><a href="./Tests.i6t.html#tests-responses-command">Responses Command</a></li><li><a href="./Tests.i6t.html#tests-rules-command">Rules Command</a></li><li><a href="./Tests.i6t.html#tests-scenes-command">Scenes Command</a></li><li><a href="./Tests.i6t.html#tests-scope-command">Scope Command</a></li><li><a href="./Tests.i6t.html#tests-showheap-command">Showheap Command</a></li><li><a href="./Tests.i6t.html#tests-showme-command">ShowMe Command</a></li><li><a href="./Tests.i6t.html#tests-showverb-command">Showverb Command</a></li><li><a href="./Tests.i6t.html#tests-test-command">Test Command</a></li><li><a href="./Tests.i6t.html#tests-trace-command">Trace Command</a></li><li><a href="./Tests.i6t.html#tests-tree-command">Tree Command</a></li><li><a href="./Tests.i6t.html#tests-grammar">Grammar</a></li></ul></details><h3 id="tests-abstract-command">Abstract Command.</h3><p><p> The code below is compiled only if the symbol <span class="fixed">DEBUG</span> is defined, which it always is for normal runs in the Inform user interface, but not for Release runs.<p></p><p> Not all of these commands are documented; this is intentional. They may be changed in name or function. This is all of the testing commands except for the GLKLIST command, which is in Glulx.i6t (and does not exist when the target VM is the Z-machine).<p></p><p> We take the commands in alphabetical order, beginning with ABSTRACT, which moves an object to a new position in the object tree.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line22">22</span><span class="td">[ XAbstractSub;</span></span>
<span class="tr"><span class="th" id="line23">23</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (XTestMove(noun, second)) return;</span></span>
<span class="tr"><span class="th" id="line24">24</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;move noun to second;</span></span>
<span class="tr"><span class="th" id="line25">25</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;<span class="dstring">&quot;[Abstracted.]&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line26">26</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line27">27</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line28">28</span><span class="td">[ XTestMove obj dest;</span></span>
<span class="tr"><span class="th" id="line29">29</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (obj &lt;= InformLibrary) <span class="dstring">&quot;[Cant move &quot;</span>, (name) obj, <span class="dstring">&quot;: its a system object.]&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line30">30</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (obj.component_parent) <span class="dstring">&quot;[Cant move &quot;</span>, (name) obj, <span class="dstring">&quot;: its part of &quot;</span>,</span></span>
<span class="tr"><span class="th" id="line31">31</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(the) obj.component_parent, <span class="dstring">&quot;.]&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line32">32</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while (dest) {</span></span>
<span class="tr"><span class="th" id="line33">33</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (dest == obj) <span class="dstring">&quot;[Cant move &quot;</span>, (name) obj, <span class="dstring">&quot;: it would contain itself.]&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line34">34</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dest = CoreOfParentOfCoreOf(dest);</span></span>
<span class="tr"><span class="th" id="line35">35</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line36">36</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line37">37</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-actions-command">Actions Command.</h3><p><p> ACTIONS turns tracing of actions on.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line43">43</span><span class="td">[ ActionsOnSub; trace_actions = 1; say__p = 1; <span class="dstring">&quot;Actions listing on.&quot;</span>; ];</span></span>
<span class="tr"><span class="th" id="line44">44</span><span class="td">[ ActionsOffSub; trace_actions = 0; say__p = 1; <span class="dstring">&quot;Actions listing off.&quot;</span>; ];</span></span>
</div><div class='text'>
<h3 id="tests-gonear-command">Gonear Command.</h3><p><p> GONEAR teleports the player to the vicinity of some named item.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line50">50</span><span class="td">[ GonearSub;</span></span>
<span class="tr"><span class="th" id="line51">51</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;PlayerTo(LocationOf(noun));</span></span>
<span class="tr"><span class="th" id="line52">52</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-purloin-command">Purloin Command.</h3><p><p> To PURLOIN is to acquire something without reference to any rules on accessibility.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line58">58</span><span class="td">[ XPurloinSub;</span></span>
<span class="tr"><span class="th" id="line59">59</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (XTestMove(noun, player)) return;</span></span>
<span class="tr"><span class="th" id="line60">60</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;move noun to player; give noun moved ~concealed;</span></span>
<span class="tr"><span class="th" id="line61">61</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;say__p = 1;</span></span>
<span class="tr"><span class="th" id="line62">62</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;<span class="dstring">&quot;[Purloined.]&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line63">63</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-random-command">Random Command.</h3><p><p> RANDOM forces the random-number generator to a predictable seed value.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line69">69</span><span class="td">[ PredictableSub;</span></span>
<span class="tr"><span class="th" id="line70">70</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;VM_Seed_RNG(-100);</span></span>
<span class="tr"><span class="th" id="line71">71</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;say__p = 1;</span></span>
<span class="tr"><span class="th" id="line72">72</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;<span class="dstring">&quot;[Random number generator now predictable.]&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line73">73</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-relations-command">Relations Command.</h3><p><p> RELATIONS lists the current state of the mutable relations.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line79">79</span><span class="td">[ ShowRelationsSub;</span></span>
<span class="tr"><span class="th" id="line80">80</span><span class="td">&nbsp;&nbsp;&nbsp;IterateRelations(ShowOneRelation);</span></span>
<span class="tr"><span class="th" id="line81">81</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line82">82</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line83">83</span><span class="td">[ ShowOneRelation rel;</span></span>
<span class="tr"><span class="th" id="line84">84</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if ((RlnGetF(rel, RR_PERMISSIONS)) &amp; (RELS_SHOW)) {</span></span>
<span class="tr"><span class="th" id="line85">85</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(RlnGetF(rel, RR_HANDLER))(rel, RELS_SHOW);</span></span>
<span class="tr"><span class="th" id="line86">86</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line87">87</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-responses-command">Responses Command.</h3><p><p> RESPONSES lists the known responses.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line93">93</span><span class="td">Global suppress_text_substitution = false;</span></span>
<span class="tr"><span class="th" id="line94">94</span><span class="td">[ ShowResponsesSub a i j reg wd set_mode;</span></span>
<span class="tr"><span class="th" id="line95">95</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (NO_RESPONSES == 0) <span class="dstring">&quot;There are no lettered responses.&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line96">96</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;wn = 2;</span></span>
<span class="tr"><span class="th" id="line97">97</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (NextWordStopped() == <span class="sstring">&#39;now&#39;</span>) set_mode = 1; else wn--;</span></span>
<span class="tr"><span class="th" id="line98">98</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (NextWordStopped() == <span class="sstring">&#39;set&#39;</span>) set_mode = 2; else wn--;</span></span>
<span class="tr"><span class="th" id="line99">99</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;wd = NextWordStopped(); wn--;</span></span>
<span class="tr"><span class="th" id="line100">100</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (wd == <span class="sstring">&#39;all&#39;</span>) reg = 0;</span></span>
<span class="tr"><span class="th" id="line101">101</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;else {</span></span>
<span class="tr"><span class="th" id="line102">102</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reg = -1;</span></span>
<span class="tr"><span class="th" id="line103">103</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (wd ~= -1) reg = TryNumber(wn);</span></span>
<span class="tr"><span class="th" id="line104">104</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (reg &lt; 0) {</span></span>
<span class="tr"><span class="th" id="line105">105</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;say__p = 1;</span></span>
<span class="tr"><span class="th" id="line106">106</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;&gt;--&gt; The following sets of responses are available:^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line107">107</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;    RESPONSES ALL^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line108">108</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line109">109</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line110">110</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for (a=0, i=1, j=0: ResponseDivisions--&gt;a: a=a+3, i++) {</span></span>
<span class="tr"><span class="th" id="line111">111</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ResponseDivisions--&gt;a ~= EMPTY_TEXT_PACKED) j++;</span></span>
<span class="tr"><span class="th" id="line112">112</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((reg == 0) || (reg == j)) {</span></span>
<span class="tr"><span class="th" id="line113">113</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ResponseDivisions--&gt;a ~= EMPTY_TEXT_PACKED) {</span></span>
<span class="tr"><span class="th" id="line114">114</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (set_mode) {</span></span>
<span class="tr"><span class="th" id="line115">115</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;[&quot;</span>, (string) ResponseDivisions--&gt;a, <span class="dstring">&quot;]^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line116">116</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></span>
<span class="tr"><span class="th" id="line117">117</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (string) ResponseDivisions--&gt;a, <span class="dstring">&quot;:^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line118">118</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line119">119</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line120">120</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShowResponsesRange(ResponseDivisions--&gt;(a+1), ResponseDivisions--&gt;(a+2), set_mode);</span></span>
<span class="tr"><span class="th" id="line121">121</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line122">122</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (reg &lt; 0) {</span></span>
<span class="tr"><span class="th" id="line123">123</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ResponseDivisions--&gt;a ~= EMPTY_TEXT_PACKED) {</span></span>
<span class="tr"><span class="th" id="line124">124</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;    RESPONSES &quot;</span>, j, <span class="dstring">&quot;: &quot;</span>, (string) ResponseDivisions--&gt;a, <span class="dstring">&quot;^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line125">125</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line126">126</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line127">127</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line128">128</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line129">129</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line130">130</span><span class="td">[ ShowResponsesRange from to set_mode i;</span></span>
<span class="tr"><span class="th" id="line131">131</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;say__p = 1;</span></span>
<span class="tr"><span class="th" id="line132">132</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for (i=from: i&lt;=to: i++) {</span></span>
<span class="tr"><span class="th" id="line133">133</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch (set_mode) {</span></span>
<span class="tr"><span class="th" id="line134">134</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: print <span class="dstring">&quot;now &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line135">135</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: ;</span></span>
<span class="tr"><span class="th" id="line136">136</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0: print <span class="dstring">&quot;    &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line137">137</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line138">138</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (PrintResponse) i;</span></span>
<span class="tr"><span class="th" id="line139">139</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch (set_mode) {</span></span>
<span class="tr"><span class="th" id="line140">140</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: print <span class="dstring">&quot; is &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line141">141</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: print <span class="dstring">&quot; is &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line142">142</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0: print <span class="dstring">&quot;: &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line143">143</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line144">144</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suppress_text_substitution = true;</span></span>
<span class="tr"><span class="th" id="line145">145</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CarryOutActivity(PRINTING_RESPONSE_ACT, i);</span></span>
<span class="tr"><span class="th" id="line146">146</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suppress_text_substitution = false;</span></span>
<span class="tr"><span class="th" id="line147">147</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch (set_mode) {</span></span>
<span class="tr"><span class="th" id="line148">148</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: print <span class="dstring">&quot;;&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line149">149</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: print <span class="dstring">&quot;.&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line150">150</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line151">151</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line152">152</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line153">153</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-rules-command">Rules Command.</h3><p><p> RULES changes the level of rule tracing.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line159">159</span><span class="td">[ RulesOnSub;</span></span>
<span class="tr"><span class="th" id="line160">160</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;debug_rules = 1; say__p = 1;</span></span>
<span class="tr"><span class="th" id="line161">161</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;<span class="dstring">&quot;Rules tracing now switched on. Type ~rules off~ to switch it off again,</span></span></span>
<span class="tr"><span class="th" id="line162">162</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or ~rules all~ to include even rules which do not apply.&quot;;</span></span>
<span class="tr"><span class="th" id="line163">163</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line164">164</span><span class="td">[ RulesAllSub;</span></span>
<span class="tr"><span class="th" id="line165">165</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;debug_rules = 2; say__p = 1;</span></span>
<span class="tr"><span class="th" id="line166">166</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;<span class="dstring">&quot;Rules tracing now switched to ~all~. Type ~rules off~ to switch it off again.&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line167">167</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line168">168</span><span class="td">[ RulesOffSub;</span></span>
<span class="tr"><span class="th" id="line169">169</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;debug_rules = 0; say__p = 1;</span></span>
<span class="tr"><span class="th" id="line170">170</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;<span class="dstring">&quot;Rules tracing now switched off. Type ~rules~ to switch it on again.&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line171">171</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-scenes-command">Scenes Command.</h3><p><p> SCENES switches scene-change tracing on or off, and also shows the current position.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line177">177</span><span class="td">[ ScenesOnSub;</span></span>
<span class="tr"><span class="th" id="line178">178</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;debug_scenes = 1;</span></span>
<span class="tr"><span class="th" id="line179">179</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;ShowSceneStatus(); say__p = 1;</span></span>
<span class="tr"><span class="th" id="line180">180</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;<span class="dstring">&quot;(Scene monitoring now switched on. Type ~scenes off~ to switch it off again.)&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line181">181</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line182">182</span><span class="td">[ ScenesOffSub;</span></span>
<span class="tr"><span class="th" id="line183">183</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;debug_scenes = 0; say__p = 1;</span></span>
<span class="tr"><span class="th" id="line184">184</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;<span class="dstring">&quot;(Scene monitoring now switched off. Type ~scenes~ to switch it on again.)&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line185">185</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-scope-command">Scope Command.</h3><p><p> SCOPE prints a numbered list of all objects in scope to the player.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line191">191</span><span class="td">Global x_scope_count;</span></span>
<span class="tr"><span class="th" id="line192">192</span><span class="td">[ ScopeSub;</span></span>
<span class="tr"><span class="th" id="line193">193</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;x_scope_count = 0;</span></span>
<span class="tr"><span class="th" id="line194">194</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;LoopOverScope(Print_ScL, noun);</span></span>
<span class="tr"><span class="th" id="line195">195</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (x_scope_count == 0) <span class="dstring">&quot;Nothing is in scope.&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line196">196</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line197">197</span><span class="td">[ Print_ScL obj; print_ret ++x_scope_count, <span class="dstring">&quot;: &quot;</span>, (a) obj, <span class="dstring">&quot; (&quot;</span>, obj, <span class="dstring">&quot;)&quot;</span>; ];</span></span>
</div><div class='text'>
<h3 id="tests-showheap-command">Showheap Command.</h3><p><p> SHOWHEAP is for debugging the memory heap, and is intended for Inform maintainers rather than users.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line204">204</span><span class="td">[ ShowHeapSub;</span></span>
<span class="tr"><span class="th" id="line205">205</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;HeapDebug();</span></span>
<span class="tr"><span class="th" id="line206">206</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-showme-command">ShowMe Command.</h3><p><p> SHOWME is probably the most useful testing command: it shows the state of the current room, or a named item.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line213">213</span><span class="td">[ ShowMeSub t_0 na;</span></span>
<span class="tr"><span class="th" id="line214">214</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;t_0 = noun;</span></span>
<span class="tr"><span class="th" id="line215">215</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (noun == nothing) noun = real_location;</span></span>
<span class="tr"><span class="th" id="line216">216</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ShowMeRecursively(noun, 0, (noun == real_location))) {</span></span>
<span class="tr"><span class="th" id="line217">217</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (noun == real_location)</span></span>
<span class="tr"><span class="th" id="line218">218</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;* denotes things which are not in scope^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line219">219</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line220">220</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (t_0 ofclass K2_thing) {</span></span>
<span class="tr"><span class="th" id="line221">221</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;location:&quot;</span>; ShowRLocation(noun, true); print <span class="dstring">&quot;^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line222">222</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line223">223</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{-call:PL::Showme::compile_SHOWME_details}</span></span>
<span class="tr"><span class="th" id="line224">224</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line225">225</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line226">226</span><span class="td">[ ShowRLocation obj top;</span></span>
<span class="tr"><span class="th" id="line227">227</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (obj ofclass K1_room) return;</span></span>
<span class="tr"><span class="th" id="line228">228</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot; &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line229">229</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (parent(obj)) {</span></span>
<span class="tr"><span class="th" id="line230">230</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (obj has worn) print <span class="dstring">&quot;worn by &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line231">231</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</span></span>
<span class="tr"><span class="th" id="line232">232</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (parent(obj) has animate) print <span class="dstring">&quot;carried by &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line233">233</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (parent(obj) has container) print <span class="dstring">&quot;in &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line234">234</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (parent(obj) ofclass K1_room) print <span class="dstring">&quot;in &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line235">235</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (parent(obj) has supporter) print <span class="dstring">&quot;on &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line236">236</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line237">237</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (the) parent(obj);</span></span>
<span class="tr"><span class="th" id="line238">238</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShowRLocation(parent(obj));</span></span>
<span class="tr"><span class="th" id="line239">239</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></span>
<span class="tr"><span class="th" id="line240">240</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (obj.component_parent) {</span></span>
<span class="tr"><span class="th" id="line241">241</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (top == false) print <span class="dstring">&quot;, which is &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line242">242</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;part of &quot;</span>, (the) obj.component_parent;</span></span>
<span class="tr"><span class="th" id="line243">243</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShowRLocation(obj.component_parent);</span></span>
<span class="tr"><span class="th" id="line244">244</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line245">245</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else print <span class="dstring">&quot;out of play&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line246">246</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line247">247</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line248">248</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line249">249</span><span class="td">[ ShowMeRecursively obj depth f c i k;</span></span>
<span class="tr"><span class="th" id="line250">250</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;spaces(2*depth);</span></span>
<span class="tr"><span class="th" id="line251">251</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (f &amp;&amp; (depth &gt; 0) &amp;&amp; (TestScope(obj, player) == false)) { print <span class="dstring">&quot;*&quot;</span>; c = true; }</span></span>
<span class="tr"><span class="th" id="line252">252</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print (name) obj;</span></span>
<span class="tr"><span class="th" id="line253">253</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (depth &gt; 0) {</span></span>
<span class="tr"><span class="th" id="line254">254</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (obj.component_parent) print <span class="dstring">&quot; (part of &quot;</span>, (name) obj.component_parent, <span class="dstring">&quot;)&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line255">255</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (obj has worn) print <span class="dstring">&quot; (worn)&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line256">256</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line257">257</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (obj provides KD_Count) {</span></span>
<span class="tr"><span class="th" id="line258">258</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k = KindHierarchy--&gt;((obj.KD_Count)*2);</span></span>
<span class="tr"><span class="th" id="line259">259</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((k ~= K2_thing) || (depth==0)) {</span></span>
<span class="tr"><span class="th" id="line260">260</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot; - &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line261">261</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (k == K4_door or K5_container) {</span></span>
<span class="tr"><span class="th" id="line262">262</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (obj has transparent) print <span class="dstring">&quot;transparent &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line263">263</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (obj has locked) print <span class="dstring">&quot;locked &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line264">264</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if (obj has open) print <span class="dstring">&quot;open &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line265">265</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else print <span class="dstring">&quot;closed &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line266">266</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line267">267</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (I7_Kind_Name) k;</span></span>
<span class="tr"><span class="th" id="line268">268</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line269">269</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line270">270</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line271">271</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (obj.component_child) c = c | ShowMeRecursively(obj.component_child, depth+2, f);</span></span>
<span class="tr"><span class="th" id="line272">272</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if ((depth&gt;0) &amp;&amp; (obj.component_sibling))</span></span>
<span class="tr"><span class="th" id="line273">273</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c = c | ShowMeRecursively(obj.component_sibling, depth, f);</span></span>
<span class="tr"><span class="th" id="line274">274</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (child(obj)) c = c | ShowMeRecursively(child(obj), depth+2, f);</span></span>
<span class="tr"><span class="th" id="line275">275</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if ((depth&gt;0) &amp;&amp; (sibling(obj))) c = c | ShowMeRecursively(sibling(obj), depth, f);</span></span>
<span class="tr"><span class="th" id="line276">276</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return c;</span></span>
<span class="tr"><span class="th" id="line277">277</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line278">278</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line279">279</span><span class="td">[ AllowInShowme pr;</span></span>
<span class="tr"><span class="th" id="line280">280</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (pr == workflag or concealed or mentioned) rfalse;</span></span>
<span class="tr"><span class="th" id="line281">281</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;rtrue;</span></span>
<span class="tr"><span class="th" id="line282">282</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-showverb-command">Showverb Command.</h3><p><p> SHOWVERB is a holdover from old I6 days, but still quite useful. It writes out the I6 command verb grammar for the supplied command.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line289">289</span><span class="td">[ ShowVerbSub address lines meta i x;</span></span>
<span class="tr"><span class="th" id="line290">290</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;wn = 2; x = NextWordStopped();</span></span>
<span class="tr"><span class="th" id="line291">291</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (x == 0 || ((x-&gt;#dict_par1) &amp; 1) == 0)</span></span>
<span class="tr"><span class="th" id="line292">292</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="dstring">&quot;Try typing ~showverb~ and then the name of a verb.&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line293">293</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;meta = ((x-&gt;#dict_par1) &amp; 2)/2;</span></span>
<span class="tr"><span class="th" id="line294">294</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;i = DictionaryWordToVerbNum(x);</span></span>
<span class="tr"><span class="th" id="line295">295</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;address = VM_CommandTableAddress(i);</span></span>
<span class="tr"><span class="th" id="line296">296</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;lines = address-&gt;0;</span></span>
<span class="tr"><span class="th" id="line297">297</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;address++;</span></span>
<span class="tr"><span class="th" id="line298">298</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;Verb &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line299">299</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (meta) print <span class="dstring">&quot;meta &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line300">300</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;VM_PrintCommandWords(i);</span></span>
<span class="tr"><span class="th" id="line301">301</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line302">302</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (lines == 0) print <span class="dstring">&quot;has no grammar lines.^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line303">303</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for (: lines&gt;0 : lines--) {</span></span>
<span class="tr"><span class="th" id="line304">304</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;address = UnpackGrammarLine(address);</span></span>
<span class="tr"><span class="th" id="line305">305</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;    &quot;</span>; DebugGrammarLine(); new_line;</span></span>
<span class="tr"><span class="th" id="line306">306</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line307">307</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;ParaContent();</span></span>
<span class="tr"><span class="th" id="line308">308</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line309">309</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line310">310</span><span class="td">[ DebugGrammarLine pcount;</span></span>
<span class="tr"><span class="th" id="line311">311</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot; * &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line312">312</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for (: line_token--&gt;pcount ~= ENDIT_TOKEN : pcount++) {</span></span>
<span class="tr"><span class="th" id="line313">313</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((line_token--&gt;pcount)-&gt;0 &amp; $10) print <span class="dstring">&quot;/ &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line314">314</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (DebugToken) line_token--&gt;pcount, <span class="dstring">&quot; &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line315">315</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line316">316</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;-&gt; &quot;</span>, (DebugAction) action_to_be;</span></span>
<span class="tr"><span class="th" id="line317">317</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (action_reversed) print <span class="dstring">&quot; reverse&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line318">318</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line319">319</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line320">320</span><span class="td">[ DebugToken token;</span></span>
<span class="tr"><span class="th" id="line321">321</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;AnalyseToken(token);</span></span>
<span class="tr"><span class="th" id="line322">322</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;switch (found_ttype) {</span></span>
<span class="tr"><span class="th" id="line323">323</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ILLEGAL_TT:</span></span>
<span class="tr"><span class="th" id="line324">324</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;&lt;illegal token number &quot;</span>, token, <span class="dstring">&quot;&gt;&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line325">325</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELEMENTARY_TT:</span></span>
<span class="tr"><span class="th" id="line326">326</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch (found_tdata) {</span></span>
<span class="tr"><span class="th" id="line327">327</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOUN_TOKEN:           print <span class="dstring">&quot;noun&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line328">328</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HELD_TOKEN:           print <span class="dstring">&quot;held&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line329">329</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MULTI_TOKEN:          print <span class="dstring">&quot;multi&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line330">330</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MULTIHELD_TOKEN:      print <span class="dstring">&quot;multiheld&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line331">331</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MULTIEXCEPT_TOKEN:    print <span class="dstring">&quot;multiexcept&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line332">332</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MULTIINSIDE_TOKEN:    print <span class="dstring">&quot;multiinside&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line333">333</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CREATURE_TOKEN:       print <span class="dstring">&quot;creature&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line334">334</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPECIAL_TOKEN:        print <span class="dstring">&quot;special&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line335">335</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER_TOKEN:         print <span class="dstring">&quot;number&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line336">336</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOPIC_TOKEN:          print <span class="dstring">&quot;topic&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line337">337</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIT_TOKEN:          print <span class="dstring">&quot;END&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line338">338</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line339">339</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PREPOSITION_TT:</span></span>
<span class="tr"><span class="th" id="line340">340</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;&quot;</span>, (address) found_tdata, <span class="dstring">&quot;&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line341">341</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ROUTINE_FILTER_TT:</span></span>
<span class="tr"><span class="th" id="line342">342</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;noun=Routine(&quot;</span>, found_tdata, <span class="dstring">&quot;)&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line343">343</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ATTR_FILTER_TT:</span></span>
<span class="tr"><span class="th" id="line344">344</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (DebugAttribute) found_tdata;</span></span>
<span class="tr"><span class="th" id="line345">345</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCOPE_TT:</span></span>
<span class="tr"><span class="th" id="line346">346</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;scope=Routine(&quot;</span>, found_tdata, <span class="dstring">&quot;)&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line347">347</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPR_TT:</span></span>
<span class="tr"><span class="th" id="line348">348</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;Routine(&quot;</span>, found_tdata, <span class="dstring">&quot;)&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line349">349</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line350">350</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-test-command">Test Command.</h3><p><p> TEST runs a short script of commands from the source text.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line356">356</span><span class="td">#Iftrue ({-value:NUMBER_CREATED(test_scenario)} &gt; 0);</span></span>
<span class="tr"><span class="th" id="line357">357</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line358">358</span><span class="td">[ TestScriptSub;</span></span>
<span class="tr"><span class="th" id="line359">359</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;switch(special_word) {</span></span>
<span class="tr"><span class="th" id="line360">360</span><span class="td">{-call:PL::Parsing::TestScripts::compile_switch}</span></span>
<span class="tr"><span class="th" id="line361">361</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;default:</span></span>
<span class="tr"><span class="th" id="line362">362</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;&gt;--&gt; The following tests are available:^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line363">363</span><span class="td">{-call:PL::Parsing::TestScripts::compile_printout}</span></span>
<span class="tr"><span class="th" id="line364">364</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line365">365</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line366">366</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line367">367</span><span class="td">#ifdef TARGET_GLULX;</span></span>
<span class="tr"><span class="th" id="line368">368</span><span class="td">Constant TEST_STACK_SIZE = 128;</span></span>
<span class="tr"><span class="th" id="line369">369</span><span class="td">#ifnot;</span></span>
<span class="tr"><span class="th" id="line370">370</span><span class="td">Constant TEST_STACK_SIZE = 48;</span></span>
<span class="tr"><span class="th" id="line371">371</span><span class="td">#endif;</span></span>
<span class="tr"><span class="th" id="line372">372</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line373">373</span><span class="td">Array test_stack --&gt; TEST_STACK_SIZE;</span></span>
<span class="tr"><span class="th" id="line374">374</span><span class="td">Global test_sp = 0;</span></span>
<span class="tr"><span class="th" id="line375">375</span><span class="td">[ TestStart T R l k;</span></span>
<span class="tr"><span class="th" id="line376">376</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (test_sp &gt;= TEST_STACK_SIZE) <span class="dstring">&quot;&gt;--&gt; Testing too many levels deep&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line377">377</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;test_stack--&gt;test_sp = T;</span></span>
<span class="tr"><span class="th" id="line378">378</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;test_stack--&gt;(test_sp+1) = 0;</span></span>
<span class="tr"><span class="th" id="line379">379</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;test_stack--&gt;(test_sp+3) = l;</span></span>
<span class="tr"><span class="th" id="line380">380</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;test_sp = test_sp + 4;</span></span>
<span class="tr"><span class="th" id="line381">381</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if ((R--&gt;0) &amp;&amp; (R--&gt;0 ~= real_location)) {</span></span>
<span class="tr"><span class="th" id="line382">382</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;(first moving to &quot;</span>, (name) R--&gt;0, <span class="dstring">&quot;)^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line383">383</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PlayerTo(R--&gt;0, 1);</span></span>
<span class="tr"><span class="th" id="line384">384</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line385">385</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;k=1;</span></span>
<span class="tr"><span class="th" id="line386">386</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while (R--&gt;k) {</span></span>
<span class="tr"><span class="th" id="line387">387</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (R--&gt;k notin player) {</span></span>
<span class="tr"><span class="th" id="line388">388</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;(first acquiring &quot;</span>, (the) R--&gt;k, <span class="dstring">&quot;)^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line389">389</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;move R--&gt;k to player;</span></span>
<span class="tr"><span class="th" id="line390">390</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line391">391</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k++;</span></span>
<span class="tr"><span class="th" id="line392">392</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line393">393</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;(Testing.)^&quot;</span>; say__p = 1;</span></span>
<span class="tr"><span class="th" id="line394">394</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line395">395</span><span class="td">[ TestKeyboardPrimitive a_buffer a_table p i j l spaced ch;</span></span>
<span class="tr"><span class="th" id="line396">396</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (test_sp == 0) {</span></span>
<span class="tr"><span class="th" id="line397">397</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test_stack--&gt;2 = 1;</span></span>
<span class="tr"><span class="th" id="line398">398</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return VM_ReadKeyboard(a_buffer, a_table);</span></span>
<span class="tr"><span class="th" id="line399">399</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line400">400</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;else {</span></span>
<span class="tr"><span class="th" id="line401">401</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p = test_stack--&gt;(test_sp-4);</span></span>
<span class="tr"><span class="th" id="line402">402</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i = test_stack--&gt;(test_sp-3);</span></span>
<span class="tr"><span class="th" id="line403">403</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l = test_stack--&gt;(test_sp-1);</span></span>
<span class="tr"><span class="th" id="line404">404</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;[&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line405">405</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print test_stack--&gt;2;</span></span>
<span class="tr"><span class="th" id="line406">406</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;] &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line407">407</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test_stack--&gt;2 = test_stack--&gt;2 + 1;</span></span>
<span class="tr"><span class="th" id="line408">408</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;style bold;</span></span>
<span class="tr"><span class="th" id="line409">409</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while ((i &lt; l) &amp;&amp; (p-&gt;i ~= <span class="sstring">&#39;/&#39;</span>)) {</span></span>
<span class="tr"><span class="th" id="line410">410</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ch = p-&gt;i;</span></span>
<span class="tr"><span class="th" id="line411">411</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (spaced || (ch ~= <span class="sstring">&#39; &#39;</span>)) {</span></span>
<span class="tr"><span class="th" id="line412">412</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((p-&gt;i == <span class="sstring">&#39;[&#39;</span>) &amp;&amp; (p-&gt;(i+1) == <span class="sstring">&#39;/&#39;</span>) &amp;&amp; (p-&gt;(i+2) == <span class="sstring">&#39;]&#39;</span>)) {</span></span>
<span class="tr"><span class="th" id="line413">413</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ch = <span class="sstring">&#39;/&#39;</span>; i = i+2;</span></span>
<span class="tr"><span class="th" id="line414">414</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line415">415</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_buffer-&gt;(j+WORDSIZE) = ch;</span></span>
<span class="tr"><span class="th" id="line416">416</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print (char) ch;</span></span>
<span class="tr"><span class="th" id="line417">417</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i++; j++;</span></span>
<span class="tr"><span class="th" id="line418">418</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;spaced = true;</span></span>
<span class="tr"><span class="th" id="line419">419</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else i++;</span></span>
<span class="tr"><span class="th" id="line420">420</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line421">421</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;style roman;</span></span>
<span class="tr"><span class="th" id="line422">422</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line423">423</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ifdef TARGET_ZCODE;</span></span>
<span class="tr"><span class="th" id="line424">424</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_buffer-&gt;1 = j;</span></span>
<span class="tr"><span class="th" id="line425">425</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#ifnot; <span class="comment">! TARGET_GLULX</span></span></span>
<span class="tr"><span class="th" id="line426">426</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_buffer--&gt;0 = j;</span></span>
<span class="tr"><span class="th" id="line427">427</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#endif;</span></span>
<span class="tr"><span class="th" id="line428">428</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VM_Tokenise(a_buffer, a_table);</span></span>
<span class="tr"><span class="th" id="line429">429</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (p-&gt;i == <span class="sstring">&#39;/&#39;</span>) i++;</span></span>
<span class="tr"><span class="th" id="line430">430</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (i &gt;= l) {</span></span>
<span class="tr"><span class="th" id="line431">431</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test_sp = test_sp - 4;</span></span>
<span class="tr"><span class="th" id="line432">432</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else test_stack--&gt;(test_sp-3) = i;</span></span>
<span class="tr"><span class="th" id="line433">433</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line434">434</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line435">435</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line436">436</span><span class="td">#IFNOT;</span></span>
<span class="tr"><span class="th" id="line437">437</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line438">438</span><span class="td">[ TestScriptSub;</span></span>
<span class="tr"><span class="th" id="line439">439</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;<span class="dstring">&quot;&gt;--&gt; No test scripts exist for this game.&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line440">440</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line441">441</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line442">442</span><span class="td">#ENDIF;</span></span>
</div><div class='text'>
<h3 id="tests-trace-command">Trace Command.</h3><p><p> Another holdover from I6: TRACE sets the level of parser tracing, on a scale of 0 (off, the default) to 5.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line449">449</span><span class="td">[ TraceOnSub; parser_trace=1; say__p = 1; <span class="dstring">&quot;[Trace on.]&quot;</span>; ];</span></span>
<span class="tr"><span class="th" id="line450">450</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line451">451</span><span class="td">[ TraceLevelSub;</span></span>
<span class="tr"><span class="th" id="line452">452</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;parser_trace = parsed_number; say__p = 1;</span></span>
<span class="tr"><span class="th" id="line453">453</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;[Parser tracing set to level &quot;</span>, parser_trace, <span class="dstring">&quot;.]^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line454">454</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line455">455</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line456">456</span><span class="td">[ TraceOffSub; parser_trace=0; say__p = 1; <span class="dstring">&quot;Trace off.&quot;</span>; ];</span></span>
</div><div class='text'>
<h3 id="tests-tree-command">Tree Command.</h3><p><p> TREE prints out the I6 object tree, though this is not always very helpful in I7 terms. It should arguably be withdrawn, but doesn&#39;t seem to do any harm.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line463">463</span><span class="td">[ XTreeSub i;</span></span>
<span class="tr"><span class="th" id="line464">464</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (noun == 0) {</span></span>
<span class="tr"><span class="th" id="line465">465</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;objectloop (i)</span></span>
<span class="tr"><span class="th" id="line466">466</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (i ofclass Object &amp;&amp; parent(i) == 0) XObj(i);</span></span>
<span class="tr"><span class="th" id="line467">467</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line468">468</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;else XObj(noun,1);</span></span>
<span class="tr"><span class="th" id="line469">469</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line470">470</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line471">471</span><span class="td">[ XObj obj f;</span></span>
<span class="tr"><span class="th" id="line472">472</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (parent(obj) == 0) print (name) obj; else print (a) obj;</span></span>
<span class="tr"><span class="th" id="line473">473</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot; (&quot;</span>, obj, <span class="dstring">&quot;) &quot;</span>;</span></span>
<span class="tr"><span class="th" id="line474">474</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (f == 1 &amp;&amp; parent(obj) ~= 0)</span></span>
<span class="tr"><span class="th" id="line475">475</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print <span class="dstring">&quot;(in &quot;</span>, (name) parent(obj), <span class="dstring">&quot; &quot;</span>, parent(obj), <span class="dstring">&quot;)&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line476">476</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line477">477</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (child(obj) == 0) rtrue;</span></span>
<span class="tr"><span class="th" id="line478">478</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if (obj == Class)</span></span>
<span class="tr"><span class="th" id="line479">479</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteListFrom(child(obj), NEWLINE_BIT+INDENT_BIT+ALWAYS_BIT+NOARTICLE_BIT, 1);</span></span>
<span class="tr"><span class="th" id="line480">480</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;else</span></span>
<span class="tr"><span class="th" id="line481">481</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteListFrom(child(obj), NEWLINE_BIT+INDENT_BIT+ALWAYS_BIT+FULLINV_BIT, 1);</span></span>
<span class="tr"><span class="th" id="line482">482</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="tests-grammar">Grammar.</h3><p><p> In the old I6 parser, testing commands had their own scope hardwired in to the code: this worked by comparing the verb command word directly against <span class="fixed">&#39;scope&#39;</span> and the like. That would go wrong if the testing commands were translated into other languages, and was a crude design at best. The following scope token is better: using this token instead of <span class="fixed">multi</span> provides a noun with universal scope (but restricted to I7 objects, so I6 pseudo-objects like <span class="fixed">compass</span> are not picked up) and able to accept multiple objects.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line494">494</span><span class="td">[ testcommandnoun obj o2;</span></span>
<span class="tr"><span class="th" id="line495">495</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;switch (scope_stage) {</span></span>
<span class="tr"><span class="th" id="line496">496</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1: rtrue; <span class="comment">! allow multiple objects</span></span></span>
<span class="tr"><span class="th" id="line497">497</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2: objectloop (obj)</span></span>
<span class="tr"><span class="th" id="line498">498</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((obj ofclass Object) &amp;&amp; (obj provides KD_Count))</span></span>
<span class="tr"><span class="th" id="line499">499</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PlaceInScope(obj, true);</span></span>
<span class="tr"><span class="th" id="line500">500</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3: print <span class="dstring">&quot;There seems to be no such object anywhere in the model world.^&quot;</span>;</span></span>
<span class="tr"><span class="th" id="line501">501</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line502">502</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line503">503</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line504">504</span><span class="td">{-testing-command:abstract}</span></span>
<span class="tr"><span class="th" id="line505">505</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* scope=testcommandnoun <span class="sstring">&#39;to&#39;</span> scope=testcommandnoun -&gt; XAbstract;</span></span>
<span class="tr"><span class="th" id="line506">506</span><span class="td">{-testing-command:actions}</span></span>
<span class="tr"><span class="th" id="line507">507</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; ActionsOn</span></span>
<span class="tr"><span class="th" id="line508">508</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;on&#39;</span>                                      -&gt; ActionsOn</span></span>
<span class="tr"><span class="th" id="line509">509</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;off&#39;</span>                                     -&gt; ActionsOff;</span></span>
<span class="tr"><span class="th" id="line510">510</span><span class="td">{-testing-command:gonear}</span></span>
<span class="tr"><span class="th" id="line511">511</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* scope=testcommandnoun                     -&gt; Gonear;</span></span>
<span class="tr"><span class="th" id="line512">512</span><span class="td">{-testing-command:purloin}</span></span>
<span class="tr"><span class="th" id="line513">513</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* scope=testcommandnoun                     -&gt; XPurloin;</span></span>
<span class="tr"><span class="th" id="line514">514</span><span class="td">{-testing-command:random}</span></span>
<span class="tr"><span class="th" id="line515">515</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; Predictable;</span></span>
<span class="tr"><span class="th" id="line516">516</span><span class="td">{-testing-command:relations}</span></span>
<span class="tr"><span class="th" id="line517">517</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; ShowRelations;</span></span>
<span class="tr"><span class="th" id="line518">518</span><span class="td">{-testing-command:responses}</span></span>
<span class="tr"><span class="th" id="line519">519</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; ShowResponses</span></span>
<span class="tr"><span class="th" id="line520">520</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* special                                   -&gt; ShowResponses</span></span>
<span class="tr"><span class="th" id="line521">521</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;now&#39;</span> special                             -&gt; ShowResponses</span></span>
<span class="tr"><span class="th" id="line522">522</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;set&#39;</span> special                             -&gt; ShowResponses;</span></span>
<span class="tr"><span class="th" id="line523">523</span><span class="td">{-testing-command:rules}</span></span>
<span class="tr"><span class="th" id="line524">524</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; RulesOn</span></span>
<span class="tr"><span class="th" id="line525">525</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;all&#39;</span>                                     -&gt; RulesAll</span></span>
<span class="tr"><span class="th" id="line526">526</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;on&#39;</span>                                      -&gt; RulesOn</span></span>
<span class="tr"><span class="th" id="line527">527</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;off&#39;</span>                                     -&gt; RulesOff;</span></span>
<span class="tr"><span class="th" id="line528">528</span><span class="td">{-testing-command:scenes}</span></span>
<span class="tr"><span class="th" id="line529">529</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; ScenesOn</span></span>
<span class="tr"><span class="th" id="line530">530</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;on&#39;</span>                                      -&gt; ScenesOn</span></span>
<span class="tr"><span class="th" id="line531">531</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;off&#39;</span>                                     -&gt; ScenesOff;</span></span>
<span class="tr"><span class="th" id="line532">532</span><span class="td">{-testing-command:scope}</span></span>
<span class="tr"><span class="th" id="line533">533</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; Scope</span></span>
<span class="tr"><span class="th" id="line534">534</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* scope=testcommandnoun                     -&gt; Scope;</span></span>
<span class="tr"><span class="th" id="line535">535</span><span class="td">{-testing-command:showheap}</span></span>
<span class="tr"><span class="th" id="line536">536</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; ShowHeap;</span></span>
<span class="tr"><span class="th" id="line537">537</span><span class="td">{-testing-command:showme}</span></span>
<span class="tr"><span class="th" id="line538">538</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; ShowMe</span></span>
<span class="tr"><span class="th" id="line539">539</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* scope=testcommandnoun                     -&gt; ShowMe;</span></span>
<span class="tr"><span class="th" id="line540">540</span><span class="td">{-testing-command:showverb}</span></span>
<span class="tr"><span class="th" id="line541">541</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* special                                   -&gt; Showverb;</span></span>
<span class="tr"><span class="th" id="line542">542</span><span class="td">{-testing-command:test}</span></span>
<span class="tr"><span class="th" id="line543">543</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; TestScript</span></span>
<span class="tr"><span class="th" id="line544">544</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* special                                   -&gt; TestScript;</span></span>
<span class="tr"><span class="th" id="line545">545</span><span class="td">{-testing-command:trace}</span></span>
<span class="tr"><span class="th" id="line546">546</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; TraceOn</span></span>
<span class="tr"><span class="th" id="line547">547</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* number                                    -&gt; TraceLevel</span></span>
<span class="tr"><span class="th" id="line548">548</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;on&#39;</span>                                      -&gt; TraceOn</span></span>
<span class="tr"><span class="th" id="line549">549</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* <span class="sstring">&#39;off&#39;</span>                                     -&gt; TraceOff;</span></span>
<span class="tr"><span class="th" id="line550">550</span><span class="td">{-testing-command:tree}</span></span>
<span class="tr"><span class="th" id="line551">551</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*                                           -&gt; XTree</span></span>
<span class="tr"><span class="th" id="line552">552</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;* scope=testcommandnoun                     -&gt; XTree;</span></span>
</div><footer><p><em>From I6T lib 6/12N &copy; Graham Nelson and published under the <a href="https://github.com/zedlopez/standard_rules/blob/main/LICENSE.md">Artistic License 2.0</a>. Distributed with <a href="http://inform7.com/">Inform 7 6M62</a>.</em></p></footer></body></html>
