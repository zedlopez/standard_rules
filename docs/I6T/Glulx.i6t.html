<!doctype html>
<html lang="en">
<meta charset="utf-8">
<head><title>Glulx</title>
  <style>
span.th, span.td { display: table-cell; }
span.td { padding-left: 2rem; }
span.th { width:4rem; text-align: right; }
span.tr { display: table-row;     counter-increment: linenum; }
span.line_no::before {
    content: counter(linenum);
    text-align: right;
    display: block;
    font-family: monospace;
    font-weight: normal;
}
h1 { margin: 0; }
.fixed { font-family: monospace }
.em { font-style: italic; }
.center { text-align: center; }
    body { font-family: sans-serif; margin: 1.5rem 0 0 3rem; background-color: #fafaf0; width: 80rem; }
    .pre { font-family: monospace; margin: auto; width: 80rem; }
#front_matter,.text { width: 50rem; }
.text { border-bottom: .5px solid black; border-top: .5px solid black; margin-top: 1rem;
padding-bottom: 1rem; margin-bottom: 2rem; }
/*.subtitle { font-weight: bold; font-size: 1.2rem; }*/
    </style>
</head>
<body>
<header>
<h1>I6 Template Layer</h1>
<div class="subtitle"><a href="http://inform7.com/">Inform 7 6M62</a> &bull; <a href="./index.html">Index</a> &bull; <a href="./Introduction.i6t.html">Introduction</a></div><hr></header>
<div id="front_matter">
<h2><a href="./Glulx.i6t">Glulx.i6t</a></h2><h3 id="#glulx-summary">Summary.</h3><p><p> This segment closely parallels <a href="./ZMachine.i6t.html">ZMachine.i6t</a>, which provides exactly equivalent functionality (indeed, usually the same-named functions and in the same order) for the Z-machine VM. This is intended to make the rest of the template code independent of the choice of VM, although that is more of an ideal than a reality, because there are so many fiddly differences in some of the grammar and dictionary tables that it is not really practical for the parser (for instance) to call VM-neutral routines to get the data it wants out of these arrays.<p></p><p><h3 id="#glulx-variables-and-arrays">Variables and Arrays.</h3><p><p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line21">21</span><span class="td">Array&nbsp;gg_event&nbsp;--&gt;&nbsp;4;</span></span>
<span class="tr"><span class="th" id="line22">22</span><span class="td">Array&nbsp;gg_arguments&nbsp;buffer&nbsp;28;</span></span>
<span class="tr"><span class="th" id="line23">23</span><span class="td">Global&nbsp;gg_mainwin&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line24">24</span><span class="td">Global&nbsp;gg_statuswin&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line25">25</span><span class="td">Global&nbsp;gg_quotewin&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line26">26</span><span class="td">Global&nbsp;gg_scriptfref&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line27">27</span><span class="td">Global&nbsp;gg_scriptstr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line28">28</span><span class="td">Global&nbsp;gg_savestr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line29">29</span><span class="td">Global&nbsp;gg_commandstr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line30">30</span><span class="td">Global&nbsp;gg_command_reading&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;true&nbsp;if&nbsp;gg_commandstr&nbsp;is&nbsp;being&nbsp;replayed</span></span>
<span class="tr"><span class="th" id="line31">31</span><span class="td">Global&nbsp;gg_foregroundchan&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line32">32</span><span class="td">Global&nbsp;gg_backgroundchan&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line33">33</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line34">34</span><span class="td">Constant&nbsp;GLK_NULL&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line35">35</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line36">36</span><span class="td">Constant&nbsp;INPUT_BUFFER_LEN&nbsp;=&nbsp;260;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;No&nbsp;extra&nbsp;byte&nbsp;necessary</span></span>
<span class="tr"><span class="th" id="line37">37</span><span class="td">Constant&nbsp;MAX_BUFFER_WORDS&nbsp;=&nbsp;20;</span></span>
<span class="tr"><span class="th" id="line38">38</span><span class="td">Constant&nbsp;PARSE_BUFFER_LEN&nbsp;=&nbsp;61;</span></span>
<span class="tr"><span class="th" id="line39">39</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line40">40</span><span class="td">Array&nbsp;&nbsp;buffer&nbsp;&nbsp;&nbsp;&nbsp;buffer&nbsp;INPUT_BUFFER_LEN;</span></span>
<span class="tr"><span class="th" id="line41">41</span><span class="td">Array&nbsp;&nbsp;buffer2&nbsp;&nbsp;&nbsp;buffer&nbsp;INPUT_BUFFER_LEN;</span></span>
<span class="tr"><span class="th" id="line42">42</span><span class="td">Array&nbsp;&nbsp;buffer3&nbsp;&nbsp;&nbsp;buffer&nbsp;INPUT_BUFFER_LEN;</span></span>
<span class="tr"><span class="th" id="line43">43</span><span class="td">Array&nbsp;&nbsp;parse&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;PARSE_BUFFER_LEN;</span></span>
<span class="tr"><span class="th" id="line44">44</span><span class="td">Array&nbsp;&nbsp;parse2&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;PARSE_BUFFER_LEN;</span></span>
</div><div class='text'>
<h3 id="#glulx-infglk">Infglk.</h3><p><p> This section is a verbatim copy of an invaluable I6 header file originally put together by John Cater but now maintained by Andrew Plotkin. The routines are convenient to have on hand, and also provide a canonical set of I6 names for the many gestalt and other codes.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line53">53</span><span class="td">!&nbsp;infglk.h&nbsp;--&nbsp;auto-generated&nbsp;by&nbsp;parse_dispatch.py.</span></span>
<span class="tr"><span class="th" id="line54">54</span><span class="td">!&nbsp;Generated&nbsp;for&nbsp;Glk&nbsp;API&nbsp;version&nbsp;0.7.4</span></span>
<span class="tr"><span class="th" id="line55">55</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line56">56</span><span class="td">Constant&nbsp;evtype_Arrange&nbsp;=&nbsp;5;</span></span>
<span class="tr"><span class="th" id="line57">57</span><span class="td">Constant&nbsp;evtype_CharInput&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line58">58</span><span class="td">Constant&nbsp;evtype_Hyperlink&nbsp;=&nbsp;8;</span></span>
<span class="tr"><span class="th" id="line59">59</span><span class="td">Constant&nbsp;evtype_LineInput&nbsp;=&nbsp;3;</span></span>
<span class="tr"><span class="th" id="line60">60</span><span class="td">Constant&nbsp;evtype_MouseInput&nbsp;=&nbsp;4;</span></span>
<span class="tr"><span class="th" id="line61">61</span><span class="td">Constant&nbsp;evtype_None&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line62">62</span><span class="td">Constant&nbsp;evtype_Redraw&nbsp;=&nbsp;6;</span></span>
<span class="tr"><span class="th" id="line63">63</span><span class="td">Constant&nbsp;evtype_SoundNotify&nbsp;=&nbsp;7;</span></span>
<span class="tr"><span class="th" id="line64">64</span><span class="td">Constant&nbsp;evtype_Timer&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line65">65</span><span class="td">Constant&nbsp;evtype_VolumeNotify&nbsp;=&nbsp;9;</span></span>
<span class="tr"><span class="th" id="line66">66</span><span class="td">Constant&nbsp;filemode_Read&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line67">67</span><span class="td">Constant&nbsp;filemode_ReadWrite&nbsp;=&nbsp;3;</span></span>
<span class="tr"><span class="th" id="line68">68</span><span class="td">Constant&nbsp;filemode_Write&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line69">69</span><span class="td">Constant&nbsp;filemode_WriteAppend&nbsp;=&nbsp;5;</span></span>
<span class="tr"><span class="th" id="line70">70</span><span class="td">Constant&nbsp;fileusage_BinaryMode&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line71">71</span><span class="td">Constant&nbsp;fileusage_Data&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line72">72</span><span class="td">Constant&nbsp;fileusage_InputRecord&nbsp;=&nbsp;3;</span></span>
<span class="tr"><span class="th" id="line73">73</span><span class="td">Constant&nbsp;fileusage_SavedGame&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line74">74</span><span class="td">Constant&nbsp;fileusage_TextMode&nbsp;=&nbsp;256;</span></span>
<span class="tr"><span class="th" id="line75">75</span><span class="td">Constant&nbsp;fileusage_Transcript&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line76">76</span><span class="td">Constant&nbsp;fileusage_TypeMask&nbsp;=&nbsp;15;</span></span>
<span class="tr"><span class="th" id="line77">77</span><span class="td">Constant&nbsp;gestalt_CharInput&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line78">78</span><span class="td">Constant&nbsp;gestalt_CharOutput&nbsp;=&nbsp;3;</span></span>
<span class="tr"><span class="th" id="line79">79</span><span class="td">Constant&nbsp;gestalt_CharOutput_ApproxPrint&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line80">80</span><span class="td">Constant&nbsp;gestalt_CharOutput_CannotPrint&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line81">81</span><span class="td">Constant&nbsp;gestalt_CharOutput_ExactPrint&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line82">82</span><span class="td">Constant&nbsp;gestalt_DateTime&nbsp;=&nbsp;20;</span></span>
<span class="tr"><span class="th" id="line83">83</span><span class="td">Constant&nbsp;gestalt_DrawImage&nbsp;=&nbsp;7;</span></span>
<span class="tr"><span class="th" id="line84">84</span><span class="td">Constant&nbsp;gestalt_Graphics&nbsp;=&nbsp;6;</span></span>
<span class="tr"><span class="th" id="line85">85</span><span class="td">Constant&nbsp;gestalt_GraphicsCharInput&nbsp;=&nbsp;23;</span></span>
<span class="tr"><span class="th" id="line86">86</span><span class="td">Constant&nbsp;gestalt_GraphicsTransparency&nbsp;=&nbsp;14;</span></span>
<span class="tr"><span class="th" id="line87">87</span><span class="td">Constant&nbsp;gestalt_HyperlinkInput&nbsp;=&nbsp;12;</span></span>
<span class="tr"><span class="th" id="line88">88</span><span class="td">Constant&nbsp;gestalt_Hyperlinks&nbsp;=&nbsp;11;</span></span>
<span class="tr"><span class="th" id="line89">89</span><span class="td">Constant&nbsp;gestalt_LineInput&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line90">90</span><span class="td">Constant&nbsp;gestalt_LineInputEcho&nbsp;=&nbsp;17;</span></span>
<span class="tr"><span class="th" id="line91">91</span><span class="td">Constant&nbsp;gestalt_LineTerminatorKey&nbsp;=&nbsp;19;</span></span>
<span class="tr"><span class="th" id="line92">92</span><span class="td">Constant&nbsp;gestalt_LineTerminators&nbsp;=&nbsp;18;</span></span>
<span class="tr"><span class="th" id="line93">93</span><span class="td">Constant&nbsp;gestalt_MouseInput&nbsp;=&nbsp;4;</span></span>
<span class="tr"><span class="th" id="line94">94</span><span class="td">Constant&nbsp;gestalt_ResourceStream&nbsp;=&nbsp;22;</span></span>
<span class="tr"><span class="th" id="line95">95</span><span class="td">Constant&nbsp;gestalt_Sound&nbsp;=&nbsp;8;</span></span>
<span class="tr"><span class="th" id="line96">96</span><span class="td">Constant&nbsp;gestalt_Sound2&nbsp;=&nbsp;21;</span></span>
<span class="tr"><span class="th" id="line97">97</span><span class="td">Constant&nbsp;gestalt_SoundMusic&nbsp;=&nbsp;13;</span></span>
<span class="tr"><span class="th" id="line98">98</span><span class="td">Constant&nbsp;gestalt_SoundNotify&nbsp;=&nbsp;10;</span></span>
<span class="tr"><span class="th" id="line99">99</span><span class="td">Constant&nbsp;gestalt_SoundVolume&nbsp;=&nbsp;9;</span></span>
<span class="tr"><span class="th" id="line100">100</span><span class="td">Constant&nbsp;gestalt_Timer&nbsp;=&nbsp;5;</span></span>
<span class="tr"><span class="th" id="line101">101</span><span class="td">Constant&nbsp;gestalt_Unicode&nbsp;=&nbsp;15;</span></span>
<span class="tr"><span class="th" id="line102">102</span><span class="td">Constant&nbsp;gestalt_UnicodeNorm&nbsp;=&nbsp;16;</span></span>
<span class="tr"><span class="th" id="line103">103</span><span class="td">Constant&nbsp;gestalt_Version&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line104">104</span><span class="td">Constant&nbsp;imagealign_InlineCenter&nbsp;=&nbsp;3;</span></span>
<span class="tr"><span class="th" id="line105">105</span><span class="td">Constant&nbsp;imagealign_InlineDown&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line106">106</span><span class="td">Constant&nbsp;imagealign_MarginLeft&nbsp;=&nbsp;4;</span></span>
<span class="tr"><span class="th" id="line107">107</span><span class="td">Constant&nbsp;imagealign_MarginRight&nbsp;=&nbsp;5;</span></span>
<span class="tr"><span class="th" id="line108">108</span><span class="td">Constant&nbsp;imagealign_InlineUp&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line109">109</span><span class="td">Constant&nbsp;keycode_Delete&nbsp;=&nbsp;4294967289;</span></span>
<span class="tr"><span class="th" id="line110">110</span><span class="td">Constant&nbsp;keycode_Down&nbsp;=&nbsp;4294967291;</span></span>
<span class="tr"><span class="th" id="line111">111</span><span class="td">Constant&nbsp;keycode_End&nbsp;=&nbsp;4294967283;</span></span>
<span class="tr"><span class="th" id="line112">112</span><span class="td">Constant&nbsp;keycode_Escape&nbsp;=&nbsp;4294967288;</span></span>
<span class="tr"><span class="th" id="line113">113</span><span class="td">Constant&nbsp;keycode_Func1&nbsp;=&nbsp;4294967279;</span></span>
<span class="tr"><span class="th" id="line114">114</span><span class="td">Constant&nbsp;keycode_Func10&nbsp;=&nbsp;4294967270;</span></span>
<span class="tr"><span class="th" id="line115">115</span><span class="td">Constant&nbsp;keycode_Func11&nbsp;=&nbsp;4294967269;</span></span>
<span class="tr"><span class="th" id="line116">116</span><span class="td">Constant&nbsp;keycode_Func12&nbsp;=&nbsp;4294967268;</span></span>
<span class="tr"><span class="th" id="line117">117</span><span class="td">Constant&nbsp;keycode_Func2&nbsp;=&nbsp;4294967278;</span></span>
<span class="tr"><span class="th" id="line118">118</span><span class="td">Constant&nbsp;keycode_Func3&nbsp;=&nbsp;4294967277;</span></span>
<span class="tr"><span class="th" id="line119">119</span><span class="td">Constant&nbsp;keycode_Func4&nbsp;=&nbsp;4294967276;</span></span>
<span class="tr"><span class="th" id="line120">120</span><span class="td">Constant&nbsp;keycode_Func5&nbsp;=&nbsp;4294967275;</span></span>
<span class="tr"><span class="th" id="line121">121</span><span class="td">Constant&nbsp;keycode_Func6&nbsp;=&nbsp;4294967274;</span></span>
<span class="tr"><span class="th" id="line122">122</span><span class="td">Constant&nbsp;keycode_Func7&nbsp;=&nbsp;4294967273;</span></span>
<span class="tr"><span class="th" id="line123">123</span><span class="td">Constant&nbsp;keycode_Func8&nbsp;=&nbsp;4294967272;</span></span>
<span class="tr"><span class="th" id="line124">124</span><span class="td">Constant&nbsp;keycode_Func9&nbsp;=&nbsp;4294967271;</span></span>
<span class="tr"><span class="th" id="line125">125</span><span class="td">Constant&nbsp;keycode_Home&nbsp;=&nbsp;4294967284;</span></span>
<span class="tr"><span class="th" id="line126">126</span><span class="td">Constant&nbsp;keycode_Left&nbsp;=&nbsp;4294967294;</span></span>
<span class="tr"><span class="th" id="line127">127</span><span class="td">Constant&nbsp;keycode_MAXVAL&nbsp;=&nbsp;28;</span></span>
<span class="tr"><span class="th" id="line128">128</span><span class="td">Constant&nbsp;keycode_PageDown&nbsp;=&nbsp;4294967285;</span></span>
<span class="tr"><span class="th" id="line129">129</span><span class="td">Constant&nbsp;keycode_PageUp&nbsp;=&nbsp;4294967286;</span></span>
<span class="tr"><span class="th" id="line130">130</span><span class="td">Constant&nbsp;keycode_Return&nbsp;=&nbsp;4294967290;</span></span>
<span class="tr"><span class="th" id="line131">131</span><span class="td">Constant&nbsp;keycode_Right&nbsp;=&nbsp;4294967293;</span></span>
<span class="tr"><span class="th" id="line132">132</span><span class="td">Constant&nbsp;keycode_Tab&nbsp;=&nbsp;4294967287;</span></span>
<span class="tr"><span class="th" id="line133">133</span><span class="td">Constant&nbsp;keycode_Unknown&nbsp;=&nbsp;4294967295;</span></span>
<span class="tr"><span class="th" id="line134">134</span><span class="td">Constant&nbsp;keycode_Up&nbsp;=&nbsp;4294967292;</span></span>
<span class="tr"><span class="th" id="line135">135</span><span class="td">Constant&nbsp;seekmode_Current&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line136">136</span><span class="td">Constant&nbsp;seekmode_End&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line137">137</span><span class="td">Constant&nbsp;seekmode_Start&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line138">138</span><span class="td">Constant&nbsp;style_Alert&nbsp;=&nbsp;5;</span></span>
<span class="tr"><span class="th" id="line139">139</span><span class="td">Constant&nbsp;style_BlockQuote&nbsp;=&nbsp;7;</span></span>
<span class="tr"><span class="th" id="line140">140</span><span class="td">Constant&nbsp;style_Emphasized&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line141">141</span><span class="td">Constant&nbsp;style_Header&nbsp;=&nbsp;3;</span></span>
<span class="tr"><span class="th" id="line142">142</span><span class="td">Constant&nbsp;style_Input&nbsp;=&nbsp;8;</span></span>
<span class="tr"><span class="th" id="line143">143</span><span class="td">Constant&nbsp;style_NUMSTYLES&nbsp;=&nbsp;11;</span></span>
<span class="tr"><span class="th" id="line144">144</span><span class="td">Constant&nbsp;style_Normal&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line145">145</span><span class="td">Constant&nbsp;style_Note&nbsp;=&nbsp;6;</span></span>
<span class="tr"><span class="th" id="line146">146</span><span class="td">Constant&nbsp;style_Preformatted&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line147">147</span><span class="td">Constant&nbsp;style_Subheader&nbsp;=&nbsp;4;</span></span>
<span class="tr"><span class="th" id="line148">148</span><span class="td">Constant&nbsp;style_User1&nbsp;=&nbsp;9;</span></span>
<span class="tr"><span class="th" id="line149">149</span><span class="td">Constant&nbsp;style_User2&nbsp;=&nbsp;10;</span></span>
<span class="tr"><span class="th" id="line150">150</span><span class="td">Constant&nbsp;stylehint_BackColor&nbsp;=&nbsp;8;</span></span>
<span class="tr"><span class="th" id="line151">151</span><span class="td">Constant&nbsp;stylehint_Indentation&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line152">152</span><span class="td">Constant&nbsp;stylehint_Justification&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line153">153</span><span class="td">Constant&nbsp;stylehint_NUMHINTS&nbsp;=&nbsp;10;</span></span>
<span class="tr"><span class="th" id="line154">154</span><span class="td">Constant&nbsp;stylehint_Oblique&nbsp;=&nbsp;5;</span></span>
<span class="tr"><span class="th" id="line155">155</span><span class="td">Constant&nbsp;stylehint_ParaIndentation&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line156">156</span><span class="td">Constant&nbsp;stylehint_Proportional&nbsp;=&nbsp;6;</span></span>
<span class="tr"><span class="th" id="line157">157</span><span class="td">Constant&nbsp;stylehint_ReverseColor&nbsp;=&nbsp;9;</span></span>
<span class="tr"><span class="th" id="line158">158</span><span class="td">Constant&nbsp;stylehint_Size&nbsp;=&nbsp;3;</span></span>
<span class="tr"><span class="th" id="line159">159</span><span class="td">Constant&nbsp;stylehint_TextColor&nbsp;=&nbsp;7;</span></span>
<span class="tr"><span class="th" id="line160">160</span><span class="td">Constant&nbsp;stylehint_Weight&nbsp;=&nbsp;4;</span></span>
<span class="tr"><span class="th" id="line161">161</span><span class="td">Constant&nbsp;stylehint_just_Centered&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line162">162</span><span class="td">Constant&nbsp;stylehint_just_LeftFlush&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line163">163</span><span class="td">Constant&nbsp;stylehint_just_LeftRight&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line164">164</span><span class="td">Constant&nbsp;stylehint_just_RightFlush&nbsp;=&nbsp;3;</span></span>
<span class="tr"><span class="th" id="line165">165</span><span class="td">Constant&nbsp;winmethod_Above&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line166">166</span><span class="td">Constant&nbsp;winmethod_Below&nbsp;=&nbsp;3;</span></span>
<span class="tr"><span class="th" id="line167">167</span><span class="td">Constant&nbsp;winmethod_Border&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line168">168</span><span class="td">Constant&nbsp;winmethod_BorderMask&nbsp;=&nbsp;256;</span></span>
<span class="tr"><span class="th" id="line169">169</span><span class="td">Constant&nbsp;winmethod_DirMask&nbsp;=&nbsp;15;</span></span>
<span class="tr"><span class="th" id="line170">170</span><span class="td">Constant&nbsp;winmethod_DivisionMask&nbsp;=&nbsp;240;</span></span>
<span class="tr"><span class="th" id="line171">171</span><span class="td">Constant&nbsp;winmethod_Fixed&nbsp;=&nbsp;16;</span></span>
<span class="tr"><span class="th" id="line172">172</span><span class="td">Constant&nbsp;winmethod_Left&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line173">173</span><span class="td">Constant&nbsp;winmethod_NoBorder&nbsp;=&nbsp;256;</span></span>
<span class="tr"><span class="th" id="line174">174</span><span class="td">Constant&nbsp;winmethod_Proportional&nbsp;=&nbsp;32;</span></span>
<span class="tr"><span class="th" id="line175">175</span><span class="td">Constant&nbsp;winmethod_Right&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line176">176</span><span class="td">Constant&nbsp;wintype_AllTypes&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line177">177</span><span class="td">Constant&nbsp;wintype_Blank&nbsp;=&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line178">178</span><span class="td">Constant&nbsp;wintype_Graphics&nbsp;=&nbsp;5;</span></span>
<span class="tr"><span class="th" id="line179">179</span><span class="td">Constant&nbsp;wintype_Pair&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line180">180</span><span class="td">Constant&nbsp;wintype_TextBuffer&nbsp;=&nbsp;3;</span></span>
<span class="tr"><span class="th" id="line181">181</span><span class="td">Constant&nbsp;wintype_TextGrid&nbsp;=&nbsp;4;</span></span>
<span class="tr"><span class="th" id="line182">182</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line183">183</span><span class="td">[&nbsp;glk_exit&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line184">184</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_exit()</span></span>
<span class="tr"><span class="th" id="line185">185</span><span class="td">&nbsp;&nbsp;@glk&nbsp;1&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line186">186</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line187">187</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line188">188</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line189">189</span><span class="td">[&nbsp;glk_tick&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line190">190</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_tick()</span></span>
<span class="tr"><span class="th" id="line191">191</span><span class="td">&nbsp;&nbsp;@glk&nbsp;3&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line192">192</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line193">193</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line194">194</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line195">195</span><span class="td">[&nbsp;glk_gestalt&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line196">196</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_gestalt(uint,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line197">197</span><span class="td">&nbsp;&nbsp;@glk&nbsp;4&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line198">198</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line199">199</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line200">200</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line201">201</span><span class="td">[&nbsp;glk_gestalt_ext&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line202">202</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_gestalt_ext(uint,&nbsp;uint,&nbsp;uintarray,&nbsp;arraylen)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line203">203</span><span class="td">&nbsp;&nbsp;@glk&nbsp;5&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line204">204</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line205">205</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line206">206</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line207">207</span><span class="td">[&nbsp;glk_window_iterate&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line208">208</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_iterate(window,&nbsp;&amp;uint)&nbsp;=&gt;&nbsp;window</span></span>
<span class="tr"><span class="th" id="line209">209</span><span class="td">&nbsp;&nbsp;@glk&nbsp;32&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line210">210</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line211">211</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line212">212</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line213">213</span><span class="td">[&nbsp;glk_window_get_rock&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line214">214</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_get_rock(window)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line215">215</span><span class="td">&nbsp;&nbsp;@glk&nbsp;33&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line216">216</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line217">217</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line218">218</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line219">219</span><span class="td">[&nbsp;glk_window_get_root&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line220">220</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_get_root()&nbsp;=&gt;&nbsp;window</span></span>
<span class="tr"><span class="th" id="line221">221</span><span class="td">&nbsp;&nbsp;@glk&nbsp;34&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line222">222</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line223">223</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line224">224</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line225">225</span><span class="td">[&nbsp;glk_window_open&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line226">226</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_open(window,&nbsp;uint,&nbsp;uint,&nbsp;uint,&nbsp;uint)&nbsp;=&gt;&nbsp;window</span></span>
<span class="tr"><span class="th" id="line227">227</span><span class="td">&nbsp;&nbsp;@glk&nbsp;35&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line228">228</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line229">229</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line230">230</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line231">231</span><span class="td">[&nbsp;glk_window_close&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line232">232</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_close(window,&nbsp;&amp;{uint,&nbsp;uint})</span></span>
<span class="tr"><span class="th" id="line233">233</span><span class="td">&nbsp;&nbsp;@glk&nbsp;36&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line234">234</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line235">235</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line236">236</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line237">237</span><span class="td">[&nbsp;glk_window_get_size&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line238">238</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_get_size(window,&nbsp;&amp;uint,&nbsp;&amp;uint)</span></span>
<span class="tr"><span class="th" id="line239">239</span><span class="td">&nbsp;&nbsp;@glk&nbsp;37&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line240">240</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line241">241</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line242">242</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line243">243</span><span class="td">[&nbsp;glk_window_set_arrangement&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line244">244</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_set_arrangement(window,&nbsp;uint,&nbsp;uint,&nbsp;window)</span></span>
<span class="tr"><span class="th" id="line245">245</span><span class="td">&nbsp;&nbsp;@glk&nbsp;38&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line246">246</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line247">247</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line248">248</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line249">249</span><span class="td">[&nbsp;glk_window_get_arrangement&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line250">250</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_get_arrangement(window,&nbsp;&amp;uint,&nbsp;&amp;uint,&nbsp;&amp;window)</span></span>
<span class="tr"><span class="th" id="line251">251</span><span class="td">&nbsp;&nbsp;@glk&nbsp;39&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line252">252</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line253">253</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line254">254</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line255">255</span><span class="td">[&nbsp;glk_window_get_type&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line256">256</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_get_type(window)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line257">257</span><span class="td">&nbsp;&nbsp;@glk&nbsp;40&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line258">258</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line259">259</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line260">260</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line261">261</span><span class="td">[&nbsp;glk_window_get_parent&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line262">262</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_get_parent(window)&nbsp;=&gt;&nbsp;window</span></span>
<span class="tr"><span class="th" id="line263">263</span><span class="td">&nbsp;&nbsp;@glk&nbsp;41&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line264">264</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line265">265</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line266">266</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line267">267</span><span class="td">[&nbsp;glk_window_clear&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line268">268</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_clear(window)</span></span>
<span class="tr"><span class="th" id="line269">269</span><span class="td">&nbsp;&nbsp;@glk&nbsp;42&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line270">270</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line271">271</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line272">272</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line273">273</span><span class="td">[&nbsp;glk_window_move_cursor&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line274">274</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_move_cursor(window,&nbsp;uint,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line275">275</span><span class="td">&nbsp;&nbsp;@glk&nbsp;43&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line276">276</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line277">277</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line278">278</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line279">279</span><span class="td">[&nbsp;glk_window_get_stream&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line280">280</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_get_stream(window)&nbsp;=&gt;&nbsp;stream</span></span>
<span class="tr"><span class="th" id="line281">281</span><span class="td">&nbsp;&nbsp;@glk&nbsp;44&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line282">282</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line283">283</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line284">284</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line285">285</span><span class="td">[&nbsp;glk_window_set_echo_stream&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line286">286</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_set_echo_stream(window,&nbsp;stream)</span></span>
<span class="tr"><span class="th" id="line287">287</span><span class="td">&nbsp;&nbsp;@glk&nbsp;45&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line288">288</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line289">289</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line290">290</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line291">291</span><span class="td">[&nbsp;glk_window_get_echo_stream&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line292">292</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_get_echo_stream(window)&nbsp;=&gt;&nbsp;stream</span></span>
<span class="tr"><span class="th" id="line293">293</span><span class="td">&nbsp;&nbsp;@glk&nbsp;46&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line294">294</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line295">295</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line296">296</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line297">297</span><span class="td">[&nbsp;glk_set_window&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line298">298</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_set_window(window)</span></span>
<span class="tr"><span class="th" id="line299">299</span><span class="td">&nbsp;&nbsp;@glk&nbsp;47&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line300">300</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line301">301</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line302">302</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line303">303</span><span class="td">[&nbsp;glk_window_get_sibling&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line304">304</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_get_sibling(window)&nbsp;=&gt;&nbsp;window</span></span>
<span class="tr"><span class="th" id="line305">305</span><span class="td">&nbsp;&nbsp;@glk&nbsp;48&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line306">306</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line307">307</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line308">308</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line309">309</span><span class="td">[&nbsp;glk_stream_iterate&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line310">310</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_iterate(stream,&nbsp;&amp;uint)&nbsp;=&gt;&nbsp;stream</span></span>
<span class="tr"><span class="th" id="line311">311</span><span class="td">&nbsp;&nbsp;@glk&nbsp;64&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line312">312</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line313">313</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line314">314</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line315">315</span><span class="td">[&nbsp;glk_stream_get_rock&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line316">316</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_get_rock(stream)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line317">317</span><span class="td">&nbsp;&nbsp;@glk&nbsp;65&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line318">318</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line319">319</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line320">320</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line321">321</span><span class="td">[&nbsp;glk_stream_open_file&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line322">322</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_open_file(fileref,&nbsp;uint,&nbsp;uint)&nbsp;=&gt;&nbsp;stream</span></span>
<span class="tr"><span class="th" id="line323">323</span><span class="td">&nbsp;&nbsp;@glk&nbsp;66&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line324">324</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line325">325</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line326">326</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line327">327</span><span class="td">[&nbsp;glk_stream_open_memory&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line328">328</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_open_memory(nativechararray,&nbsp;arraylen,&nbsp;uint,&nbsp;uint)&nbsp;=&gt;&nbsp;stream</span></span>
<span class="tr"><span class="th" id="line329">329</span><span class="td">&nbsp;&nbsp;@glk&nbsp;67&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line330">330</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line331">331</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line332">332</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line333">333</span><span class="td">[&nbsp;glk_stream_close&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line334">334</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_close(stream,&nbsp;&amp;{uint,&nbsp;uint})</span></span>
<span class="tr"><span class="th" id="line335">335</span><span class="td">&nbsp;&nbsp;@glk&nbsp;68&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line336">336</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line337">337</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line338">338</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line339">339</span><span class="td">[&nbsp;glk_stream_set_position&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line340">340</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_set_position(stream,&nbsp;int,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line341">341</span><span class="td">&nbsp;&nbsp;@glk&nbsp;69&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line342">342</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line343">343</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line344">344</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line345">345</span><span class="td">[&nbsp;glk_stream_get_position&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line346">346</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_get_position(stream)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line347">347</span><span class="td">&nbsp;&nbsp;@glk&nbsp;70&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line348">348</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line349">349</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line350">350</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line351">351</span><span class="td">[&nbsp;glk_stream_set_current&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line352">352</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_set_current(stream)</span></span>
<span class="tr"><span class="th" id="line353">353</span><span class="td">&nbsp;&nbsp;@glk&nbsp;71&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line354">354</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line355">355</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line356">356</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line357">357</span><span class="td">[&nbsp;glk_stream_get_current&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line358">358</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_get_current()&nbsp;=&gt;&nbsp;stream</span></span>
<span class="tr"><span class="th" id="line359">359</span><span class="td">&nbsp;&nbsp;@glk&nbsp;72&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line360">360</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line361">361</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line362">362</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line363">363</span><span class="td">[&nbsp;glk_stream_open_resource&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line364">364</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_open_resource(uint,&nbsp;uint)&nbsp;=&gt;&nbsp;stream</span></span>
<span class="tr"><span class="th" id="line365">365</span><span class="td">&nbsp;&nbsp;@glk&nbsp;73&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line366">366</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line367">367</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line368">368</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line369">369</span><span class="td">[&nbsp;glk_fileref_create_temp&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line370">370</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_fileref_create_temp(uint,&nbsp;uint)&nbsp;=&gt;&nbsp;fileref</span></span>
<span class="tr"><span class="th" id="line371">371</span><span class="td">&nbsp;&nbsp;@glk&nbsp;96&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line372">372</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line373">373</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line374">374</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line375">375</span><span class="td">[&nbsp;glk_fileref_create_by_name&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line376">376</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_fileref_create_by_name(uint,&nbsp;string,&nbsp;uint)&nbsp;=&gt;&nbsp;fileref</span></span>
<span class="tr"><span class="th" id="line377">377</span><span class="td">&nbsp;&nbsp;@glk&nbsp;97&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line378">378</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line379">379</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line380">380</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line381">381</span><span class="td">[&nbsp;glk_fileref_create_by_prompt&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line382">382</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_fileref_create_by_prompt(uint,&nbsp;uint,&nbsp;uint)&nbsp;=&gt;&nbsp;fileref</span></span>
<span class="tr"><span class="th" id="line383">383</span><span class="td">&nbsp;&nbsp;@glk&nbsp;98&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line384">384</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line385">385</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line386">386</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line387">387</span><span class="td">[&nbsp;glk_fileref_destroy&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line388">388</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_fileref_destroy(fileref)</span></span>
<span class="tr"><span class="th" id="line389">389</span><span class="td">&nbsp;&nbsp;@glk&nbsp;99&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line390">390</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line391">391</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line392">392</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line393">393</span><span class="td">[&nbsp;glk_fileref_iterate&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line394">394</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_fileref_iterate(fileref,&nbsp;&amp;uint)&nbsp;=&gt;&nbsp;fileref</span></span>
<span class="tr"><span class="th" id="line395">395</span><span class="td">&nbsp;&nbsp;@glk&nbsp;100&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line396">396</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line397">397</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line398">398</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line399">399</span><span class="td">[&nbsp;glk_fileref_get_rock&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line400">400</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_fileref_get_rock(fileref)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line401">401</span><span class="td">&nbsp;&nbsp;@glk&nbsp;101&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line402">402</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line403">403</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line404">404</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line405">405</span><span class="td">[&nbsp;glk_fileref_delete_file&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line406">406</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_fileref_delete_file(fileref)</span></span>
<span class="tr"><span class="th" id="line407">407</span><span class="td">&nbsp;&nbsp;@glk&nbsp;102&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line408">408</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line409">409</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line410">410</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line411">411</span><span class="td">[&nbsp;glk_fileref_does_file_exist&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line412">412</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_fileref_does_file_exist(fileref)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line413">413</span><span class="td">&nbsp;&nbsp;@glk&nbsp;103&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line414">414</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line415">415</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line416">416</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line417">417</span><span class="td">[&nbsp;glk_fileref_create_from_fileref&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line418">418</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_fileref_create_from_fileref(uint,&nbsp;fileref,&nbsp;uint)&nbsp;=&gt;&nbsp;fileref</span></span>
<span class="tr"><span class="th" id="line419">419</span><span class="td">&nbsp;&nbsp;@glk&nbsp;104&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line420">420</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line421">421</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line422">422</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line423">423</span><span class="td">[&nbsp;glk_put_char&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line424">424</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_char(uchar)</span></span>
<span class="tr"><span class="th" id="line425">425</span><span class="td">&nbsp;&nbsp;@glk&nbsp;128&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line426">426</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line427">427</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line428">428</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line429">429</span><span class="td">[&nbsp;glk_put_char_stream&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line430">430</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_char_stream(stream,&nbsp;uchar)</span></span>
<span class="tr"><span class="th" id="line431">431</span><span class="td">&nbsp;&nbsp;@glk&nbsp;129&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line432">432</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line433">433</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line434">434</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line435">435</span><span class="td">[&nbsp;glk_put_string&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line436">436</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_string(string)</span></span>
<span class="tr"><span class="th" id="line437">437</span><span class="td">&nbsp;&nbsp;@glk&nbsp;130&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line438">438</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line439">439</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line440">440</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line441">441</span><span class="td">[&nbsp;glk_put_string_stream&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line442">442</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_string_stream(stream,&nbsp;string)</span></span>
<span class="tr"><span class="th" id="line443">443</span><span class="td">&nbsp;&nbsp;@glk&nbsp;131&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line444">444</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line445">445</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line446">446</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line447">447</span><span class="td">[&nbsp;glk_put_buffer&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line448">448</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_buffer(nativechararray,&nbsp;arraylen)</span></span>
<span class="tr"><span class="th" id="line449">449</span><span class="td">&nbsp;&nbsp;@glk&nbsp;132&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line450">450</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line451">451</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line452">452</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line453">453</span><span class="td">[&nbsp;glk_put_buffer_stream&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line454">454</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_buffer_stream(stream,&nbsp;nativechararray,&nbsp;arraylen)</span></span>
<span class="tr"><span class="th" id="line455">455</span><span class="td">&nbsp;&nbsp;@glk&nbsp;133&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line456">456</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line457">457</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line458">458</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line459">459</span><span class="td">[&nbsp;glk_set_style&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line460">460</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_set_style(uint)</span></span>
<span class="tr"><span class="th" id="line461">461</span><span class="td">&nbsp;&nbsp;@glk&nbsp;134&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line462">462</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line463">463</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line464">464</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line465">465</span><span class="td">[&nbsp;glk_set_style_stream&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line466">466</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_set_style_stream(stream,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line467">467</span><span class="td">&nbsp;&nbsp;@glk&nbsp;135&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line468">468</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line469">469</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line470">470</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line471">471</span><span class="td">[&nbsp;glk_get_char_stream&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line472">472</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_get_char_stream(stream)&nbsp;=&gt;&nbsp;int</span></span>
<span class="tr"><span class="th" id="line473">473</span><span class="td">&nbsp;&nbsp;@glk&nbsp;144&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line474">474</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line475">475</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line476">476</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line477">477</span><span class="td">[&nbsp;glk_get_line_stream&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line478">478</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_get_line_stream(stream,&nbsp;nativechararray,&nbsp;arraylen)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line479">479</span><span class="td">&nbsp;&nbsp;@glk&nbsp;145&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line480">480</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line481">481</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line482">482</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line483">483</span><span class="td">[&nbsp;glk_get_buffer_stream&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line484">484</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_get_buffer_stream(stream,&nbsp;nativechararray,&nbsp;arraylen)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line485">485</span><span class="td">&nbsp;&nbsp;@glk&nbsp;146&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line486">486</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line487">487</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line488">488</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line489">489</span><span class="td">[&nbsp;glk_char_to_lower&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line490">490</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_char_to_lower(uchar)&nbsp;=&gt;&nbsp;uchar</span></span>
<span class="tr"><span class="th" id="line491">491</span><span class="td">&nbsp;&nbsp;@glk&nbsp;160&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line492">492</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line493">493</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line494">494</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line495">495</span><span class="td">[&nbsp;glk_char_to_upper&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line496">496</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_char_to_upper(uchar)&nbsp;=&gt;&nbsp;uchar</span></span>
<span class="tr"><span class="th" id="line497">497</span><span class="td">&nbsp;&nbsp;@glk&nbsp;161&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line498">498</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line499">499</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line500">500</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line501">501</span><span class="td">[&nbsp;glk_stylehint_set&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line502">502</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stylehint_set(uint,&nbsp;uint,&nbsp;uint,&nbsp;int)</span></span>
<span class="tr"><span class="th" id="line503">503</span><span class="td">&nbsp;&nbsp;@glk&nbsp;176&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line504">504</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line505">505</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line506">506</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line507">507</span><span class="td">[&nbsp;glk_stylehint_clear&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line508">508</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stylehint_clear(uint,&nbsp;uint,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line509">509</span><span class="td">&nbsp;&nbsp;@glk&nbsp;177&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line510">510</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line511">511</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line512">512</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line513">513</span><span class="td">[&nbsp;glk_style_distinguish&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line514">514</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_style_distinguish(window,&nbsp;uint,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line515">515</span><span class="td">&nbsp;&nbsp;@glk&nbsp;178&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line516">516</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line517">517</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line518">518</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line519">519</span><span class="td">[&nbsp;glk_style_measure&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line520">520</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_style_measure(window,&nbsp;uint,&nbsp;uint,&nbsp;&amp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line521">521</span><span class="td">&nbsp;&nbsp;@glk&nbsp;179&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line522">522</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line523">523</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line524">524</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line525">525</span><span class="td">[&nbsp;glk_select&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line526">526</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_select(&amp;{uint,&nbsp;window,&nbsp;uint,&nbsp;uint})</span></span>
<span class="tr"><span class="th" id="line527">527</span><span class="td">&nbsp;&nbsp;@glk&nbsp;192&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line528">528</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line529">529</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line530">530</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line531">531</span><span class="td">[&nbsp;glk_select_poll&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line532">532</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_select_poll(&amp;{uint,&nbsp;window,&nbsp;uint,&nbsp;uint})</span></span>
<span class="tr"><span class="th" id="line533">533</span><span class="td">&nbsp;&nbsp;@glk&nbsp;193&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line534">534</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line535">535</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line536">536</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line537">537</span><span class="td">[&nbsp;glk_request_line_event&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line538">538</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_request_line_event(window,&nbsp;nativechararray,&nbsp;arraylen,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line539">539</span><span class="td">&nbsp;&nbsp;@glk&nbsp;208&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line540">540</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line541">541</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line542">542</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line543">543</span><span class="td">[&nbsp;glk_cancel_line_event&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line544">544</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_cancel_line_event(window,&nbsp;&amp;{uint,&nbsp;window,&nbsp;uint,&nbsp;uint})</span></span>
<span class="tr"><span class="th" id="line545">545</span><span class="td">&nbsp;&nbsp;@glk&nbsp;209&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line546">546</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line547">547</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line548">548</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line549">549</span><span class="td">[&nbsp;glk_request_char_event&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line550">550</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_request_char_event(window)</span></span>
<span class="tr"><span class="th" id="line551">551</span><span class="td">&nbsp;&nbsp;@glk&nbsp;210&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line552">552</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line553">553</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line554">554</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line555">555</span><span class="td">[&nbsp;glk_cancel_char_event&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line556">556</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_cancel_char_event(window)</span></span>
<span class="tr"><span class="th" id="line557">557</span><span class="td">&nbsp;&nbsp;@glk&nbsp;211&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line558">558</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line559">559</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line560">560</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line561">561</span><span class="td">[&nbsp;glk_request_mouse_event&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line562">562</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_request_mouse_event(window)</span></span>
<span class="tr"><span class="th" id="line563">563</span><span class="td">&nbsp;&nbsp;@glk&nbsp;212&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line564">564</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line565">565</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line566">566</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line567">567</span><span class="td">[&nbsp;glk_cancel_mouse_event&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line568">568</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_cancel_mouse_event(window)</span></span>
<span class="tr"><span class="th" id="line569">569</span><span class="td">&nbsp;&nbsp;@glk&nbsp;213&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line570">570</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line571">571</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line572">572</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line573">573</span><span class="td">[&nbsp;glk_request_timer_events&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line574">574</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_request_timer_events(uint)</span></span>
<span class="tr"><span class="th" id="line575">575</span><span class="td">&nbsp;&nbsp;@glk&nbsp;214&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line576">576</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line577">577</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line578">578</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line579">579</span><span class="td">[&nbsp;glk_image_get_info&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line580">580</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_image_get_info(uint,&nbsp;&amp;uint,&nbsp;&amp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line581">581</span><span class="td">&nbsp;&nbsp;@glk&nbsp;224&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line582">582</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line583">583</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line584">584</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line585">585</span><span class="td">[&nbsp;glk_image_draw&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line586">586</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_image_draw(window,&nbsp;uint,&nbsp;int,&nbsp;int)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line587">587</span><span class="td">&nbsp;&nbsp;@glk&nbsp;225&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line588">588</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line589">589</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line590">590</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line591">591</span><span class="td">[&nbsp;glk_image_draw_scaled&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line592">592</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_image_draw_scaled(window,&nbsp;uint,&nbsp;int,&nbsp;int,&nbsp;uint,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line593">593</span><span class="td">&nbsp;&nbsp;@glk&nbsp;226&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line594">594</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line595">595</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line596">596</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line597">597</span><span class="td">[&nbsp;glk_window_flow_break&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line598">598</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_flow_break(window)</span></span>
<span class="tr"><span class="th" id="line599">599</span><span class="td">&nbsp;&nbsp;@glk&nbsp;232&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line600">600</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line601">601</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line602">602</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line603">603</span><span class="td">[&nbsp;glk_window_erase_rect&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line604">604</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_erase_rect(window,&nbsp;int,&nbsp;int,&nbsp;uint,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line605">605</span><span class="td">&nbsp;&nbsp;@glk&nbsp;233&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line606">606</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line607">607</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line608">608</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line609">609</span><span class="td">[&nbsp;glk_window_fill_rect&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line610">610</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_fill_rect(window,&nbsp;uint,&nbsp;int,&nbsp;int,&nbsp;uint,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line611">611</span><span class="td">&nbsp;&nbsp;@glk&nbsp;234&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line612">612</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line613">613</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line614">614</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line615">615</span><span class="td">[&nbsp;glk_window_set_background_color&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line616">616</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_window_set_background_color(window,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line617">617</span><span class="td">&nbsp;&nbsp;@glk&nbsp;235&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line618">618</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line619">619</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line620">620</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line621">621</span><span class="td">[&nbsp;glk_schannel_iterate&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line622">622</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_iterate(schannel,&nbsp;&amp;uint)&nbsp;=&gt;&nbsp;schannel</span></span>
<span class="tr"><span class="th" id="line623">623</span><span class="td">&nbsp;&nbsp;@glk&nbsp;240&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line624">624</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line625">625</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line626">626</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line627">627</span><span class="td">[&nbsp;glk_schannel_get_rock&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line628">628</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_get_rock(schannel)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line629">629</span><span class="td">&nbsp;&nbsp;@glk&nbsp;241&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line630">630</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line631">631</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line632">632</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line633">633</span><span class="td">[&nbsp;glk_schannel_create&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line634">634</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_create(uint)&nbsp;=&gt;&nbsp;schannel</span></span>
<span class="tr"><span class="th" id="line635">635</span><span class="td">&nbsp;&nbsp;@glk&nbsp;242&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line636">636</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line637">637</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line638">638</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line639">639</span><span class="td">[&nbsp;glk_schannel_destroy&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line640">640</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_destroy(schannel)</span></span>
<span class="tr"><span class="th" id="line641">641</span><span class="td">&nbsp;&nbsp;@glk&nbsp;243&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line642">642</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line643">643</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line644">644</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line645">645</span><span class="td">[&nbsp;glk_schannel_create_ext&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line646">646</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_create_ext(uint,&nbsp;uint)&nbsp;=&gt;&nbsp;schannel</span></span>
<span class="tr"><span class="th" id="line647">647</span><span class="td">&nbsp;&nbsp;@glk&nbsp;244&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line648">648</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line649">649</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line650">650</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line651">651</span><span class="td">[&nbsp;glk_schannel_play_multi&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line652">652</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_play_multi(schannelarray,&nbsp;arraylen,&nbsp;uintarray,&nbsp;arraylen,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line653">653</span><span class="td">&nbsp;&nbsp;@glk&nbsp;247&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line654">654</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line655">655</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line656">656</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line657">657</span><span class="td">[&nbsp;glk_schannel_play&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line658">658</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_play(schannel,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line659">659</span><span class="td">&nbsp;&nbsp;@glk&nbsp;248&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line660">660</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line661">661</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line662">662</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line663">663</span><span class="td">[&nbsp;glk_schannel_play_ext&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line664">664</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_play_ext(schannel,&nbsp;uint,&nbsp;uint,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line665">665</span><span class="td">&nbsp;&nbsp;@glk&nbsp;249&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line666">666</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line667">667</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line668">668</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line669">669</span><span class="td">[&nbsp;glk_schannel_stop&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line670">670</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_stop(schannel)</span></span>
<span class="tr"><span class="th" id="line671">671</span><span class="td">&nbsp;&nbsp;@glk&nbsp;250&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line672">672</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line673">673</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line674">674</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line675">675</span><span class="td">[&nbsp;glk_schannel_set_volume&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line676">676</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_set_volume(schannel,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line677">677</span><span class="td">&nbsp;&nbsp;@glk&nbsp;251&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line678">678</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line679">679</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line680">680</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line681">681</span><span class="td">[&nbsp;glk_sound_load_hint&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line682">682</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_sound_load_hint(uint,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line683">683</span><span class="td">&nbsp;&nbsp;@glk&nbsp;252&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line684">684</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line685">685</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line686">686</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line687">687</span><span class="td">[&nbsp;glk_schannel_set_volume_ext&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line688">688</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_set_volume_ext(schannel,&nbsp;uint,&nbsp;uint,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line689">689</span><span class="td">&nbsp;&nbsp;@glk&nbsp;253&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line690">690</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line691">691</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line692">692</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line693">693</span><span class="td">[&nbsp;glk_schannel_pause&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line694">694</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_pause(schannel)</span></span>
<span class="tr"><span class="th" id="line695">695</span><span class="td">&nbsp;&nbsp;@glk&nbsp;254&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line696">696</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line697">697</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line698">698</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line699">699</span><span class="td">[&nbsp;glk_schannel_unpause&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line700">700</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_schannel_unpause(schannel)</span></span>
<span class="tr"><span class="th" id="line701">701</span><span class="td">&nbsp;&nbsp;@glk&nbsp;255&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line702">702</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line703">703</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line704">704</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line705">705</span><span class="td">[&nbsp;glk_set_hyperlink&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line706">706</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_set_hyperlink(uint)</span></span>
<span class="tr"><span class="th" id="line707">707</span><span class="td">&nbsp;&nbsp;@glk&nbsp;256&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line708">708</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line709">709</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line710">710</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line711">711</span><span class="td">[&nbsp;glk_set_hyperlink_stream&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line712">712</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_set_hyperlink_stream(stream,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line713">713</span><span class="td">&nbsp;&nbsp;@glk&nbsp;257&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line714">714</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line715">715</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line716">716</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line717">717</span><span class="td">[&nbsp;glk_request_hyperlink_event&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line718">718</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_request_hyperlink_event(window)</span></span>
<span class="tr"><span class="th" id="line719">719</span><span class="td">&nbsp;&nbsp;@glk&nbsp;258&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line720">720</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line721">721</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line722">722</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line723">723</span><span class="td">[&nbsp;glk_cancel_hyperlink_event&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line724">724</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_cancel_hyperlink_event(window)</span></span>
<span class="tr"><span class="th" id="line725">725</span><span class="td">&nbsp;&nbsp;@glk&nbsp;259&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line726">726</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line727">727</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line728">728</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line729">729</span><span class="td">[&nbsp;glk_buffer_to_lower_case_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line730">730</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_buffer_to_lower_case_uni(uintarray,&nbsp;arraylen,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line731">731</span><span class="td">&nbsp;&nbsp;@glk&nbsp;288&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line732">732</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line733">733</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line734">734</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line735">735</span><span class="td">[&nbsp;glk_buffer_to_upper_case_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line736">736</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_buffer_to_upper_case_uni(uintarray,&nbsp;arraylen,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line737">737</span><span class="td">&nbsp;&nbsp;@glk&nbsp;289&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line738">738</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line739">739</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line740">740</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line741">741</span><span class="td">[&nbsp;glk_buffer_to_title_case_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line742">742</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_buffer_to_title_case_uni(uintarray,&nbsp;arraylen,&nbsp;uint,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line743">743</span><span class="td">&nbsp;&nbsp;@glk&nbsp;290&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line744">744</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line745">745</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line746">746</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line747">747</span><span class="td">[&nbsp;glk_buffer_canon_decompose_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line748">748</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_buffer_canon_decompose_uni(uintarray,&nbsp;arraylen,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line749">749</span><span class="td">&nbsp;&nbsp;@glk&nbsp;291&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line750">750</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line751">751</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line752">752</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line753">753</span><span class="td">[&nbsp;glk_buffer_canon_normalize_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line754">754</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_buffer_canon_normalize_uni(uintarray,&nbsp;arraylen,&nbsp;uint)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line755">755</span><span class="td">&nbsp;&nbsp;@glk&nbsp;292&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line756">756</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line757">757</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line758">758</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line759">759</span><span class="td">[&nbsp;glk_put_char_uni&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line760">760</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_char_uni(uint)</span></span>
<span class="tr"><span class="th" id="line761">761</span><span class="td">&nbsp;&nbsp;@glk&nbsp;296&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line762">762</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line763">763</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line764">764</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line765">765</span><span class="td">[&nbsp;glk_put_string_uni&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line766">766</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_string_uni(unicode)</span></span>
<span class="tr"><span class="th" id="line767">767</span><span class="td">&nbsp;&nbsp;@glk&nbsp;297&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line768">768</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line769">769</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line770">770</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line771">771</span><span class="td">[&nbsp;glk_put_buffer_uni&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line772">772</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_buffer_uni(uintarray,&nbsp;arraylen)</span></span>
<span class="tr"><span class="th" id="line773">773</span><span class="td">&nbsp;&nbsp;@glk&nbsp;298&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line774">774</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line775">775</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line776">776</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line777">777</span><span class="td">[&nbsp;glk_put_char_stream_uni&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line778">778</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_char_stream_uni(stream,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line779">779</span><span class="td">&nbsp;&nbsp;@glk&nbsp;299&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line780">780</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line781">781</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line782">782</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line783">783</span><span class="td">[&nbsp;glk_put_string_stream_uni&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line784">784</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_string_stream_uni(stream,&nbsp;unicode)</span></span>
<span class="tr"><span class="th" id="line785">785</span><span class="td">&nbsp;&nbsp;@glk&nbsp;300&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line786">786</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line787">787</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line788">788</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line789">789</span><span class="td">[&nbsp;glk_put_buffer_stream_uni&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line790">790</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_put_buffer_stream_uni(stream,&nbsp;uintarray,&nbsp;arraylen)</span></span>
<span class="tr"><span class="th" id="line791">791</span><span class="td">&nbsp;&nbsp;@glk&nbsp;301&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line792">792</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line793">793</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line794">794</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line795">795</span><span class="td">[&nbsp;glk_get_char_stream_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line796">796</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_get_char_stream_uni(stream)&nbsp;=&gt;&nbsp;int</span></span>
<span class="tr"><span class="th" id="line797">797</span><span class="td">&nbsp;&nbsp;@glk&nbsp;304&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line798">798</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line799">799</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line800">800</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line801">801</span><span class="td">[&nbsp;glk_get_buffer_stream_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line802">802</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_get_buffer_stream_uni(stream,&nbsp;uintarray,&nbsp;arraylen)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line803">803</span><span class="td">&nbsp;&nbsp;@glk&nbsp;305&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line804">804</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line805">805</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line806">806</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line807">807</span><span class="td">[&nbsp;glk_get_line_stream_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line808">808</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_get_line_stream_uni(stream,&nbsp;uintarray,&nbsp;arraylen)&nbsp;=&gt;&nbsp;uint</span></span>
<span class="tr"><span class="th" id="line809">809</span><span class="td">&nbsp;&nbsp;@glk&nbsp;306&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line810">810</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line811">811</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line812">812</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line813">813</span><span class="td">[&nbsp;glk_stream_open_file_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line814">814</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_open_file_uni(fileref,&nbsp;uint,&nbsp;uint)&nbsp;=&gt;&nbsp;stream</span></span>
<span class="tr"><span class="th" id="line815">815</span><span class="td">&nbsp;&nbsp;@glk&nbsp;312&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line816">816</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line817">817</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line818">818</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line819">819</span><span class="td">[&nbsp;glk_stream_open_memory_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line820">820</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_open_memory_uni(uintarray,&nbsp;arraylen,&nbsp;uint,&nbsp;uint)&nbsp;=&gt;&nbsp;stream</span></span>
<span class="tr"><span class="th" id="line821">821</span><span class="td">&nbsp;&nbsp;@glk&nbsp;313&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line822">822</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line823">823</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line824">824</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line825">825</span><span class="td">[&nbsp;glk_stream_open_resource_uni&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line826">826</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_stream_open_resource_uni(uint,&nbsp;uint)&nbsp;=&gt;&nbsp;stream</span></span>
<span class="tr"><span class="th" id="line827">827</span><span class="td">&nbsp;&nbsp;@glk&nbsp;314&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line828">828</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line829">829</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line830">830</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line831">831</span><span class="td">[&nbsp;glk_request_char_event_uni&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line832">832</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_request_char_event_uni(window)</span></span>
<span class="tr"><span class="th" id="line833">833</span><span class="td">&nbsp;&nbsp;@glk&nbsp;320&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line834">834</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line835">835</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line836">836</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line837">837</span><span class="td">[&nbsp;glk_request_line_event_uni&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line838">838</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_request_line_event_uni(window,&nbsp;uintarray,&nbsp;arraylen,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line839">839</span><span class="td">&nbsp;&nbsp;@glk&nbsp;321&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line840">840</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line841">841</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line842">842</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line843">843</span><span class="td">[&nbsp;glk_set_echo_line_event&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line844">844</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_set_echo_line_event(window,&nbsp;uint)</span></span>
<span class="tr"><span class="th" id="line845">845</span><span class="td">&nbsp;&nbsp;@glk&nbsp;336&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line846">846</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line847">847</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line848">848</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line849">849</span><span class="td">[&nbsp;glk_set_terminators_line_event&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line850">850</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_set_terminators_line_event(window,&nbsp;uintarray,&nbsp;arraylen)</span></span>
<span class="tr"><span class="th" id="line851">851</span><span class="td">&nbsp;&nbsp;@glk&nbsp;337&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line852">852</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line853">853</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line854">854</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line855">855</span><span class="td">[&nbsp;glk_current_time&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line856">856</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_current_time(&amp;{int,&nbsp;uint,&nbsp;int})</span></span>
<span class="tr"><span class="th" id="line857">857</span><span class="td">&nbsp;&nbsp;@glk&nbsp;352&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line858">858</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line859">859</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line860">860</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line861">861</span><span class="td">[&nbsp;glk_current_simple_time&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line862">862</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_current_simple_time(uint)&nbsp;=&gt;&nbsp;int</span></span>
<span class="tr"><span class="th" id="line863">863</span><span class="td">&nbsp;&nbsp;@glk&nbsp;353&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line864">864</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line865">865</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line866">866</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line867">867</span><span class="td">[&nbsp;glk_time_to_date_utc&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line868">868</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_time_to_date_utc(&amp;{int,&nbsp;uint,&nbsp;int},&nbsp;&amp;{int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int})</span></span>
<span class="tr"><span class="th" id="line869">869</span><span class="td">&nbsp;&nbsp;@glk&nbsp;360&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line870">870</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line871">871</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line872">872</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line873">873</span><span class="td">[&nbsp;glk_time_to_date_local&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line874">874</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_time_to_date_local(&amp;{int,&nbsp;uint,&nbsp;int},&nbsp;&amp;{int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int})</span></span>
<span class="tr"><span class="th" id="line875">875</span><span class="td">&nbsp;&nbsp;@glk&nbsp;361&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line876">876</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line877">877</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line878">878</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line879">879</span><span class="td">[&nbsp;glk_simple_time_to_date_utc&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line880">880</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_simple_time_to_date_utc(int,&nbsp;uint,&nbsp;&amp;{int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int})</span></span>
<span class="tr"><span class="th" id="line881">881</span><span class="td">&nbsp;&nbsp;@glk&nbsp;362&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line882">882</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line883">883</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line884">884</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line885">885</span><span class="td">[&nbsp;glk_simple_time_to_date_local&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line886">886</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_simple_time_to_date_local(int,&nbsp;uint,&nbsp;&amp;{int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int})</span></span>
<span class="tr"><span class="th" id="line887">887</span><span class="td">&nbsp;&nbsp;@glk&nbsp;363&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line888">888</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line889">889</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line890">890</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line891">891</span><span class="td">[&nbsp;glk_date_to_time_utc&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line892">892</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_date_to_time_utc(&amp;{int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int},&nbsp;&amp;{int,&nbsp;uint,&nbsp;int})</span></span>
<span class="tr"><span class="th" id="line893">893</span><span class="td">&nbsp;&nbsp;@glk&nbsp;364&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line894">894</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line895">895</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line896">896</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line897">897</span><span class="td">[&nbsp;glk_date_to_time_local&nbsp;_vararg_count;</span></span>
<span class="tr"><span class="th" id="line898">898</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_date_to_time_local(&amp;{int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int},&nbsp;&amp;{int,&nbsp;uint,&nbsp;int})</span></span>
<span class="tr"><span class="th" id="line899">899</span><span class="td">&nbsp;&nbsp;@glk&nbsp;365&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line900">900</span><span class="td">&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line901">901</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line902">902</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line903">903</span><span class="td">[&nbsp;glk_date_to_simple_time_utc&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line904">904</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_date_to_simple_time_utc(&amp;{int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int},&nbsp;uint)&nbsp;=&gt;&nbsp;int</span></span>
<span class="tr"><span class="th" id="line905">905</span><span class="td">&nbsp;&nbsp;@glk&nbsp;366&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line906">906</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line907">907</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line908">908</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line909">909</span><span class="td">[&nbsp;glk_date_to_simple_time_local&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line910">910</span><span class="td">&nbsp;&nbsp;!&nbsp;glk_date_to_simple_time_local(&amp;{int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int,&nbsp;int},&nbsp;uint)&nbsp;=&gt;&nbsp;int</span></span>
<span class="tr"><span class="th" id="line911">911</span><span class="td">&nbsp;&nbsp;@glk&nbsp;367&nbsp;_vararg_count&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line912">912</span><span class="td">&nbsp;&nbsp;return&nbsp;ret;</span></span>
<span class="tr"><span class="th" id="line913">913</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-rocks">Rocks.</h3><p><p> These are unique ID codes used to mark resources; think of them as inedible cookies.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line920">920</span><span class="td">Constant&nbsp;GG_MAINWIN_ROCK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;201;</span></span>
<span class="tr"><span class="th" id="line921">921</span><span class="td">Constant&nbsp;GG_STATUSWIN_ROCK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;202;</span></span>
<span class="tr"><span class="th" id="line922">922</span><span class="td">Constant&nbsp;GG_QUOTEWIN_ROCK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;203;</span></span>
<span class="tr"><span class="th" id="line923">923</span><span class="td">Constant&nbsp;GG_SAVESTR_ROCK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;301;</span></span>
<span class="tr"><span class="th" id="line924">924</span><span class="td">Constant&nbsp;GG_SCRIPTSTR_ROCK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;302;</span></span>
<span class="tr"><span class="th" id="line925">925</span><span class="td">Constant&nbsp;GG_COMMANDWSTR_ROCK&nbsp;&nbsp;&nbsp;&nbsp;303;</span></span>
<span class="tr"><span class="th" id="line926">926</span><span class="td">Constant&nbsp;GG_COMMANDRSTR_ROCK&nbsp;&nbsp;&nbsp;&nbsp;304;</span></span>
<span class="tr"><span class="th" id="line927">927</span><span class="td">Constant&nbsp;GG_SCRIPTFREF_ROCK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;401;</span></span>
<span class="tr"><span class="th" id="line928">928</span><span class="td">Constant&nbsp;GG_FOREGROUNDCHAN_ROCK&nbsp;410;</span></span>
<span class="tr"><span class="th" id="line929">929</span><span class="td">Constant&nbsp;GG_BACKGROUNDCHAN_ROCK&nbsp;411;</span></span>
</div><div class='text'>
<h3 id="#glulx-stubs">Stubs.</h3><p><p> These are I6 library-style entry point routines, not used by I7, but retained in case I7 extensions want to do interesting things with Glulx.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line936">936</span><span class="td">#Stub&nbsp;HandleGlkEvent&nbsp;&nbsp;&nbsp;&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line937">937</span><span class="td">#Stub&nbsp;IdentifyGlkObject&nbsp;4;</span></span>
<span class="tr"><span class="th" id="line938">938</span><span class="td">#Stub&nbsp;InitGlkWindow&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1;</span></span>
</div><div class='text'>
<h3 id="#glulx-starting-up">Starting Up.</h3><p><p> <span class="fixed"><a href="./Glulx.i6t.html#line967">VM_Initialise()</a></span> is almost the first routine called, except that the &quot;starting the virtual machine&quot; activity is allowed to go first; and, come to think of it, memory allocation has to be set up before even that, and that in turn calls <span class="fixed"><a href="./Glulx.i6t.html#line955">VM_PreInitialise()</a></span> to do the absolute minimum.<p></p><p> Arrangements are a little different here from on the Z-machine, because some data is retained in the case of a restart.<p></p><p> (Many thanks are due to Eliuk Blau, who found several tricky timing errors here and elsewhere in the Glulx-specific code. Frankly, I feel like hanging a sign on the following routines which reads &quot;Congratulations on bringing light to the Dark Room.&quot;)<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line955">955</span><span class="td">[&nbsp;VM_PreInitialise&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line956">956</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@gestalt&nbsp;4&nbsp;2&nbsp;res;&nbsp;!&nbsp;Test&nbsp;if&nbsp;this&nbsp;interpreter&nbsp;has&nbsp;Glk...</span></span>
<span class="tr"><span class="th" id="line957">957</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(res&nbsp;==&nbsp;0)&nbsp;quit;&nbsp;!&nbsp;...without&nbsp;which&nbsp;there&nbsp;would&nbsp;be&nbsp;nothing&nbsp;we&nbsp;could&nbsp;do</span></span>
<span class="tr"><span class="th" id="line958">958</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line959">959</span><span class="td">&nbsp;unicode_gestalt_ok&nbsp;=&nbsp;false;</span></span>
<span class="tr"><span class="th" id="line960">960</span><span class="td">&nbsp;if&nbsp;(glk_gestalt(gestalt_Unicode,&nbsp;0))</span></span>
<span class="tr"><span class="th" id="line961">961</span><span class="td">&nbsp;&nbsp;unicode_gestalt_ok&nbsp;=&nbsp;true;</span></span>
<span class="tr"><span class="th" id="line962">962</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line963">963</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Set&nbsp;the&nbsp;VM&#39;s&nbsp;I/O&nbsp;system&nbsp;to&nbsp;be&nbsp;Glk.</span></span>
<span class="tr"><span class="th" id="line964">964</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@setiosys&nbsp;2&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line965">965</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line966">966</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line967">967</span><span class="td">[&nbsp;VM_Initialise&nbsp;res&nbsp;sty&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line968">968</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@gestalt&nbsp;4&nbsp;2&nbsp;res;&nbsp;!&nbsp;Test&nbsp;if&nbsp;this&nbsp;interpreter&nbsp;has&nbsp;Glk...</span></span>
<span class="tr"><span class="th" id="line969">969</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(res&nbsp;==&nbsp;0)&nbsp;quit;&nbsp;!&nbsp;...without&nbsp;which&nbsp;there&nbsp;would&nbsp;be&nbsp;nothing&nbsp;we&nbsp;could&nbsp;do</span></span>
<span class="tr"><span class="th" id="line970">970</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line971">971</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;First,&nbsp;we&nbsp;must&nbsp;go&nbsp;through&nbsp;all&nbsp;the&nbsp;Glk&nbsp;objects&nbsp;that&nbsp;exist,&nbsp;and&nbsp;see</span></span>
<span class="tr"><span class="th" id="line972">972</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;if&nbsp;we&nbsp;created&nbsp;any&nbsp;of&nbsp;them.&nbsp;One&nbsp;might&nbsp;think&nbsp;this&nbsp;strange,&nbsp;since&nbsp;the</span></span>
<span class="tr"><span class="th" id="line973">973</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;program&nbsp;has&nbsp;just&nbsp;started&nbsp;running,&nbsp;but&nbsp;remember&nbsp;that&nbsp;the&nbsp;player&nbsp;might</span></span>
<span class="tr"><span class="th" id="line974">974</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;have&nbsp;just&nbsp;typed&nbsp;&quot;restart&quot;.</span></span>
<span class="tr"><span class="th" id="line975">975</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line976">976</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;GGRecoverObjects();</span></span>
<span class="tr"><span class="th" id="line977">977</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line978">978</span><span class="td">&nbsp;!&nbsp;Sound&nbsp;channel&nbsp;initialisation,&nbsp;and&nbsp;RNG&nbsp;fixing,&nbsp;must&nbsp;be&nbsp;done&nbsp;now&nbsp;rather</span></span>
<span class="tr"><span class="th" id="line979">979</span><span class="td">&nbsp;!&nbsp;than&nbsp;later&nbsp;in&nbsp;case&nbsp;InitGlkWindow()&nbsp;returns&nbsp;a&nbsp;non-zero&nbsp;value.</span></span>
<span class="tr"><span class="th" id="line980">980</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line981">981</span><span class="td">&nbsp;if&nbsp;(glk_gestalt(gestalt_Sound,&nbsp;0))&nbsp;{</span></span>
<span class="tr"><span class="th" id="line982">982</span><span class="td">&nbsp;&nbsp;if&nbsp;(gg_foregroundchan&nbsp;==&nbsp;0)</span></span>
<span class="tr"><span class="th" id="line983">983</span><span class="td">&nbsp;&nbsp;&nbsp;gg_foregroundchan&nbsp;=&nbsp;glk_schannel_create(GG_FOREGROUNDCHAN_ROCK);</span></span>
<span class="tr"><span class="th" id="line984">984</span><span class="td">&nbsp;&nbsp;if&nbsp;(gg_backgroundchan&nbsp;==&nbsp;0)</span></span>
<span class="tr"><span class="th" id="line985">985</span><span class="td">&nbsp;&nbsp;&nbsp;gg_backgroundchan&nbsp;=&nbsp;glk_schannel_create(GG_BACKGROUNDCHAN_ROCK);</span></span>
<span class="tr"><span class="th" id="line986">986</span><span class="td">&nbsp;}</span></span>
<span class="tr"><span class="th" id="line987">987</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line988">988</span><span class="td">&nbsp;#ifdef&nbsp;FIX_RNG;</span></span>
<span class="tr"><span class="th" id="line989">989</span><span class="td">&nbsp;@random&nbsp;10000&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line990">990</span><span class="td">&nbsp;i&nbsp;=&nbsp;-i-2000;</span></span>
<span class="tr"><span class="th" id="line991">991</span><span class="td">&nbsp;print&nbsp;&quot;[Random&nbsp;number&nbsp;generator&nbsp;seed&nbsp;is&nbsp;&quot;,&nbsp;i,&nbsp;&quot;]^&quot;;</span></span>
<span class="tr"><span class="th" id="line992">992</span><span class="td">&nbsp;@setrandom&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line993">993</span><span class="td">&nbsp;#endif;&nbsp;!&nbsp;FIX_RNG</span></span>
<span class="tr"><span class="th" id="line994">994</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line995">995</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;InitGlkWindow(0);</span></span>
<span class="tr"><span class="th" id="line996">996</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(res&nbsp;~=&nbsp;0)&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line997">997</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line998">998</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Now,&nbsp;gg_mainwin&nbsp;and&nbsp;gg_storywin&nbsp;might&nbsp;already&nbsp;be&nbsp;set.&nbsp;If&nbsp;not,&nbsp;set&nbsp;them.</span></span>
<span class="tr"><span class="th" id="line999">999</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1000">1000</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_mainwin&nbsp;==&nbsp;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1001">1001</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Open&nbsp;the&nbsp;story&nbsp;window.</span></span>
<span class="tr"><span class="th" id="line1002">1002</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;InitGlkWindow(GG_MAINWIN_ROCK);</span></span>
<span class="tr"><span class="th" id="line1003">1003</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(res&nbsp;==&nbsp;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1004">1004</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Left-justify&nbsp;the&nbsp;header&nbsp;style</span></span>
<span class="tr"><span class="th" id="line1005">1005</span><span class="td">&nbsp;&nbsp;&nbsp;glk_stylehint_set(wintype_TextBuffer,&nbsp;style_Header,&nbsp;stylehint_Justification,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1006">1006</span><span class="td">&nbsp;&nbsp;&nbsp;!&nbsp;Try&nbsp;to&nbsp;make&nbsp;emphasized&nbsp;type&nbsp;in&nbsp;italics&nbsp;and&nbsp;not&nbsp;boldface</span></span>
<span class="tr"><span class="th" id="line1007">1007</span><span class="td">&nbsp;&nbsp;&nbsp;glk_stylehint_set(wintype_TextBuffer,&nbsp;style_Emphasized,&nbsp;stylehint_Weight,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1008">1008</span><span class="td">&nbsp;&nbsp;&nbsp;glk_stylehint_set(wintype_TextBuffer,&nbsp;style_Emphasized,&nbsp;stylehint_Oblique,&nbsp;1);</span></span>
<span class="tr"><span class="th" id="line1009">1009</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_mainwin&nbsp;=&nbsp;glk_window_open(0,&nbsp;0,&nbsp;0,&nbsp;wintype_TextBuffer,&nbsp;GG_MAINWIN_ROCK);</span></span>
<span class="tr"><span class="th" id="line1010">1010</span><span class="td">&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1011">1011</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_mainwin&nbsp;==&nbsp;0)&nbsp;quit;&nbsp;!&nbsp;If&nbsp;we&nbsp;can&#39;t&nbsp;even&nbsp;open&nbsp;one&nbsp;window,&nbsp;give&nbsp;in</span></span>
<span class="tr"><span class="th" id="line1012">1012</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1013">1013</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;There&nbsp;was&nbsp;already&nbsp;a&nbsp;story&nbsp;window.&nbsp;We&nbsp;should&nbsp;erase&nbsp;it.</span></span>
<span class="tr"><span class="th" id="line1014">1014</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_clear(gg_mainwin);</span></span>
<span class="tr"><span class="th" id="line1015">1015</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1016">1016</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1017">1017</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_statuswin&nbsp;==&nbsp;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1018">1018</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;InitGlkWindow(GG_STATUSWIN_ROCK);</span></span>
<span class="tr"><span class="th" id="line1019">1019</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(res&nbsp;==&nbsp;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1020">1020</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statuswin_cursize&nbsp;=&nbsp;statuswin_size;</span></span>
<span class="tr"><span class="th" id="line1021">1021</span><span class="td">&nbsp;&nbsp;&nbsp;for&nbsp;(sty=0:&nbsp;sty&lt;style_NUMSTYLES:&nbsp;sty++)</span></span>
<span class="tr"><span class="th" id="line1022">1022</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_stylehint_set(wintype_TextGrid,&nbsp;sty,&nbsp;stylehint_ReverseColor,&nbsp;1);</span></span>
<span class="tr"><span class="th" id="line1023">1023</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_statuswin&nbsp;=</span></span>
<span class="tr"><span class="th" id="line1024">1024</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_open(gg_mainwin,&nbsp;winmethod_Fixed&nbsp;+&nbsp;winmethod_Above,</span></span>
<span class="tr"><span class="th" id="line1025">1025</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statuswin_cursize,&nbsp;wintype_TextGrid,&nbsp;GG_STATUSWIN_ROCK);</span></span>
<span class="tr"><span class="th" id="line1026">1026</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1027">1027</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1028">1028</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;It&#39;s&nbsp;possible&nbsp;that&nbsp;the&nbsp;status&nbsp;window&nbsp;couldn&#39;t&nbsp;be&nbsp;opened,&nbsp;in&nbsp;which&nbsp;case</span></span>
<span class="tr"><span class="th" id="line1029">1029</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;gg_statuswin&nbsp;is&nbsp;now&nbsp;zero.&nbsp;We&nbsp;must&nbsp;allow&nbsp;for&nbsp;that&nbsp;later&nbsp;on.</span></span>
<span class="tr"><span class="th" id="line1030">1030</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1031">1031</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_set_window(gg_mainwin);</span></span>
<span class="tr"><span class="th" id="line1032">1032</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1033">1033</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;InitGlkWindow(1);</span></span>
<span class="tr"><span class="th" id="line1034">1034</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;</span></span>
<span class="tr"><span class="th" id="line1035">1035</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Empty&nbsp;the&nbsp;parse&nbsp;buffer&nbsp;(see&nbsp;bug&nbsp;0001451)</span></span>
<span class="tr"><span class="th" id="line1036">1036</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;buffer3--&gt;0&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1037">1037</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1038">1038</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1039">1039</span><span class="td">[&nbsp;GGRecoverObjects&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1040">1040</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;If&nbsp;GGRecoverObjects()&nbsp;has&nbsp;been&nbsp;called,&nbsp;all&nbsp;these&nbsp;stored&nbsp;IDs&nbsp;are</span></span>
<span class="tr"><span class="th" id="line1041">1041</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;invalid,&nbsp;so&nbsp;we&nbsp;start&nbsp;by&nbsp;clearing&nbsp;them&nbsp;all&nbsp;out.</span></span>
<span class="tr"><span class="th" id="line1042">1042</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;(In&nbsp;fact,&nbsp;after&nbsp;a&nbsp;restoreundo,&nbsp;some&nbsp;of&nbsp;them&nbsp;may&nbsp;still&nbsp;be&nbsp;good.</span></span>
<span class="tr"><span class="th" id="line1043">1043</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;For&nbsp;simplicity,&nbsp;though,&nbsp;we&nbsp;assume&nbsp;the&nbsp;general&nbsp;case.)</span></span>
<span class="tr"><span class="th" id="line1044">1044</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;gg_mainwin&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1045">1045</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;gg_statuswin&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1046">1046</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;gg_quotewin&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1047">1047</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;gg_scriptfref&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1048">1048</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;gg_scriptstr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1049">1049</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;gg_savestr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1050">1050</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;statuswin_cursize&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1051">1051</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;gg_foregroundchan&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1052">1052</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;gg_backgroundchan&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1053">1053</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;#Ifdef&nbsp;DEBUG;</span></span>
<span class="tr"><span class="th" id="line1054">1054</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;gg_commandstr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1055">1055</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;gg_command_reading&nbsp;=&nbsp;false;</span></span>
<span class="tr"><span class="th" id="line1056">1056</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;#Endif;&nbsp;!&nbsp;DEBUG</span></span>
<span class="tr"><span class="th" id="line1057">1057</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Also&nbsp;tell&nbsp;the&nbsp;game&nbsp;to&nbsp;clear&nbsp;its&nbsp;object&nbsp;references.</span></span>
<span class="tr"><span class="th" id="line1058">1058</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;IdentifyGlkObject(0);</span></span>
<span class="tr"><span class="th" id="line1059">1059</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1060">1060</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_stream_iterate(0,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1061">1061</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(id)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1062">1062</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(gg_arguments--&gt;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1063">1063</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GG_SAVESTR_ROCK:&nbsp;gg_savestr&nbsp;=&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1064">1064</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GG_SCRIPTSTR_ROCK:&nbsp;gg_scriptstr&nbsp;=&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1065">1065</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Ifdef&nbsp;DEBUG;</span></span>
<span class="tr"><span class="th" id="line1066">1066</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GG_COMMANDWSTR_ROCK:&nbsp;gg_commandstr&nbsp;=&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1067">1067</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_command_reading&nbsp;=&nbsp;false;</span></span>
<span class="tr"><span class="th" id="line1068">1068</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GG_COMMANDRSTR_ROCK:&nbsp;gg_commandstr&nbsp;=&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1069">1069</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_command_reading&nbsp;=&nbsp;true;</span></span>
<span class="tr"><span class="th" id="line1070">1070</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Endif;&nbsp;!&nbsp;DEBUG</span></span>
<span class="tr"><span class="th" id="line1071">1071</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;IdentifyGlkObject(1,&nbsp;1,&nbsp;id,&nbsp;gg_arguments--&gt;0);</span></span>
<span class="tr"><span class="th" id="line1072">1072</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1073">1073</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_stream_iterate(id,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1074">1074</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1075">1075</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1076">1076</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_window_iterate(0,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1077">1077</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(id)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1078">1078</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(gg_arguments--&gt;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1079">1079</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GG_MAINWIN_ROCK:&nbsp;gg_mainwin&nbsp;=&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1080">1080</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GG_STATUSWIN_ROCK:&nbsp;gg_statuswin&nbsp;=&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1081">1081</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GG_QUOTEWIN_ROCK:&nbsp;gg_quotewin&nbsp;=&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1082">1082</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;IdentifyGlkObject(1,&nbsp;0,&nbsp;id,&nbsp;gg_arguments--&gt;0);</span></span>
<span class="tr"><span class="th" id="line1083">1083</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1084">1084</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_window_iterate(id,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1085">1085</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1086">1086</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1087">1087</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_fileref_iterate(0,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1088">1088</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(id)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1089">1089</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(gg_arguments--&gt;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1090">1090</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GG_SCRIPTFREF_ROCK:&nbsp;gg_scriptfref&nbsp;=&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1091">1091</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;IdentifyGlkObject(1,&nbsp;2,&nbsp;id,&nbsp;gg_arguments--&gt;0);</span></span>
<span class="tr"><span class="th" id="line1092">1092</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1093">1093</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_fileref_iterate(id,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1094">1094</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1095">1095</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1096">1096</span><span class="td">&nbsp;if&nbsp;(glk_gestalt(gestalt_Sound,&nbsp;0))&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1097">1097</span><span class="td">&nbsp;&nbsp;id&nbsp;=&nbsp;glk_schannel_iterate(0,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1098">1098</span><span class="td">&nbsp;&nbsp;while&nbsp;(id)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1099">1099</span><span class="td">&nbsp;&nbsp;&nbsp;switch&nbsp;(gg_arguments--&gt;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1100">1100</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;GG_FOREGROUNDCHAN_ROCK:&nbsp;gg_foregroundchan&nbsp;=&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1101">1101</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;GG_BACKGROUNDCHAN_ROCK:&nbsp;gg_backgroundchan&nbsp;=&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1102">1102</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;IdentifyGlkObject(1,&nbsp;3,&nbsp;id,&nbsp;gg_arguments--&gt;0);</span></span>
<span class="tr"><span class="th" id="line1103">1103</span><span class="td">&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1104">1104</span><span class="td">&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_schannel_iterate(id,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1105">1105</span><span class="td">&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1106">1106</span><span class="td">&nbsp;&nbsp;if&nbsp;(gg_foregroundchan&nbsp;~=&nbsp;0)&nbsp;{&nbsp;glk_schannel_stop(gg_foregroundchan);&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1107">1107</span><span class="td">&nbsp;&nbsp;if&nbsp;(gg_backgroundchan&nbsp;~=&nbsp;0)&nbsp;{&nbsp;glk_schannel_stop(gg_backgroundchan);&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1108">1108</span><span class="td">&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1109">1109</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1110">1110</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Tell&nbsp;the&nbsp;game&nbsp;to&nbsp;tie&nbsp;up&nbsp;any&nbsp;loose&nbsp;ends.</span></span>
<span class="tr"><span class="th" id="line1111">1111</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;IdentifyGlkObject(2);</span></span>
<span class="tr"><span class="th" id="line1112">1112</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-enable-acceleration">Enable Acceleration.</h3><p><p> This enables use of March 2009 extension to Glulx which optimises the speed of Inform-compiled story files by moving the work of I6 veneer routines into the interpreter itself. It should have no effect on earlier versions of the Glulx VM, which will lack the gestalt for this feature, but nor should it do any harm.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1122">1122</span><span class="td">[&nbsp;ENABLE_GLULX_ACCEL_R&nbsp;addr&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line1123">1123</span><span class="td">&nbsp;@gestalt&nbsp;9&nbsp;0&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line1124">1124</span><span class="td">&nbsp;if&nbsp;(res&nbsp;==&nbsp;0)&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1125">1125</span><span class="td">&nbsp;addr&nbsp;=&nbsp;#classes_table;</span></span>
<span class="tr"><span class="th" id="line1126">1126</span><span class="td">&nbsp;@accelparam&nbsp;0&nbsp;addr;</span></span>
<span class="tr"><span class="th" id="line1127">1127</span><span class="td">&nbsp;@accelparam&nbsp;1&nbsp;INDIV_PROP_START;</span></span>
<span class="tr"><span class="th" id="line1128">1128</span><span class="td">&nbsp;@accelparam&nbsp;2&nbsp;Class;</span></span>
<span class="tr"><span class="th" id="line1129">1129</span><span class="td">&nbsp;@accelparam&nbsp;3&nbsp;Object;</span></span>
<span class="tr"><span class="th" id="line1130">1130</span><span class="td">&nbsp;@accelparam&nbsp;4&nbsp;Routine;</span></span>
<span class="tr"><span class="th" id="line1131">1131</span><span class="td">&nbsp;@accelparam&nbsp;5&nbsp;String;</span></span>
<span class="tr"><span class="th" id="line1132">1132</span><span class="td">&nbsp;addr&nbsp;=&nbsp;#globals_array&nbsp;+&nbsp;WORDSIZE&nbsp;*&nbsp;#g$self;</span></span>
<span class="tr"><span class="th" id="line1133">1133</span><span class="td">&nbsp;@accelparam&nbsp;6&nbsp;addr;</span></span>
<span class="tr"><span class="th" id="line1134">1134</span><span class="td">&nbsp;@accelparam&nbsp;7&nbsp;NUM_ATTR_BYTES;</span></span>
<span class="tr"><span class="th" id="line1135">1135</span><span class="td">&nbsp;addr&nbsp;=&nbsp;#cpv__start;</span></span>
<span class="tr"><span class="th" id="line1136">1136</span><span class="td">&nbsp;@accelparam&nbsp;8&nbsp;addr;</span></span>
<span class="tr"><span class="th" id="line1137">1137</span><span class="td">&nbsp;@accelfunc&nbsp;1&nbsp;Z__Region;</span></span>
<span class="tr"><span class="th" id="line1138">1138</span><span class="td">&nbsp;@accelfunc&nbsp;2&nbsp;CP__Tab;</span></span>
<span class="tr"><span class="th" id="line1139">1139</span><span class="td">&nbsp;@accelfunc&nbsp;3&nbsp;RA__Pr;</span></span>
<span class="tr"><span class="th" id="line1140">1140</span><span class="td">&nbsp;@accelfunc&nbsp;4&nbsp;RL__Pr;</span></span>
<span class="tr"><span class="th" id="line1141">1141</span><span class="td">&nbsp;@accelfunc&nbsp;5&nbsp;OC__Cl;</span></span>
<span class="tr"><span class="th" id="line1142">1142</span><span class="td">&nbsp;@accelfunc&nbsp;6&nbsp;RV__Pr;</span></span>
<span class="tr"><span class="th" id="line1143">1143</span><span class="td">&nbsp;@accelfunc&nbsp;7&nbsp;OP__Pr;</span></span>
<span class="tr"><span class="th" id="line1144">1144</span><span class="td">&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line1145">1145</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-release-number">Release Number.</h3><p><p> Like all software, IF story files have release numbers to mark revised versions being circulated: unlike most software, and partly for traditional reasons, the version number is recorded not in some print statement or variable but is branded on, so to speak, in a specific memory location of the story file header.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1158">VM_Describe_Release()</a></span> describes the release and is used as part of the &quot;banner&quot;, IF&#39;s equivalent to a title page.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1158">1158</span><span class="td">[&nbsp;VM_Describe_Release&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1159">1159</span><span class="td">&nbsp;print&nbsp;&quot;Release&nbsp;&quot;;</span></span>
<span class="tr"><span class="th" id="line1160">1160</span><span class="td">&nbsp;@aloads&nbsp;ROM_GAMERELEASE&nbsp;0&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1161">1161</span><span class="td">&nbsp;print&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1162">1162</span><span class="td">&nbsp;print&nbsp;&quot;&nbsp;/&nbsp;Serial&nbsp;number&nbsp;&quot;;</span></span>
<span class="tr"><span class="th" id="line1163">1163</span><span class="td">&nbsp;for&nbsp;(i=0&nbsp;:&nbsp;i&lt;6&nbsp;:&nbsp;i++)&nbsp;print&nbsp;(char)&nbsp;ROM_GAMESERIAL-&gt;i;</span></span>
<span class="tr"><span class="th" id="line1164">1164</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-keyboard-input">Keyboard Input.</h3><p><p> The VM must provide three routines for keyboard input:<p></p><p> (a) <span class="fixed"><a href="./Glulx.i6t.html#line1180">VM_KeyChar()</a></span> waits for a key to be pressed and then returns the character chosen as a ZSCII character. (b) <span class="fixed"><a href="./Glulx.i6t.html#line1263">VM_KeyDelay(N)</a></span> waits up to <em>N/10</em> seconds for a key to be pressed, returning the ZSCII character if so, or 0 if not. (c) <span class="fixed"><a href="./Glulx.i6t.html#line1283">VM_ReadKeyboard(b, t)</a></span> reads a whole newline-terminated command into the buffer <span class="fixed">b</span>, then parses it into a word stream in the table <span class="fixed">t</span>.<p></p><p> There are elaborations to due with mouse clicks, but this isn&#39;t the place to document all of that.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1180">1180</span><span class="td">[&nbsp;VM_KeyChar&nbsp;win&nbsp;nostat&nbsp;done&nbsp;res&nbsp;ix&nbsp;jx&nbsp;ch;</span></span>
<span class="tr"><span class="th" id="line1181">1181</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;jx&nbsp;=&nbsp;ch;&nbsp;!&nbsp;squash&nbsp;compiler&nbsp;warnings</span></span>
<span class="tr"><span class="th" id="line1182">1182</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(win&nbsp;==&nbsp;0)&nbsp;win&nbsp;=&nbsp;gg_mainwin;</span></span>
<span class="tr"><span class="th" id="line1183">1183</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_commandstr&nbsp;~=&nbsp;0&nbsp;&amp;&amp;&nbsp;gg_command_reading&nbsp;~=&nbsp;false)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1184">1184</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;glk_get_line_stream(gg_commandstr,&nbsp;gg_arguments,&nbsp;31);</span></span>
<span class="tr"><span class="th" id="line1185">1185</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(done&nbsp;==&nbsp;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1186">1186</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_stream_close(gg_commandstr,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1187">1187</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_commandstr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1188">1188</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_command_reading&nbsp;=&nbsp;false;</span></span>
<span class="tr"><span class="th" id="line1189">1189</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;fall&nbsp;through&nbsp;to&nbsp;normal&nbsp;user&nbsp;input.</span></span>
<span class="tr"><span class="th" id="line1190">1190</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1191">1191</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Trim&nbsp;the&nbsp;trailing&nbsp;newline</span></span>
<span class="tr"><span class="th" id="line1192">1192</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_arguments-&gt;(done-1)&nbsp;==&nbsp;10)&nbsp;done&nbsp;=&nbsp;done-1;</span></span>
<span class="tr"><span class="th" id="line1193">1193</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;gg_arguments-&gt;0;</span></span>
<span class="tr"><span class="th" id="line1194">1194</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(res&nbsp;==&nbsp;&#39;\&#39;)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1195">1195</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1196">1196</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(ix=1&nbsp;:&nbsp;ix&lt;done&nbsp;:&nbsp;ix++)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1197">1197</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ch&nbsp;=&nbsp;gg_arguments-&gt;ix;</span></span>
<span class="tr"><span class="th" id="line1198">1198</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ch&nbsp;&gt;=&nbsp;&#39;0&#39;&nbsp;&amp;&amp;&nbsp;ch&nbsp;&lt;=&nbsp;&#39;9&#39;)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1199">1199</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@shiftl&nbsp;res&nbsp;4&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line1200">1200</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;res&nbsp;+&nbsp;(ch-&#39;0&#39;);</span></span>
<span class="tr"><span class="th" id="line1201">1201</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(ch&nbsp;&gt;=&nbsp;&#39;a&#39;&nbsp;&amp;&amp;&nbsp;ch&nbsp;&lt;=&nbsp;&#39;f&#39;)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1202">1202</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@shiftl&nbsp;res&nbsp;4&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line1203">1203</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;res&nbsp;+&nbsp;(ch+10-&#39;a&#39;);</span></span>
<span class="tr"><span class="th" id="line1204">1204</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(ch&nbsp;&gt;=&nbsp;&#39;A&#39;&nbsp;&amp;&amp;&nbsp;ch&nbsp;&lt;=&nbsp;&#39;F&#39;)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1205">1205</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@shiftl&nbsp;res&nbsp;4&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line1206">1206</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;res&nbsp;+&nbsp;(ch+10-&#39;A&#39;);</span></span>
<span class="tr"><span class="th" id="line1207">1207</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1208">1208</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1209">1209</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1210">1210</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jump&nbsp;<a href="./Glulx.i6t.html#line1259">KCPContinue</a>;</span></span>
<span class="tr"><span class="th" id="line1211">1211</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1212">1212</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1213">1213</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;false;</span></span>
<span class="tr"><span class="th" id="line1214">1214</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_request_char_event(win);</span></span>
<span class="tr"><span class="th" id="line1215">1215</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(~~done)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1216">1216</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_select(gg_event);</span></span>
<span class="tr"><span class="th" id="line1217">1217</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(gg_event--&gt;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1218">1218</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5:&nbsp;!&nbsp;evtype_Arrange</span></span>
<span class="tr"><span class="th" id="line1219">1219</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nostat)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1220">1220</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_cancel_char_event(win);</span></span>
<span class="tr"><span class="th" id="line1221">1221</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;$80000000;</span></span>
<span class="tr"><span class="th" id="line1222">1222</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;true;</span></span>
<span class="tr"><span class="th" id="line1223">1223</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</span></span>
<span class="tr"><span class="th" id="line1224">1224</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1225">1225</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DrawStatusLine();</span></span>
<span class="tr"><span class="th" id="line1226">1226</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;!&nbsp;evtype_CharInput</span></span>
<span class="tr"><span class="th" id="line1227">1227</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_event--&gt;1&nbsp;==&nbsp;win)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1228">1228</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;gg_event--&gt;2;</span></span>
<span class="tr"><span class="th" id="line1229">1229</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;true;</span></span>
<span class="tr"><span class="th" id="line1230">1230</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1231">1231</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1232">1232</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;HandleGlkEvent(gg_event,&nbsp;1,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1233">1233</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ix&nbsp;==&nbsp;2)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1234">1234</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;gg_arguments--&gt;0;</span></span>
<span class="tr"><span class="th" id="line1235">1235</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;true;</span></span>
<span class="tr"><span class="th" id="line1236">1236</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(ix&nbsp;==&nbsp;-1)&nbsp;&nbsp;done&nbsp;=&nbsp;false;</span></span>
<span class="tr"><span class="th" id="line1237">1237</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1238">1238</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_commandstr&nbsp;~=&nbsp;0&nbsp;&amp;&amp;&nbsp;gg_command_reading&nbsp;==&nbsp;false)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1239">1239</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(res&nbsp;&lt;&nbsp;32&nbsp;||&nbsp;res&nbsp;&gt;=&nbsp;256&nbsp;||&nbsp;(res&nbsp;==&nbsp;&#39;\&#39;&nbsp;or&nbsp;&#39;&nbsp;&#39;))&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1240">1240</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_put_char_stream(gg_commandstr,&nbsp;&#39;\&#39;);</span></span>
<span class="tr"><span class="th" id="line1241">1241</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1242">1242</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jx&nbsp;=&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line1243">1243</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(ix=0&nbsp;:&nbsp;ix&lt;8&nbsp;:&nbsp;ix++)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1244">1244</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ushiftr&nbsp;jx&nbsp;28&nbsp;ch;</span></span>
<span class="tr"><span class="th" id="line1245">1245</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@shiftl&nbsp;jx&nbsp;4&nbsp;jx;</span></span>
<span class="tr"><span class="th" id="line1246">1246</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ch&nbsp;=&nbsp;ch&nbsp;&amp;&nbsp;$0F;</span></span>
<span class="tr"><span class="th" id="line1247">1247</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ch&nbsp;~=&nbsp;0&nbsp;||&nbsp;ix&nbsp;==&nbsp;7)&nbsp;done&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line1248">1248</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(done)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1249">1249</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ch&nbsp;&gt;=&nbsp;0&nbsp;&amp;&amp;&nbsp;ch&nbsp;&lt;=&nbsp;9)&nbsp;ch&nbsp;=&nbsp;ch&nbsp;+&nbsp;&#39;0&#39;;</span></span>
<span class="tr"><span class="th" id="line1250">1250</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ch&nbsp;=&nbsp;(ch&nbsp;-&nbsp;10)&nbsp;+&nbsp;&#39;A&#39;;</span></span>
<span class="tr"><span class="th" id="line1251">1251</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_put_char_stream(gg_commandstr,&nbsp;ch);</span></span>
<span class="tr"><span class="th" id="line1252">1252</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1253">1253</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1254">1254</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1255">1255</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_put_char_stream(gg_commandstr,&nbsp;res);</span></span>
<span class="tr"><span class="th" id="line1256">1256</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1257">1257</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_put_char_stream(gg_commandstr,&nbsp;10);&nbsp;!&nbsp;newline</span></span>
<span class="tr"><span class="th" id="line1258">1258</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1259">1259</span><span class="td">&nbsp;&nbsp;.KCPContinue;</span></span>
<span class="tr"><span class="th" id="line1260">1260</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line1261">1261</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1262">1262</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1263">1263</span><span class="td">[&nbsp;VM_KeyDelay&nbsp;tenths&nbsp;&nbsp;key&nbsp;done&nbsp;ix;</span></span>
<span class="tr"><span class="th" id="line1264">1264</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_request_char_event(gg_mainwin);</span></span>
<span class="tr"><span class="th" id="line1265">1265</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_request_timer_events(tenths*100);</span></span>
<span class="tr"><span class="th" id="line1266">1266</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(~~done)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1267">1267</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_select(gg_event);</span></span>
<span class="tr"><span class="th" id="line1268">1268</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;HandleGlkEvent(gg_event,&nbsp;1,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1269">1269</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ix&nbsp;==&nbsp;2)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1270">1270</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key&nbsp;=&nbsp;gg_arguments--&gt;0;</span></span>
<span class="tr"><span class="th" id="line1271">1271</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;true;</span></span>
<span class="tr"><span class="th" id="line1272">1272</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1273">1273</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(ix&nbsp;&gt;=&nbsp;0&nbsp;&amp;&amp;&nbsp;gg_event--&gt;0&nbsp;==&nbsp;1&nbsp;or&nbsp;2)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1274">1274</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key&nbsp;=&nbsp;gg_event--&gt;2;</span></span>
<span class="tr"><span class="th" id="line1275">1275</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;true;</span></span>
<span class="tr"><span class="th" id="line1276">1276</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1277">1277</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1278">1278</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_cancel_char_event(gg_mainwin);</span></span>
<span class="tr"><span class="th" id="line1279">1279</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_request_timer_events(0);</span></span>
<span class="tr"><span class="th" id="line1280">1280</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;key;</span></span>
<span class="tr"><span class="th" id="line1281">1281</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1282">1282</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1283">1283</span><span class="td">[&nbsp;VM_ReadKeyboard&nbsp;&nbsp;a_buffer&nbsp;a_table&nbsp;done&nbsp;ix;</span></span>
<span class="tr"><span class="th" id="line1284">1284</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_commandstr&nbsp;~=&nbsp;0&nbsp;&amp;&amp;&nbsp;gg_command_reading&nbsp;~=&nbsp;false)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1285">1285</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;glk_get_line_stream(gg_commandstr,&nbsp;a_buffer+WORDSIZE,</span></span>
<span class="tr"><span class="th" id="line1286">1286</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(INPUT_BUFFER_LEN-WORDSIZE)-1);</span></span>
<span class="tr"><span class="th" id="line1287">1287</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(done&nbsp;==&nbsp;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1288">1288</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_stream_close(gg_commandstr,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1289">1289</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_commandstr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1290">1290</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_command_reading&nbsp;=&nbsp;false;</span></span>
<span class="tr"><span class="th" id="line1291">1291</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1292">1292</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1293">1293</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Trim&nbsp;the&nbsp;trailing&nbsp;newline</span></span>
<span class="tr"><span class="th" id="line1294">1294</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((a_buffer+WORDSIZE)-&gt;(done-1)&nbsp;==&nbsp;10)&nbsp;done&nbsp;=&nbsp;done-1;</span></span>
<span class="tr"><span class="th" id="line1295">1295</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_buffer--&gt;0&nbsp;=&nbsp;done;</span></span>
<span class="tr"><span class="th" id="line1296">1296</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VM_Style(INPUT_VMSTY);</span></span>
<span class="tr"><span class="th" id="line1297">1297</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_put_buffer(a_buffer+WORDSIZE,&nbsp;done);</span></span>
<span class="tr"><span class="th" id="line1298">1298</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VM_Style(NORMAL_VMSTY);</span></span>
<span class="tr"><span class="th" id="line1299">1299</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;^&quot;;</span></span>
<span class="tr"><span class="th" id="line1300">1300</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jump&nbsp;<a href="./Glulx.i6t.html#line1324">KPContinue</a>;</span></span>
<span class="tr"><span class="th" id="line1301">1301</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1302">1302</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1303">1303</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;false;</span></span>
<span class="tr"><span class="th" id="line1304">1304</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_request_line_event(gg_mainwin,&nbsp;a_buffer+WORDSIZE,&nbsp;INPUT_BUFFER_LEN-WORDSIZE,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1305">1305</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(~~done)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1306">1306</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_select(gg_event);</span></span>
<span class="tr"><span class="th" id="line1307">1307</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(gg_event--&gt;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1308">1308</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5:&nbsp;!&nbsp;evtype_Arrange</span></span>
<span class="tr"><span class="th" id="line1309">1309</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DrawStatusLine();</span></span>
<span class="tr"><span class="th" id="line1310">1310</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3:&nbsp;!&nbsp;evtype_LineInput</span></span>
<span class="tr"><span class="th" id="line1311">1311</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_event--&gt;1&nbsp;==&nbsp;gg_mainwin)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1312">1312</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a_buffer--&gt;0&nbsp;=&nbsp;gg_event--&gt;2;</span></span>
<span class="tr"><span class="th" id="line1313">1313</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;=&nbsp;true;</span></span>
<span class="tr"><span class="th" id="line1314">1314</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1315">1315</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1316">1316</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;HandleGlkEvent(gg_event,&nbsp;0,&nbsp;a_buffer);</span></span>
<span class="tr"><span class="th" id="line1317">1317</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ix&nbsp;==&nbsp;2)&nbsp;done&nbsp;=&nbsp;true;</span></span>
<span class="tr"><span class="th" id="line1318">1318</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(ix&nbsp;==&nbsp;-1)&nbsp;done&nbsp;=&nbsp;false;</span></span>
<span class="tr"><span class="th" id="line1319">1319</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1320">1320</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_commandstr&nbsp;~=&nbsp;0&nbsp;&amp;&amp;&nbsp;gg_command_reading&nbsp;==&nbsp;false)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1321">1321</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_put_buffer_stream(gg_commandstr,&nbsp;a_buffer+WORDSIZE,&nbsp;a_buffer--&gt;0);</span></span>
<span class="tr"><span class="th" id="line1322">1322</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_put_char_stream(gg_commandstr,&nbsp;10);&nbsp;!&nbsp;newline</span></span>
<span class="tr"><span class="th" id="line1323">1323</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1324">1324</span><span class="td">&nbsp;&nbsp;.KPContinue;</span></span>
<span class="tr"><span class="th" id="line1325">1325</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;VM_Tokenise(a_buffer,a_table);</span></span>
<span class="tr"><span class="th" id="line1326">1326</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;It&#39;s&nbsp;time&nbsp;to&nbsp;close&nbsp;any&nbsp;quote&nbsp;window&nbsp;we&#39;ve&nbsp;got&nbsp;going.</span></span>
<span class="tr"><span class="th" id="line1327">1327</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_quotewin)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1328">1328</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_close(gg_quotewin,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1329">1329</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_quotewin&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1330">1330</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1331">1331</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;#ifdef&nbsp;ECHO_COMMANDS;</span></span>
<span class="tr"><span class="th" id="line1332">1332</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;**&nbsp;&quot;;</span></span>
<span class="tr"><span class="th" id="line1333">1333</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(ix=WORDSIZE:&nbsp;ix&lt;(a_buffer--&gt;0)+WORDSIZE:&nbsp;ix++)&nbsp;print&nbsp;(char)&nbsp;a_buffer-&gt;ix;</span></span>
<span class="tr"><span class="th" id="line1334">1334</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;^&quot;;</span></span>
<span class="tr"><span class="th" id="line1335">1335</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;#endif;&nbsp;!&nbsp;ECHO_COMMANDS</span></span>
<span class="tr"><span class="th" id="line1336">1336</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-buffer-functions">Buffer Functions.</h3><p><p> A &quot;buffer&quot;, in this sense, is an array containing a stream of characters typed from the keyboard; a &quot;parse buffer&quot; is an array which resolves this into individual words, pointing to the relevant entries in the dictionary structure. Because each VM has its own format for each of these arrays (not to mention the dictionary), we have to provide some standard operations needed by the rest of the template as routines for each VM.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1359">VM_CopyBuffer(to, from)</a></span> copies one buffer into another.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1381">VM_Tokenise(buff, parse_buff)</a></span> takes the text in the buffer <span class="fixed">buff</span> and produces the corresponding data in the parse buffer <span class="fixed">parse_buff</span> &ndash; this is called tokenisation since the characters are divided into words: in traditional computing jargon, such clumps of characters treated syntactically as units are called tokens.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1426">LTI_Insert</a></span> is documented in the DM4 and the <span class="fixed">LTI</span> prefix stands for &quot;Language To Informese&quot;: it&#39;s used only by translations into non-English languages of play, and is not called in the template.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1359">1359</span><span class="td">[&nbsp;VM_CopyBuffer&nbsp;bto&nbsp;bfrom&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1360">1360</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i=0:&nbsp;i&lt;INPUT_BUFFER_LEN:&nbsp;i++)&nbsp;bto-&gt;i&nbsp;=&nbsp;bfrom-&gt;i;</span></span>
<span class="tr"><span class="th" id="line1361">1361</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1362">1362</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1363">1363</span><span class="td">[&nbsp;VM_PrintToBuffer&nbsp;buf&nbsp;len&nbsp;a&nbsp;b&nbsp;c;</span></span>
<span class="tr"><span class="th" id="line1364">1364</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(b)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1365">1365</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(metaclass(a)&nbsp;==&nbsp;Object&nbsp;&amp;&amp;&nbsp;a.#b&nbsp;==&nbsp;WORDSIZE</span></span>
<span class="tr"><span class="th" id="line1366">1366</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;metaclass(a.b)&nbsp;==&nbsp;String)</span></span>
<span class="tr"><span class="th" id="line1367">1367</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf--&gt;0&nbsp;=&nbsp;Glulx_PrintAnyToArray(buf+WORDSIZE,&nbsp;len,&nbsp;a.b);</span></span>
<span class="tr"><span class="th" id="line1368">1368</span><span class="td">&nbsp;&nbsp;else&nbsp;if&nbsp;(metaclass(a)&nbsp;==&nbsp;Routine)</span></span>
<span class="tr"><span class="th" id="line1369">1369</span><span class="td">&nbsp;&nbsp;&nbsp;buf--&gt;0&nbsp;=&nbsp;Glulx_PrintAnyToArray(buf+WORDSIZE,&nbsp;len,&nbsp;a,&nbsp;b,&nbsp;c);</span></span>
<span class="tr"><span class="th" id="line1370">1370</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span></span>
<span class="tr"><span class="th" id="line1371">1371</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf--&gt;0&nbsp;=&nbsp;Glulx_PrintAnyToArray(buf+WORDSIZE,&nbsp;len,&nbsp;a,&nbsp;b);</span></span>
<span class="tr"><span class="th" id="line1372">1372</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1373">1373</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(metaclass(a)&nbsp;==&nbsp;Routine)</span></span>
<span class="tr"><span class="th" id="line1374">1374</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf--&gt;0&nbsp;=&nbsp;Glulx_PrintAnyToArray(buf+WORDSIZE,&nbsp;len,&nbsp;a,&nbsp;b,&nbsp;c);</span></span>
<span class="tr"><span class="th" id="line1375">1375</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;else</span></span>
<span class="tr"><span class="th" id="line1376">1376</span><span class="td">&nbsp;&nbsp;buf--&gt;0&nbsp;=&nbsp;Glulx_PrintAnyToArray(buf+WORDSIZE,&nbsp;len,&nbsp;a);</span></span>
<span class="tr"><span class="th" id="line1377">1377</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(buf--&gt;0&nbsp;&gt;&nbsp;len)&nbsp;buf--&gt;0&nbsp;=&nbsp;len;</span></span>
<span class="tr"><span class="th" id="line1378">1378</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;buf--&gt;0;</span></span>
<span class="tr"><span class="th" id="line1379">1379</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1380">1380</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1381">1381</span><span class="td">[&nbsp;VM_Tokenise&nbsp;buf&nbsp;tab</span></span>
<span class="tr"><span class="th" id="line1382">1382</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;cx&nbsp;numwords&nbsp;len&nbsp;bx&nbsp;ix&nbsp;wx&nbsp;wpos&nbsp;wlen&nbsp;val&nbsp;res&nbsp;dictlen&nbsp;entrylen;</span></span>
<span class="tr"><span class="th" id="line1383">1383</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;buf--&gt;0;</span></span>
<span class="tr"><span class="th" id="line1384">1384</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;buf&nbsp;=&nbsp;buf+WORDSIZE;</span></span>
<span class="tr"><span class="th" id="line1385">1385</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1386">1386</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;First,&nbsp;split&nbsp;the&nbsp;buffer&nbsp;up&nbsp;into&nbsp;words.&nbsp;We&nbsp;use&nbsp;the&nbsp;standard&nbsp;Infocom</span></span>
<span class="tr"><span class="th" id="line1387">1387</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;list&nbsp;of&nbsp;word&nbsp;separators&nbsp;(comma,&nbsp;period,&nbsp;double-quote).</span></span>
<span class="tr"><span class="th" id="line1388">1388</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;cx&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1389">1389</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;numwords&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1390">1390</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(cx&nbsp;&lt;&nbsp;len)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1391">1391</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(cx&nbsp;&lt;&nbsp;len&nbsp;&amp;&amp;&nbsp;buf-&gt;cx&nbsp;==&nbsp;&#39;&nbsp;&#39;)&nbsp;cx++;</span></span>
<span class="tr"><span class="th" id="line1392">1392</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(cx&nbsp;&gt;=&nbsp;len)&nbsp;break;</span></span>
<span class="tr"><span class="th" id="line1393">1393</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bx&nbsp;=&nbsp;cx;</span></span>
<span class="tr"><span class="th" id="line1394">1394</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(buf-&gt;cx&nbsp;==&nbsp;&#39;.&#39;&nbsp;or&nbsp;&#39;,&#39;&nbsp;or&nbsp;&#39;&quot;&#39;)&nbsp;cx++;</span></span>
<span class="tr"><span class="th" id="line1395">1395</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1396">1396</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(cx&nbsp;&lt;&nbsp;len&nbsp;&amp;&amp;&nbsp;buf-&gt;cx&nbsp;~=&nbsp;&#39;&nbsp;&#39;&nbsp;or&nbsp;&#39;.&#39;&nbsp;or&nbsp;&#39;,&#39;&nbsp;or&nbsp;&#39;&quot;&#39;)&nbsp;cx++;</span></span>
<span class="tr"><span class="th" id="line1397">1397</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1398">1398</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tab--&gt;(numwords*3+2)&nbsp;=&nbsp;(cx-bx);</span></span>
<span class="tr"><span class="th" id="line1399">1399</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tab--&gt;(numwords*3+3)&nbsp;=&nbsp;WORDSIZE+bx;</span></span>
<span class="tr"><span class="th" id="line1400">1400</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;numwords++;</span></span>
<span class="tr"><span class="th" id="line1401">1401</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(numwords&nbsp;&gt;=&nbsp;MAX_BUFFER_WORDS)&nbsp;break;</span></span>
<span class="tr"><span class="th" id="line1402">1402</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1403">1403</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;tab--&gt;0&nbsp;=&nbsp;numwords;</span></span>
<span class="tr"><span class="th" id="line1404">1404</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Now&nbsp;we&nbsp;look&nbsp;each&nbsp;word&nbsp;up&nbsp;in&nbsp;the&nbsp;dictionary.</span></span>
<span class="tr"><span class="th" id="line1405">1405</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1406">1406</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;dictlen&nbsp;=&nbsp;#dictionary_table--&gt;0;</span></span>
<span class="tr"><span class="th" id="line1407">1407</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;entrylen&nbsp;=&nbsp;DICT_WORD_SIZE&nbsp;+&nbsp;7;</span></span>
<span class="tr"><span class="th" id="line1408">1408</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1409">1409</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(wx=0&nbsp;:&nbsp;wx&lt;numwords&nbsp;:&nbsp;wx++)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1410">1410</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wlen&nbsp;=&nbsp;tab--&gt;(wx*3+2);</span></span>
<span class="tr"><span class="th" id="line1411">1411</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wpos&nbsp;=&nbsp;tab--&gt;(wx*3+3);</span></span>
<span class="tr"><span class="th" id="line1412">1412</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1413">1413</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Copy&nbsp;the&nbsp;word&nbsp;into&nbsp;the&nbsp;gg_tokenbuf&nbsp;array,&nbsp;clipping&nbsp;to&nbsp;DICT_WORD_SIZE</span></span>
<span class="tr"><span class="th" id="line1414">1414</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;characters&nbsp;and&nbsp;lower&nbsp;case.</span></span>
<span class="tr"><span class="th" id="line1415">1415</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(wlen&nbsp;&gt;&nbsp;DICT_WORD_SIZE)&nbsp;wlen&nbsp;=&nbsp;DICT_WORD_SIZE;</span></span>
<span class="tr"><span class="th" id="line1416">1416</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cx&nbsp;=&nbsp;wpos&nbsp;-&nbsp;WORDSIZE;</span></span>
<span class="tr"><span class="th" id="line1417">1417</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(ix=0&nbsp;:&nbsp;ix&lt;wlen&nbsp;:&nbsp;ix++)&nbsp;gg_tokenbuf-&gt;ix&nbsp;=&nbsp;VM_UpperToLowerCase(buf-&gt;(cx+ix));</span></span>
<span class="tr"><span class="th" id="line1418">1418</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(:&nbsp;ix&lt;DICT_WORD_SIZE&nbsp;:&nbsp;ix++)&nbsp;gg_tokenbuf-&gt;ix&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1419">1419</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1420">1420</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;=&nbsp;#dictionary_table&nbsp;+&nbsp;WORDSIZE;</span></span>
<span class="tr"><span class="th" id="line1421">1421</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@binarysearch&nbsp;gg_tokenbuf&nbsp;DICT_WORD_SIZE&nbsp;val&nbsp;entrylen&nbsp;dictlen&nbsp;1&nbsp;1&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line1422">1422</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tab--&gt;(wx*3+1)&nbsp;=&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line1423">1423</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1424">1424</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1425">1425</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1426">1426</span><span class="td">[&nbsp;LTI_Insert&nbsp;i&nbsp;ch&nbsp;&nbsp;b&nbsp;y;</span></span>
<span class="tr"><span class="th" id="line1427">1427</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1428">1428</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Protect&nbsp;us&nbsp;from&nbsp;strict&nbsp;mode,&nbsp;as&nbsp;this&nbsp;isn&#39;t&nbsp;an&nbsp;array&nbsp;in&nbsp;quite&nbsp;the</span></span>
<span class="tr"><span class="th" id="line1429">1429</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;sense&nbsp;it&nbsp;expects</span></span>
<span class="tr"><span class="th" id="line1430">1430</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;buffer;</span></span>
<span class="tr"><span class="th" id="line1431">1431</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1432">1432</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Insert&nbsp;character&nbsp;ch&nbsp;into&nbsp;buffer&nbsp;at&nbsp;point&nbsp;i.</span></span>
<span class="tr"><span class="th" id="line1433">1433</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Being&nbsp;careful&nbsp;not&nbsp;to&nbsp;let&nbsp;the&nbsp;buffer&nbsp;possibly&nbsp;overflow:</span></span>
<span class="tr"><span class="th" id="line1434">1434</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;b--&gt;0;</span></span>
<span class="tr"><span class="th" id="line1435">1435</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(y&nbsp;&gt;&nbsp;INPUT_BUFFER_LEN)&nbsp;y&nbsp;=&nbsp;INPUT_BUFFER_LEN;</span></span>
<span class="tr"><span class="th" id="line1436">1436</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1437">1437</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Move&nbsp;the&nbsp;subsequent&nbsp;text&nbsp;along&nbsp;one&nbsp;character:</span></span>
<span class="tr"><span class="th" id="line1438">1438</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(y=y+WORDSIZE&nbsp;:&nbsp;y&gt;i&nbsp;:&nbsp;y--)&nbsp;b-&gt;y&nbsp;=&nbsp;b-&gt;(y-1);</span></span>
<span class="tr"><span class="th" id="line1439">1439</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;b-&gt;i&nbsp;=&nbsp;ch;</span></span>
<span class="tr"><span class="th" id="line1440">1440</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1441">1441</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;And&nbsp;the&nbsp;text&nbsp;is&nbsp;now&nbsp;one&nbsp;character&nbsp;longer:</span></span>
<span class="tr"><span class="th" id="line1442">1442</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(b--&gt;0&nbsp;&lt;&nbsp;INPUT_BUFFER_LEN)&nbsp;(b--&gt;0)++;</span></span>
<span class="tr"><span class="th" id="line1443">1443</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-dictionary-functions">Dictionary Functions.</h3><p><p> Again, the dictionary structure is differently arranged on the different VMs. This is a data structure containing, in compressed form, the text of all the words to be recognised by tokenisation (above). In I6 for Glulx, a dictionary word is represented at run-time by its record&#39;s address in the dictionary.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1462">VM_InvalidDictionaryAddress(A)</a></span> tests whether <span class="fixed">A</span> is a valid record address in the dictionary data structure. In Glulx, dictionary records might in theory be anywhere in the 2 GB or so of possible memory, but we can rule out negative addresses. (This allows <em>-1</em>, say, to be used as a value meaning &quot;not a valid dictionary word&quot;.)<p></p><p><span class="fixed"><a href="./Glulx.i6t.html#line1467">VM_DictionaryAddressToNumber(A)</a></span> and <span class="fixed"><a href="./Glulx.i6t.html#line1468">VM_NumberToDictionaryAddress(N)</a></span><br> convert between word addresses and their run-time representations: since, on Glulx, they are the same, these are each the identity function.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1462">1462</span><span class="td">[&nbsp;VM_InvalidDictionaryAddress&nbsp;addr;</span></span>
<span class="tr"><span class="th" id="line1463">1463</span><span class="td">&nbsp;if&nbsp;(addr&nbsp;&lt;&nbsp;0)&nbsp;rtrue;</span></span>
<span class="tr"><span class="th" id="line1464">1464</span><span class="td">&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line1465">1465</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1466">1466</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1467">1467</span><span class="td">[&nbsp;VM_DictionaryAddressToNumber&nbsp;w;&nbsp;return&nbsp;w;&nbsp;];</span></span>
<span class="tr"><span class="th" id="line1468">1468</span><span class="td">[&nbsp;VM_NumberToDictionaryAddress&nbsp;n;&nbsp;return&nbsp;n;&nbsp;];</span></span>
<span class="tr"><span class="th" id="line1469">1469</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1470">1470</span><span class="td">Array&nbsp;gg_tokenbuf&nbsp;-&gt;&nbsp;DICT_WORD_SIZE;</span></span>
<span class="tr"><span class="th" id="line1471">1471</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1472">1472</span><span class="td">[&nbsp;GGWordCompare&nbsp;str1&nbsp;str2&nbsp;ix&nbsp;jx;</span></span>
<span class="tr"><span class="th" id="line1473">1473</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(ix=0&nbsp;:&nbsp;ix&lt;DICT_WORD_SIZE&nbsp;:&nbsp;ix++)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1474">1474</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jx&nbsp;=&nbsp;(str1-&gt;ix)&nbsp;-&nbsp;(str2-&gt;ix);</span></span>
<span class="tr"><span class="th" id="line1475">1475</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(jx&nbsp;~=&nbsp;0)&nbsp;return&nbsp;jx;</span></span>
<span class="tr"><span class="th" id="line1476">1476</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1477">1477</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1478">1478</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-showverb-support">SHOWVERB support.</h3><p><p> Further VM-specific tables cover actions and attributes, and these are used by the SHOWVERB testing command.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1485">1485</span><span class="td">#Ifdef&nbsp;DEBUG;</span></span>
<span class="tr"><span class="th" id="line1486">1486</span><span class="td">[&nbsp;DebugAction&nbsp;a&nbsp;str;</span></span>
<span class="tr"><span class="th" id="line1487">1487</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(a&nbsp;&gt;=&nbsp;4096)&nbsp;{&nbsp;print&nbsp;&quot;&lt;fake&nbsp;action&nbsp;&quot;,&nbsp;a-4096,&nbsp;&quot;&gt;&quot;;&nbsp;return;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1488">1488</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(a&nbsp;&lt;&nbsp;0&nbsp;||&nbsp;a&nbsp;&gt;=&nbsp;#identifiers_table--&gt;7)&nbsp;print&nbsp;&quot;&lt;invalid&nbsp;action&nbsp;&quot;,&nbsp;a,&nbsp;&quot;&gt;&quot;;</span></span>
<span class="tr"><span class="th" id="line1489">1489</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1490">1490</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;=&nbsp;#identifiers_table--&gt;6;</span></span>
<span class="tr"><span class="th" id="line1491">1491</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;=&nbsp;str--&gt;a;</span></span>
<span class="tr"><span class="th" id="line1492">1492</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(str)&nbsp;print&nbsp;(string)&nbsp;str;&nbsp;else&nbsp;print&nbsp;&quot;&lt;unnamed&nbsp;action&nbsp;&quot;,&nbsp;a,&nbsp;&quot;&gt;&quot;;</span></span>
<span class="tr"><span class="th" id="line1493">1493</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1494">1494</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1495">1495</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1496">1496</span><span class="td">[&nbsp;DebugAttribute&nbsp;a&nbsp;str;</span></span>
<span class="tr"><span class="th" id="line1497">1497</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(a&nbsp;&lt;&nbsp;0&nbsp;||&nbsp;a&nbsp;&gt;=&nbsp;NUM_ATTR_BYTES*8)&nbsp;print&nbsp;&quot;&lt;invalid&nbsp;attribute&nbsp;&quot;,&nbsp;a,&nbsp;&quot;&gt;&quot;;</span></span>
<span class="tr"><span class="th" id="line1498">1498</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1499">1499</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;=&nbsp;#identifiers_table--&gt;4;</span></span>
<span class="tr"><span class="th" id="line1500">1500</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;=&nbsp;str--&gt;a;</span></span>
<span class="tr"><span class="th" id="line1501">1501</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(str)&nbsp;print&nbsp;(string)&nbsp;str;&nbsp;else&nbsp;print&nbsp;&quot;&lt;unnamed&nbsp;attribute&nbsp;&quot;,&nbsp;a,&nbsp;&quot;&gt;&quot;;</span></span>
<span class="tr"><span class="th" id="line1502">1502</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1503">1503</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1504">1504</span><span class="td">#Endif;</span></span>
</div><div class='text'>
<h3 id="#glulx-command-tables">Command Tables.</h3><p><p> The VM is also generated containing a data structure for the grammar produced by I6&#39;s <span class="fixed">Verb</span> and <span class="fixed">Extend</span> directives: this is essentially a list of command verbs such as DROP or PUSH, together with a list of synonyms, and then the grammar for the subsequent commands to be recognised by the parser.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1514">1514</span><span class="td">[&nbsp;VM_CommandTableAddress&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1515">1515</span><span class="td">&nbsp;return&nbsp;(#grammar_table)--&gt;(i+1);</span></span>
<span class="tr"><span class="th" id="line1516">1516</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1517">1517</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1518">1518</span><span class="td">[&nbsp;VM_PrintCommandWords&nbsp;i&nbsp;wd&nbsp;j&nbsp;dictlen&nbsp;entrylen;</span></span>
<span class="tr"><span class="th" id="line1519">1519</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;dictlen&nbsp;=&nbsp;#dictionary_table--&gt;0;</span></span>
<span class="tr"><span class="th" id="line1520">1520</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;entrylen&nbsp;=&nbsp;DICT_WORD_SIZE&nbsp;+&nbsp;7;</span></span>
<span class="tr"><span class="th" id="line1521">1521</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(j=0&nbsp;:&nbsp;j&lt;dictlen&nbsp;:&nbsp;j++)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1522">1522</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wd&nbsp;=&nbsp;#dictionary_table&nbsp;+&nbsp;WORDSIZE&nbsp;+&nbsp;entrylen*j;</span></span>
<span class="tr"><span class="th" id="line1523">1523</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(DictionaryWordToVerbNum(wd)&nbsp;==&nbsp;i)</span></span>
<span class="tr"><span class="th" id="line1524">1524</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&#39;&quot;,&nbsp;(address)&nbsp;wd,&nbsp;&quot;&#39;&nbsp;&quot;;</span></span>
<span class="tr"><span class="th" id="line1525">1525</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1526">1526</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-random-number-generator">Random Number Generator.</h3><p><p> No routine is needed for extracting a random number, since I6&#39;s built-in <span class="fixed">random</span> function does that, but it&#39;s useful to abstract the process of seeding the RNG so that it produces a repeatable sequence of &quot;random&quot; numbers from here on: the necessary opcodes are different for the two VMs.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1535">1535</span><span class="td">[&nbsp;VM_Seed_RNG&nbsp;n;</span></span>
<span class="tr"><span class="th" id="line1536">1536</span><span class="td">&nbsp;@setrandom&nbsp;n;</span></span>
<span class="tr"><span class="th" id="line1537">1537</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-memory-allocation">Memory Allocation.</h3><p><p> This is dynamic memory allocation: something which is never practicable in the Z-machine, because the whole address range is already claimed, but which is viable on recent revisions of Glulx.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1545">1545</span><span class="td">[&nbsp;VM_AllocateMemory&nbsp;amount&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1546">1546</span><span class="td">&nbsp;@gestalt&nbsp;7&nbsp;0&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1547">1547</span><span class="td">&nbsp;if&nbsp;(i&nbsp;==&nbsp;0)&nbsp;return&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1548">1548</span><span class="td">&nbsp;@malloc&nbsp;amount&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1549">1549</span><span class="td">&nbsp;return&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1550">1550</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1551">1551</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1552">1552</span><span class="td">[&nbsp;VM_FreeMemory&nbsp;address&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1553">1553</span><span class="td">&nbsp;@gestalt&nbsp;7&nbsp;0&nbsp;i;</span></span>
<span class="tr"><span class="th" id="line1554">1554</span><span class="td">&nbsp;if&nbsp;(i&nbsp;==&nbsp;0)&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1555">1555</span><span class="td">&nbsp;@mfree&nbsp;address;</span></span>
<span class="tr"><span class="th" id="line1556">1556</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-audiovisual-resources">Audiovisual Resources.</h3><p><p> The Z-machine only barely supports figures and sound effects, so Glulx is the preferred VM to choose if they are wanted. Properly speaking, it&#39;s not Glulx which supports these, but its I/O layer Glk, and implementations of Glk are free to support them or not as they please: &quot;cheapglk&quot;, a dumb terminal version, does not, for instance. We therefore have to investigate the &quot;gestalt&quot; to find out.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1567">1567</span><span class="td">[&nbsp;VM_Picture&nbsp;resource_ID;</span></span>
<span class="tr"><span class="th" id="line1568">1568</span><span class="td">&nbsp;if&nbsp;(glk_gestalt(gestalt_Graphics,&nbsp;0))&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1569">1569</span><span class="td">&nbsp;&nbsp;glk_image_draw(gg_mainwin,&nbsp;resource_ID,&nbsp;imagealign_InlineCenter,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1570">1570</span><span class="td">&nbsp;}&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1571">1571</span><span class="td">&nbsp;&nbsp;print&nbsp;&quot;[Picture&nbsp;number&nbsp;&quot;,&nbsp;resource_ID,&nbsp;&quot;&nbsp;here.]^&quot;;</span></span>
<span class="tr"><span class="th" id="line1572">1572</span><span class="td">&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1573">1573</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1574">1574</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1575">1575</span><span class="td">[&nbsp;VM_SoundEffect&nbsp;resource_ID;</span></span>
<span class="tr"><span class="th" id="line1576">1576</span><span class="td">&nbsp;if&nbsp;(glk_gestalt(gestalt_Sound,&nbsp;0))&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1577">1577</span><span class="td">&nbsp;&nbsp;glk_schannel_play(gg_foregroundchan,&nbsp;resource_ID);</span></span>
<span class="tr"><span class="th" id="line1578">1578</span><span class="td">&nbsp;}&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1579">1579</span><span class="td">&nbsp;&nbsp;print&nbsp;&quot;[Sound&nbsp;effect&nbsp;number&nbsp;&quot;,&nbsp;resource_ID,&nbsp;&quot;&nbsp;here.]^&quot;;</span></span>
<span class="tr"><span class="th" id="line1580">1580</span><span class="td">&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1581">1581</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-typography">Typography.</h3><p><p> Glk makes an attempt to present typographic styles as being a matter of semantic markup rather than controlling the actual appearance of text: the idea is that the story file should want to print something in a heading kind of way, and then the interpreter &ndash; guided by the player&#39;s reading preferences &ndash; might set that in bold, or larger type, or red ink, or any combination of the three, or with other effects entirely. This is not the place to discuss whether that was a wise decision for Glk to take (it really, really, <strong> really</strong> wasn&#39;t): we can only play along.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1594">1594</span><span class="td">[&nbsp;VM_Style&nbsp;sty;</span></span>
<span class="tr"><span class="th" id="line1595">1595</span><span class="td">&nbsp;switch&nbsp;(sty)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1596">1596</span><span class="td">&nbsp;&nbsp;NORMAL_VMSTY:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_set_style(style_Normal);</span></span>
<span class="tr"><span class="th" id="line1597">1597</span><span class="td">&nbsp;&nbsp;HEADER_VMSTY:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_set_style(style_Header);</span></span>
<span class="tr"><span class="th" id="line1598">1598</span><span class="td">&nbsp;&nbsp;SUBHEADER_VMSTY:&nbsp;&nbsp;glk_set_style(style_Subheader);</span></span>
<span class="tr"><span class="th" id="line1599">1599</span><span class="td">&nbsp;&nbsp;NOTE_VMSTY:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_set_style(style_Note);</span></span>
<span class="tr"><span class="th" id="line1600">1600</span><span class="td">&nbsp;&nbsp;ALERT_VMSTY:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_set_style(style_Alert);</span></span>
<span class="tr"><span class="th" id="line1601">1601</span><span class="td">&nbsp;&nbsp;BLOCKQUOTE_VMSTY:&nbsp;glk_set_style(style_BlockQuote);</span></span>
<span class="tr"><span class="th" id="line1602">1602</span><span class="td">&nbsp;&nbsp;INPUT_VMSTY:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_set_style(style_Input);</span></span>
<span class="tr"><span class="th" id="line1603">1603</span><span class="td">&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1604">1604</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-character-casing">Character Casing.</h3><p><p> The following are the equivalent of <span class="fixed">tolower</span> and <span class="fixed">toupper</span>, the traditional C library functions for forcing letters into lower and upper case form, for the ZSCII character set. Note that Glulx can also use Unicode characters for some purposes (Unicode was a relatively late addition to the Glulx standard), and we make good use of this when storing text.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1614">1614</span><span class="td">[&nbsp;VM_UpperToLowerCase&nbsp;c;&nbsp;return&nbsp;glk_char_to_lower(c);&nbsp;];</span></span>
<span class="tr"><span class="th" id="line1615">1615</span><span class="td">[&nbsp;VM_LowerToUpperCase&nbsp;c;&nbsp;return&nbsp;glk_char_to_upper(c);&nbsp;];</span></span>
</div><div class='text'>
<h3 id="#glulx-glulx-only-printing-routines">Glulx-Only Printing Routines.</h3><p><p> Partly because of the smallness of the range of representable values in the Z-machine, there is little run-time type-checking that can be done: for instance a dictionary address cannot be distinguished from a function address because they are encoded differently, so that a function address (which is packed) could well coincide with that of a dictionary word (which is not). On Glulx these restrictions are somewhat lifted, so that it&#39;s possible to write a routine which can look at a value, work out what it must mean, and print it suitably. This is only possible up to a point &ndash; for instance, it can&#39;t distinguish an integer from a function address &ndash; and in I7 the use of this sort of trick is much less important because type-checking in the NI compiler handles the problem much better. Still, we retain some Glulx-only features because they are convenient for writing external files to disc, for instance, something which the Z-machine can&#39;t do in any case.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1661">Glulx_PrintAnything</a></span> handles strings, functions (with optional arguments), objects, object properties (with optional arguments), and dictionary words.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1700">Glulx_PrintAnyToArray</a></span> does the same, but the output is sent to a byte array in memory. The first two arguments must be the array address and length; subsequent arguments are as for <span class="fixed"><a href="./Glulx.i6t.html#line1661">Glulx_PrintAnything</a></span>. The return value is the number of characters output. If the output is longer than the array length given, the extra characters are discarded, so the array does not overflow. (However, the return value is the total length of the output, including discarded characters.) The character set stored here is ZSCII, not Unicode.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1725">Glulx_ChangeAnyToCString</a></span> calls <span class="fixed"><a href="./Glulx.i6t.html#line1700">Glulx_PrintAnyToArray</a></span> on a particular array, then amends the result to make it a C-style string &ndash; that is, a sequence of byte-sized characters which are null terminated. The character set stored here is once again ZSCII, not Unicode.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1651">1651</span><span class="td">!&nbsp;Glulx_PrintAnything()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;nothing&nbsp;printed&gt;</span></span>
<span class="tr"><span class="th" id="line1652">1652</span><span class="td">!&nbsp;Glulx_PrintAnything(0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;nothing&nbsp;printed&gt;</span></span>
<span class="tr"><span class="th" id="line1653">1653</span><span class="td">!&nbsp;Glulx_PrintAnything(&quot;string&quot;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(string)&nbsp;&quot;string&quot;;</span></span>
<span class="tr"><span class="th" id="line1654">1654</span><span class="td">!&nbsp;Glulx_PrintAnything(&#39;word&#39;)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(address)&nbsp;&#39;word&#39;;</span></span>
<span class="tr"><span class="th" id="line1655">1655</span><span class="td">!&nbsp;Glulx_PrintAnything(obj)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(name)&nbsp;obj;</span></span>
<span class="tr"><span class="th" id="line1656">1656</span><span class="td">!&nbsp;Glulx_PrintAnything(obj,&nbsp;prop)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj.prop();</span></span>
<span class="tr"><span class="th" id="line1657">1657</span><span class="td">!&nbsp;Glulx_PrintAnything(obj,&nbsp;prop,&nbsp;args...)&nbsp;&nbsp;obj.prop(args...);</span></span>
<span class="tr"><span class="th" id="line1658">1658</span><span class="td">!&nbsp;Glulx_PrintAnything(func)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func();</span></span>
<span class="tr"><span class="th" id="line1659">1659</span><span class="td">!&nbsp;Glulx_PrintAnything(func,&nbsp;args...)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func(args...);</span></span>
<span class="tr"><span class="th" id="line1660">1660</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1661">1661</span><span class="td">[&nbsp;Glulx_PrintAnything&nbsp;_vararg_count&nbsp;obj&nbsp;mclass;</span></span>
<span class="tr"><span class="th" id="line1662">1662</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(_vararg_count&nbsp;==&nbsp;0)&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1663">1663</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@copy&nbsp;sp&nbsp;obj;</span></span>
<span class="tr"><span class="th" id="line1664">1664</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;_vararg_count--;</span></span>
<span class="tr"><span class="th" id="line1665">1665</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(obj&nbsp;==&nbsp;0)&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1666">1666</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1667">1667</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(obj-&gt;0&nbsp;==&nbsp;$60)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1668">1668</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Dictionary&nbsp;word.&nbsp;Metaclass()&nbsp;can&#39;t&nbsp;catch&nbsp;this&nbsp;case,&nbsp;so&nbsp;we&nbsp;do&nbsp;it&nbsp;manually</span></span>
<span class="tr"><span class="th" id="line1669">1669</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(address)&nbsp;obj;</span></span>
<span class="tr"><span class="th" id="line1670">1670</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1671">1671</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1672">1672</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1673">1673</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;mclass&nbsp;=&nbsp;metaclass(obj);</span></span>
<span class="tr"><span class="th" id="line1674">1674</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(mclass)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1675">1675</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nothing:</span></span>
<span class="tr"><span class="th" id="line1676">1676</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1677">1677</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String:</span></span>
<span class="tr"><span class="th" id="line1678">1678</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(string)&nbsp;obj;</span></span>
<span class="tr"><span class="th" id="line1679">1679</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1680">1680</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Routine:</span></span>
<span class="tr"><span class="th" id="line1681">1681</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Call&nbsp;the&nbsp;function&nbsp;with&nbsp;all&nbsp;the&nbsp;arguments&nbsp;which&nbsp;are&nbsp;already</span></span>
<span class="tr"><span class="th" id="line1682">1682</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;on&nbsp;the&nbsp;stack.</span></span>
<span class="tr"><span class="th" id="line1683">1683</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@call&nbsp;obj&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1684">1684</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1685">1685</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object:</span></span>
<span class="tr"><span class="th" id="line1686">1686</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(_vararg_count&nbsp;==&nbsp;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1687">1687</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(name)&nbsp;obj;</span></span>
<span class="tr"><span class="th" id="line1688">1688</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1689">1689</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1690">1690</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Push&nbsp;the&nbsp;object&nbsp;back&nbsp;onto&nbsp;the&nbsp;stack,&nbsp;and&nbsp;call&nbsp;the</span></span>
<span class="tr"><span class="th" id="line1691">1691</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;veneer&nbsp;routine&nbsp;that&nbsp;handles&nbsp;obj.prop()&nbsp;calls.</span></span>
<span class="tr"><span class="th" id="line1692">1692</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@copy&nbsp;obj&nbsp;sp;</span></span>
<span class="tr"><span class="th" id="line1693">1693</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_vararg_count++;</span></span>
<span class="tr"><span class="th" id="line1694">1694</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@call&nbsp;CA__Pr&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1695">1695</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1696">1696</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1697">1697</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1698">1698</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1699">1699</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1700">1700</span><span class="td">[&nbsp;Glulx_PrintAnyToArray&nbsp;_vararg_count&nbsp;arr&nbsp;arrlen&nbsp;str&nbsp;oldstr&nbsp;len;</span></span>
<span class="tr"><span class="th" id="line1701">1701</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@copy&nbsp;sp&nbsp;arr;</span></span>
<span class="tr"><span class="th" id="line1702">1702</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@copy&nbsp;sp&nbsp;arrlen;</span></span>
<span class="tr"><span class="th" id="line1703">1703</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;_vararg_count&nbsp;=&nbsp;_vararg_count&nbsp;-&nbsp;2;</span></span>
<span class="tr"><span class="th" id="line1704">1704</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1705">1705</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;oldstr&nbsp;=&nbsp;glk_stream_get_current();</span></span>
<span class="tr"><span class="th" id="line1706">1706</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;str&nbsp;=&nbsp;glk_stream_open_memory(arr,&nbsp;arrlen,&nbsp;1,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1707">1707</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(str&nbsp;==&nbsp;0)&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1708">1708</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1709">1709</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_stream_set_current(str);</span></span>
<span class="tr"><span class="th" id="line1710">1710</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1711">1711</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@call&nbsp;Glulx_PrintAnything&nbsp;_vararg_count&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1712">1712</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1713">1713</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_stream_set_current(oldstr);</span></span>
<span class="tr"><span class="th" id="line1714">1714</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@copy&nbsp;$ffffffff&nbsp;sp;</span></span>
<span class="tr"><span class="th" id="line1715">1715</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@copy&nbsp;str&nbsp;sp;</span></span>
<span class="tr"><span class="th" id="line1716">1716</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@glk&nbsp;$0044&nbsp;2&nbsp;0;&nbsp;!&nbsp;stream_close</span></span>
<span class="tr"><span class="th" id="line1717">1717</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@copy&nbsp;sp&nbsp;len;</span></span>
<span class="tr"><span class="th" id="line1718">1718</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@copy&nbsp;sp&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1719">1719</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;len;</span></span>
<span class="tr"><span class="th" id="line1720">1720</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1721">1721</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1722">1722</span><span class="td">Constant&nbsp;GG_ANYTOSTRING_LEN&nbsp;66;</span></span>
<span class="tr"><span class="th" id="line1723">1723</span><span class="td">Array&nbsp;AnyToStrArr&nbsp;-&gt;&nbsp;GG_ANYTOSTRING_LEN+1;</span></span>
<span class="tr"><span class="th" id="line1724">1724</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1725">1725</span><span class="td">[&nbsp;Glulx_ChangeAnyToCString&nbsp;_vararg_count&nbsp;ix&nbsp;len;</span></span>
<span class="tr"><span class="th" id="line1726">1726</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;GG_ANYTOSTRING_LEN-2;</span></span>
<span class="tr"><span class="th" id="line1727">1727</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@copy&nbsp;ix&nbsp;sp;</span></span>
<span class="tr"><span class="th" id="line1728">1728</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;AnyToStrArr+1;</span></span>
<span class="tr"><span class="th" id="line1729">1729</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@copy&nbsp;ix&nbsp;sp;</span></span>
<span class="tr"><span class="th" id="line1730">1730</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;_vararg_count+2;</span></span>
<span class="tr"><span class="th" id="line1731">1731</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@call&nbsp;Glulx_PrintAnyToArray&nbsp;ix&nbsp;len;</span></span>
<span class="tr"><span class="th" id="line1732">1732</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;AnyToStrArr-&gt;0&nbsp;=&nbsp;$E0;</span></span>
<span class="tr"><span class="th" id="line1733">1733</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(len&nbsp;&gt;=&nbsp;GG_ANYTOSTRING_LEN)</span></span>
<span class="tr"><span class="th" id="line1734">1734</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;GG_ANYTOSTRING_LEN-1;</span></span>
<span class="tr"><span class="th" id="line1735">1735</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;AnyToStrArr-&gt;(len+1)&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1736">1736</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;AnyToStrArr;</span></span>
<span class="tr"><span class="th" id="line1737">1737</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-the-screen">The Screen.</h3><p><p> Our generic screen model is that the screen is made up of windows: we tend to refer only to two of these, the main window and the status line, but others may also exist from time to time. Windows have unique ID numbers: the special window ID <em>-1</em> means &quot;all windows&quot; or &quot;the entire screen&quot;, which usually amounts to the same thing.<p></p><p> Screen height and width are measured in characters, with respect to the fixed-pitch font used for the status line. The main window normally contains variable-pitch text which may even have been kerned, and character dimensions make little sense there.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1752">1752</span><span class="td">[&nbsp;VM_ClearScreen&nbsp;window;</span></span>
<span class="tr"><span class="th" id="line1753">1753</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(window&nbsp;==&nbsp;WIN_ALL&nbsp;or&nbsp;WIN_MAIN)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1754">1754</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_clear(gg_mainwin);</span></span>
<span class="tr"><span class="th" id="line1755">1755</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_quotewin)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1756">1756</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_close(gg_quotewin,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1757">1757</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_quotewin&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1758">1758</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1759">1759</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1760">1760</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_statuswin&nbsp;&amp;&amp;&nbsp;window&nbsp;==&nbsp;WIN_ALL&nbsp;or&nbsp;WIN_STATUS)&nbsp;glk_window_clear(gg_statuswin);</span></span>
<span class="tr"><span class="th" id="line1761">1761</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1762">1762</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1763">1763</span><span class="td">[&nbsp;VM_ScreenWidth&nbsp;&nbsp;id;</span></span>
<span class="tr"><span class="th" id="line1764">1764</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;id=gg_mainwin;</span></span>
<span class="tr"><span class="th" id="line1765">1765</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_statuswin&nbsp;&amp;&amp;&nbsp;statuswin_current)&nbsp;id&nbsp;=&nbsp;gg_statuswin;</span></span>
<span class="tr"><span class="th" id="line1766">1766</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_window_get_size(id,&nbsp;gg_arguments,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1767">1767</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;gg_arguments--&gt;0;</span></span>
<span class="tr"><span class="th" id="line1768">1768</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1769">1769</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1770">1770</span><span class="td">[&nbsp;VM_ScreenHeight;</span></span>
<span class="tr"><span class="th" id="line1771">1771</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_window_get_size(gg_mainwin,&nbsp;0,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1772">1772</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;gg_arguments--&gt;0;</span></span>
<span class="tr"><span class="th" id="line1773">1773</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-window-colours">Window Colours.</h3><p><p> Our generic screen model is that the screen is made up of windows, each of which can have its own foreground and background colours.<p></p><p> The colour of individual letters or words of type is not controllable in Glulx, to the frustration of many, and so the template layer of I7 has no framework for handling this (even though it is controllable on the Z-machine, which is greatly superior in this respect).<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1785">1785</span><span class="td">[&nbsp;VM_SetWindowColours&nbsp;f&nbsp;b&nbsp;window&nbsp;doclear&nbsp;&nbsp;i&nbsp;fwd&nbsp;bwd&nbsp;swin;</span></span>
<span class="tr"><span class="th" id="line1786">1786</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(clr_on&nbsp;&amp;&amp;&nbsp;f&nbsp;&amp;&amp;&nbsp;b)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1787">1787</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(window)&nbsp;swin&nbsp;=&nbsp;5-window;&nbsp;!&nbsp;4&nbsp;for&nbsp;TextGrid,&nbsp;3&nbsp;for&nbsp;TextBuffer</span></span>
<span class="tr"><span class="th" id="line1788">1788</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1789">1789</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fwd&nbsp;=&nbsp;MakeColourWord(f);</span></span>
<span class="tr"><span class="th" id="line1790">1790</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bwd&nbsp;=&nbsp;MakeColourWord(b);</span></span>
<span class="tr"><span class="th" id="line1791">1791</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i=0&nbsp;:&nbsp;i&lt;style_NUMSTYLES:&nbsp;i++)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1792">1792</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(f&nbsp;==&nbsp;CLR_DEFAULT&nbsp;||&nbsp;b&nbsp;==&nbsp;CLR_DEFAULT)&nbsp;{&nbsp;&nbsp;!&nbsp;remove&nbsp;style&nbsp;hints</span></span>
<span class="tr"><span class="th" id="line1793">1793</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_stylehint_clear(swin,&nbsp;i,&nbsp;stylehint_TextColor);</span></span>
<span class="tr"><span class="th" id="line1794">1794</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_stylehint_clear(swin,&nbsp;i,&nbsp;stylehint_BackColor);</span></span>
<span class="tr"><span class="th" id="line1795">1795</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1796">1796</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_stylehint_set(swin,&nbsp;i,&nbsp;stylehint_TextColor,&nbsp;fwd);</span></span>
<span class="tr"><span class="th" id="line1797">1797</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_stylehint_set(swin,&nbsp;i,&nbsp;stylehint_BackColor,&nbsp;bwd);</span></span>
<span class="tr"><span class="th" id="line1798">1798</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1799">1799</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1800">1800</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1801">1801</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;Now&nbsp;re-open&nbsp;the&nbsp;windows&nbsp;to&nbsp;apply&nbsp;the&nbsp;hints</span></span>
<span class="tr"><span class="th" id="line1802">1802</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_statuswin)&nbsp;glk_window_close(gg_statuswin,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1803">1803</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_statuswin&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line1804">1804</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1805">1805</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(doclear&nbsp;||&nbsp;(&nbsp;window&nbsp;~=&nbsp;1&nbsp;&amp;&amp;&nbsp;(clr_fg&nbsp;~=&nbsp;f&nbsp;||&nbsp;clr_bg&nbsp;~=&nbsp;b)&nbsp;)&nbsp;)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1806">1806</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_close(gg_mainwin,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1807">1807</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_mainwin&nbsp;=&nbsp;glk_window_open(0,&nbsp;0,&nbsp;0,&nbsp;wintype_TextBuffer,&nbsp;GG_MAINWIN_ROCK);</span></span>
<span class="tr"><span class="th" id="line1808">1808</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_scriptstr&nbsp;~=&nbsp;0)</span></span>
<span class="tr"><span class="th" id="line1809">1809</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_set_echo_stream(gg_mainwin,&nbsp;gg_scriptstr);</span></span>
<span class="tr"><span class="th" id="line1810">1810</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1811">1811</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1812">1812</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_statuswin&nbsp;=</span></span>
<span class="tr"><span class="th" id="line1813">1813</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_open(gg_mainwin,&nbsp;winmethod_Fixed&nbsp;+&nbsp;winmethod_Above,</span></span>
<span class="tr"><span class="th" id="line1814">1814</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;statuswin_cursize,&nbsp;wintype_TextGrid,&nbsp;GG_STATUSWIN_ROCK);</span></span>
<span class="tr"><span class="th" id="line1815">1815</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(statuswin_current&nbsp;&amp;&amp;&nbsp;gg_statuswin)&nbsp;VM_MoveCursorInStatusLine();&nbsp;else&nbsp;VM_MainWindow();</span></span>
<span class="tr"><span class="th" id="line1816">1816</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1817">1817</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(window&nbsp;~=&nbsp;2)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1818">1818</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clr_fgstatus&nbsp;=&nbsp;f;</span></span>
<span class="tr"><span class="th" id="line1819">1819</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clr_bgstatus&nbsp;=&nbsp;b;</span></span>
<span class="tr"><span class="th" id="line1820">1820</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1821">1821</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(window&nbsp;~=&nbsp;1)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1822">1822</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clr_fg&nbsp;=&nbsp;f;</span></span>
<span class="tr"><span class="th" id="line1823">1823</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clr_bg&nbsp;=&nbsp;b;</span></span>
<span class="tr"><span class="th" id="line1824">1824</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1825">1825</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1826">1826</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1827">1827</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1828">1828</span><span class="td">[&nbsp;VM_RestoreWindowColours;&nbsp;!&nbsp;used&nbsp;after&nbsp;UNDO:&nbsp;compare&nbsp;I6&nbsp;patch&nbsp;L61007</span></span>
<span class="tr"><span class="th" id="line1829">1829</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(clr_on)&nbsp;{&nbsp;!&nbsp;check&nbsp;colour&nbsp;has&nbsp;been&nbsp;used</span></span>
<span class="tr"><span class="th" id="line1830">1830</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VM_SetWindowColours(clr_fg,&nbsp;clr_bg,&nbsp;2);&nbsp;!&nbsp;make&nbsp;sure&nbsp;both&nbsp;sets&nbsp;of&nbsp;variables&nbsp;are&nbsp;restored</span></span>
<span class="tr"><span class="th" id="line1831">1831</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VM_SetWindowColours(clr_fgstatus,&nbsp;clr_bgstatus,&nbsp;1,&nbsp;true);</span></span>
<span class="tr"><span class="th" id="line1832">1832</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VM_ClearScreen();</span></span>
<span class="tr"><span class="th" id="line1833">1833</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1834">1834</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1835">1835</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1836">1836</span><span class="td">[&nbsp;MakeColourWord&nbsp;c;</span></span>
<span class="tr"><span class="th" id="line1837">1837</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(c&nbsp;&gt;&nbsp;9)&nbsp;return&nbsp;c;</span></span>
<span class="tr"><span class="th" id="line1838">1838</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;c-2;</span></span>
<span class="tr"><span class="th" id="line1839">1839</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$ff0000*(c&amp;1)&nbsp;+&nbsp;$ff00*(c&amp;2&nbsp;~=&nbsp;0)&nbsp;+&nbsp;$ff*(c&amp;4&nbsp;~=&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1840">1840</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-main-window">Main Window.</h3><p><p> The part of the screen on which commands and responses are printed, which ordinarily occupies almost all of the screen area.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1850">VM_MainWindow()</a></span> switches printing back from another window, usually the status line, to the main window.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1850">1850</span><span class="td">[&nbsp;VM_MainWindow;</span></span>
<span class="tr"><span class="th" id="line1851">1851</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_set_window(gg_mainwin);&nbsp;!&nbsp;set_window</span></span>
<span class="tr"><span class="th" id="line1852">1852</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;statuswin_current=0;</span></span>
<span class="tr"><span class="th" id="line1853">1853</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-status-line">Status Line.</h3><p><p> Despite the name, the status line need not be a single line at the top of the screen: that&#39;s only the conventional default arrangement. It can expand to become the equivalent of an old-fashioned VT220 terminal, with menus and grids and mazes displayed lovingly in character graphics, or it can close up to invisibility.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1874">VM_StatusLineHeight(n)</a></span> sets the status line to have a height of <span class="fixed">n</span> lines of type. (The width of the status line is always the width of the whole screen, and the position is always at the top, so the height is the only controllable aspect.) The <em>n=0</em> case makes the status line disappear.<p></p><p> <span class="fixed"><a href="./Glulx.i6t.html#line1881">VM_MoveCursorInStatusLine(x, y)</a></span> switches printing to the status line, positioning the &quot;cursor&quot; &ndash; the position at which printing will begin &ndash; at the given character grid position <em>(x, y)</em>. Line 1 represents the top line; line 2 is underneath, and so on; columns are similarly numbered from 1 at the left.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1874">1874</span><span class="td">[&nbsp;VM_StatusLineHeight&nbsp;hgt;</span></span>
<span class="tr"><span class="th" id="line1875">1875</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_statuswin&nbsp;==&nbsp;0)&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1876">1876</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(hgt&nbsp;==&nbsp;statuswin_cursize)&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1877">1877</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_window_set_arrangement(glk_window_get_parent(gg_statuswin),&nbsp;$12,&nbsp;hgt,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1878">1878</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;statuswin_cursize&nbsp;=&nbsp;hgt;</span></span>
<span class="tr"><span class="th" id="line1879">1879</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1880">1880</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1881">1881</span><span class="td">[&nbsp;VM_MoveCursorInStatusLine&nbsp;line&nbsp;column;</span></span>
<span class="tr"><span class="th" id="line1882">1882</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_statuswin&nbsp;==&nbsp;0)&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line1883">1883</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_set_window(gg_statuswin);</span></span>
<span class="tr"><span class="th" id="line1884">1884</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(line&nbsp;==&nbsp;0)&nbsp;{&nbsp;line&nbsp;=&nbsp;1;&nbsp;column&nbsp;=&nbsp;1;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1885">1885</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;glk_window_move_cursor(gg_statuswin,&nbsp;column-1,&nbsp;line-1);</span></span>
<span class="tr"><span class="th" id="line1886">1886</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;statuswin_current=1;</span></span>
<span class="tr"><span class="th" id="line1887">1887</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-quotation-boxes">Quotation Boxes.</h3><p><p> On the Z-machine, quotation boxes are produced by stretching the status line, but on Glulx they usually occupy windows of their own. If it isn&#39;t possible to create such a window, so that <span class="fixed"><a href="./Glulx.i6t.html#line25">gg_quotewin</a></span> is zero below, the quotation text just appears in the main window.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1896">1896</span><span class="td">[&nbsp;Box__Routine&nbsp;maxwid&nbsp;arr&nbsp;ix&nbsp;lines&nbsp;lastnl&nbsp;parwin;</span></span>
<span class="tr"><span class="th" id="line1897">1897</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;maxwid&nbsp;=&nbsp;0;&nbsp;!&nbsp;squash&nbsp;compiler&nbsp;warning</span></span>
<span class="tr"><span class="th" id="line1898">1898</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;lines&nbsp;=&nbsp;arr--&gt;0;</span></span>
<span class="tr"><span class="th" id="line1899">1899</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1900">1900</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_quotewin&nbsp;==&nbsp;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1901">1901</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_arguments--&gt;0&nbsp;=&nbsp;lines;</span></span>
<span class="tr"><span class="th" id="line1902">1902</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ix&nbsp;=&nbsp;InitGlkWindow(GG_QUOTEWIN_ROCK);</span></span>
<span class="tr"><span class="th" id="line1903">1903</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ix&nbsp;==&nbsp;0)</span></span>
<span class="tr"><span class="th" id="line1904">1904</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg_quotewin&nbsp;=</span></span>
<span class="tr"><span class="th" id="line1905">1905</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_open(gg_mainwin,&nbsp;winmethod_Fixed&nbsp;+&nbsp;winmethod_Above,</span></span>
<span class="tr"><span class="th" id="line1906">1906</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lines,&nbsp;wintype_TextBuffer,&nbsp;GG_QUOTEWIN_ROCK);</span></span>
<span class="tr"><span class="th" id="line1907">1907</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1908">1908</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parwin&nbsp;=&nbsp;glk_window_get_parent(gg_quotewin);</span></span>
<span class="tr"><span class="th" id="line1909">1909</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_set_arrangement(parwin,&nbsp;$12,&nbsp;lines,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line1910">1910</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1911">1911</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1912">1912</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;lastnl&nbsp;=&nbsp;true;</span></span>
<span class="tr"><span class="th" id="line1913">1913</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_quotewin)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1914">1914</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_window_clear(gg_quotewin);</span></span>
<span class="tr"><span class="th" id="line1915">1915</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glk_set_window(gg_quotewin);</span></span>
<span class="tr"><span class="th" id="line1916">1916</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastnl&nbsp;=&nbsp;false;</span></span>
<span class="tr"><span class="th" id="line1917">1917</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1918">1918</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1919">1919</span><span class="td">&nbsp;VM_Style(BLOCKQUOTE_VMSTY);</span></span>
<span class="tr"><span class="th" id="line1920">1920</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(ix=0&nbsp;:&nbsp;ix&lt;lines&nbsp;:&nbsp;ix++)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1921">1921</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(string)&nbsp;arr--&gt;(ix+1);</span></span>
<span class="tr"><span class="th" id="line1922">1922</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(ix&nbsp;&lt;&nbsp;lines-1&nbsp;||&nbsp;lastnl)&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line1923">1923</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1924">1924</span><span class="td">&nbsp;VM_Style(NORMAL_VMSTY);</span></span>
<span class="tr"><span class="th" id="line1925">1925</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1926">1926</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(gg_quotewin)&nbsp;glk_set_window(gg_mainwin);</span></span>
<span class="tr"><span class="th" id="line1927">1927</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-glklist-command">GlkList Command.</h3><p><p> GLKLIST is a testing command best used by those who understand Glulx and its ways: it isn&#39;t documented in the I7 manual, because it is pretty inscrutable for &quot;real&quot; users, but it&#39;s probably worth keeping just the same.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1935">1935</span><span class="td">#Ifdef&nbsp;DEBUG;</span></span>
<span class="tr"><span class="th" id="line1936">1936</span><span class="td">[&nbsp;GlkListSub&nbsp;id&nbsp;val;</span></span>
<span class="tr"><span class="th" id="line1937">1937</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_window_iterate(0,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1938">1938</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(id)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1939">1939</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Window&nbsp;&quot;,&nbsp;id,&nbsp;&quot;&nbsp;(&quot;,&nbsp;gg_arguments--&gt;0,&nbsp;&quot;):&nbsp;&quot;;</span></span>
<span class="tr"><span class="th" id="line1940">1940</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;=&nbsp;glk_window_get_type(id);</span></span>
<span class="tr"><span class="th" id="line1941">1941</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(val)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1942">1942</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1:&nbsp;print&nbsp;&quot;pair&quot;;</span></span>
<span class="tr"><span class="th" id="line1943">1943</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2:&nbsp;print&nbsp;&quot;blank&quot;;</span></span>
<span class="tr"><span class="th" id="line1944">1944</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3:&nbsp;print&nbsp;&quot;textbuffer&quot;;</span></span>
<span class="tr"><span class="th" id="line1945">1945</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4:&nbsp;print&nbsp;&quot;textgrid&quot;;</span></span>
<span class="tr"><span class="th" id="line1946">1946</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5:&nbsp;print&nbsp;&quot;graphics&quot;;</span></span>
<span class="tr"><span class="th" id="line1947">1947</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;print&nbsp;&quot;unknown&quot;;</span></span>
<span class="tr"><span class="th" id="line1948">1948</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1949">1949</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;=&nbsp;glk_window_get_parent(id);</span></span>
<span class="tr"><span class="th" id="line1950">1950</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(val)&nbsp;print&nbsp;&quot;,&nbsp;parent&nbsp;is&nbsp;window&nbsp;&quot;,&nbsp;val;</span></span>
<span class="tr"><span class="th" id="line1951">1951</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;,&nbsp;no&nbsp;parent&nbsp;(root)&quot;;</span></span>
<span class="tr"><span class="th" id="line1952">1952</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;=&nbsp;glk_window_get_stream(id);</span></span>
<span class="tr"><span class="th" id="line1953">1953</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;,&nbsp;stream&nbsp;&quot;,&nbsp;val;</span></span>
<span class="tr"><span class="th" id="line1954">1954</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;=&nbsp;glk_window_get_echo_stream(id);</span></span>
<span class="tr"><span class="th" id="line1955">1955</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(val)&nbsp;print&nbsp;&quot;,&nbsp;echo&nbsp;stream&nbsp;&quot;,&nbsp;val;</span></span>
<span class="tr"><span class="th" id="line1956">1956</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;^&quot;;</span></span>
<span class="tr"><span class="th" id="line1957">1957</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_window_iterate(id,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1958">1958</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1959">1959</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_stream_iterate(0,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1960">1960</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(id)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1961">1961</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Stream&nbsp;&quot;,&nbsp;id,&nbsp;&quot;&nbsp;(&quot;,&nbsp;gg_arguments--&gt;0,&nbsp;&quot;)^&quot;;</span></span>
<span class="tr"><span class="th" id="line1962">1962</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_stream_iterate(id,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1963">1963</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1964">1964</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_fileref_iterate(0,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1965">1965</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(id)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1966">1966</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Fileref&nbsp;&quot;,&nbsp;id,&nbsp;&quot;&nbsp;(&quot;,&nbsp;gg_arguments--&gt;0,&nbsp;&quot;)^&quot;;</span></span>
<span class="tr"><span class="th" id="line1967">1967</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_fileref_iterate(id,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1968">1968</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1969">1969</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(glk_gestalt(gestalt_Sound,&nbsp;0))&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1970">1970</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_schannel_iterate(0,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1971">1971</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(id)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line1972">1972</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Soundchannel&nbsp;&quot;,&nbsp;id,&nbsp;&quot;&nbsp;(&quot;,&nbsp;gg_arguments--&gt;0,&nbsp;&quot;)^&quot;;</span></span>
<span class="tr"><span class="th" id="line1973">1973</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;=&nbsp;glk_schannel_iterate(id,&nbsp;gg_arguments);</span></span>
<span class="tr"><span class="th" id="line1974">1974</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1975">1975</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1976">1976</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1977">1977</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1978">1978</span><span class="td">{-testing-command:glklist}</span></span>
<span class="tr"><span class="th" id="line1979">1979</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;Glklist;</span></span>
<span class="tr"><span class="th" id="line1980">1980</span><span class="td">#Endif;</span></span>
</div><div class='text'>
<h3 id="#glulx-undo">Undo.</h3><p><p> These are really emulations of the Z-machine&#39;s conventions on UNDO: Glulx&#39;s undo opcodes used different result codes while providing essentially the same functionality, for reasons which are opaque, but no trouble is caused thereby.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line1988">1988</span><span class="td">[&nbsp;VM_Undo&nbsp;result_code;</span></span>
<span class="tr"><span class="th" id="line1989">1989</span><span class="td">&nbsp;@restoreundo&nbsp;result_code;</span></span>
<span class="tr"><span class="th" id="line1990">1990</span><span class="td">&nbsp;return&nbsp;(~~result_code);</span></span>
<span class="tr"><span class="th" id="line1991">1991</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line1992">1992</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line1993">1993</span><span class="td">[&nbsp;VM_Save_Undo&nbsp;result_code;</span></span>
<span class="tr"><span class="th" id="line1994">1994</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;@saveundo&nbsp;result_code;</span></span>
<span class="tr"><span class="th" id="line1995">1995</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result_code&nbsp;==&nbsp;-1)&nbsp;{&nbsp;GGRecoverObjects();&nbsp;return&nbsp;2;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line1996">1996</span><span class="td">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(~~result_code);</span></span>
<span class="tr"><span class="th" id="line1997">1997</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-quit-the-game-rule">Quit The Game Rule.</h3><p><p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line2002">2002</span><span class="td">[&nbsp;QUIT_THE_GAME_R;</span></span>
<span class="tr"><span class="th" id="line2003">2003</span><span class="td">&nbsp;if&nbsp;(actor&nbsp;~=&nbsp;player)&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line2004">2004</span><span class="td">&nbsp;if&nbsp;((actor&nbsp;==&nbsp;player)&nbsp;&amp;&amp;&nbsp;(untouchable_silence&nbsp;==&nbsp;false))</span></span>
<span class="tr"><span class="th" id="line2005">2005</span><span class="td">&nbsp;&nbsp;QUIT_THE_GAME_RM(&#39;A&#39;);</span></span>
<span class="tr"><span class="th" id="line2006">2006</span><span class="td">&nbsp;if&nbsp;(YesOrNo()~=0)&nbsp;quit;</span></span>
<span class="tr"><span class="th" id="line2007">2007</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-restart-the-game-rule">Restart The Game Rule.</h3><p><p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line2012">2012</span><span class="td">[&nbsp;RESTART_THE_GAME_R;</span></span>
<span class="tr"><span class="th" id="line2013">2013</span><span class="td">&nbsp;if&nbsp;(actor&nbsp;~=&nbsp;player)&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line2014">2014</span><span class="td">&nbsp;RESTART_THE_GAME_RM(&#39;A&#39;);</span></span>
<span class="tr"><span class="th" id="line2015">2015</span><span class="td">&nbsp;if&nbsp;(YesOrNo()~=0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line2016">2016</span><span class="td">&nbsp;&nbsp;@restart;</span></span>
<span class="tr"><span class="th" id="line2017">2017</span><span class="td">&nbsp;&nbsp;RESTART_THE_GAME_RM(&#39;B&#39;);&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line2018">2018</span><span class="td">&nbsp;}</span></span>
<span class="tr"><span class="th" id="line2019">2019</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-restore-the-game-rule">Restore The Game Rule.</h3><p><p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line2024">2024</span><span class="td">[&nbsp;RESTORE_THE_GAME_R&nbsp;res&nbsp;fref;</span></span>
<span class="tr"><span class="th" id="line2025">2025</span><span class="td">&nbsp;if&nbsp;(actor&nbsp;~=&nbsp;player)&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line2026">2026</span><span class="td">&nbsp;fref&nbsp;=&nbsp;glk_fileref_create_by_prompt($01,&nbsp;$02,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line2027">2027</span><span class="td">&nbsp;if&nbsp;(fref&nbsp;==&nbsp;0)&nbsp;jump&nbsp;<a href="./Glulx.i6t.html#line2034">RFailed</a>;</span></span>
<span class="tr"><span class="th" id="line2028">2028</span><span class="td">&nbsp;gg_savestr&nbsp;=&nbsp;glk_stream_open_file(fref,&nbsp;$02,&nbsp;GG_SAVESTR_ROCK);</span></span>
<span class="tr"><span class="th" id="line2029">2029</span><span class="td">&nbsp;glk_fileref_destroy(fref);</span></span>
<span class="tr"><span class="th" id="line2030">2030</span><span class="td">&nbsp;if&nbsp;(gg_savestr&nbsp;==&nbsp;0)&nbsp;jump&nbsp;<a href="./Glulx.i6t.html#line2034">RFailed</a>;</span></span>
<span class="tr"><span class="th" id="line2031">2031</span><span class="td">&nbsp;@restore&nbsp;gg_savestr&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line2032">2032</span><span class="td">&nbsp;glk_stream_close(gg_savestr,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line2033">2033</span><span class="td">&nbsp;gg_savestr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line2034">2034</span><span class="td">&nbsp;.RFailed;</span></span>
<span class="tr"><span class="th" id="line2035">2035</span><span class="td">&nbsp;RESTORE_THE_GAME_RM(&#39;A&#39;);&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line2036">2036</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-save-the-game-rule">Save The Game Rule.</h3><p><p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line2041">2041</span><span class="td">[&nbsp;SAVE_THE_GAME_R&nbsp;res&nbsp;fref;</span></span>
<span class="tr"><span class="th" id="line2042">2042</span><span class="td">&nbsp;if&nbsp;(actor&nbsp;~=&nbsp;player)&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line2043">2043</span><span class="td">&nbsp;fref&nbsp;=&nbsp;glk_fileref_create_by_prompt($01,&nbsp;$01,&nbsp;0);</span></span>
<span class="tr"><span class="th" id="line2044">2044</span><span class="td">&nbsp;if&nbsp;(fref&nbsp;==&nbsp;0)&nbsp;jump&nbsp;<a href="./Glulx.i6t.html#line2061">SFailed</a>;</span></span>
<span class="tr"><span class="th" id="line2045">2045</span><span class="td">&nbsp;gg_savestr&nbsp;=&nbsp;glk_stream_open_file(fref,&nbsp;$01,&nbsp;GG_SAVESTR_ROCK);</span></span>
<span class="tr"><span class="th" id="line2046">2046</span><span class="td">&nbsp;glk_fileref_destroy(fref);</span></span>
<span class="tr"><span class="th" id="line2047">2047</span><span class="td">&nbsp;if&nbsp;(gg_savestr&nbsp;==&nbsp;0)&nbsp;jump&nbsp;<a href="./Glulx.i6t.html#line2061">SFailed</a>;</span></span>
<span class="tr"><span class="th" id="line2048">2048</span><span class="td">&nbsp;@save&nbsp;gg_savestr&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line2049">2049</span><span class="td">&nbsp;if&nbsp;(res&nbsp;==&nbsp;-1)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line2050">2050</span><span class="td">&nbsp;&nbsp;!&nbsp;The&nbsp;player&nbsp;actually&nbsp;just&nbsp;typed&nbsp;&quot;restore&quot;.&nbsp;We&nbsp;first&nbsp;have&nbsp;to&nbsp;recover</span></span>
<span class="tr"><span class="th" id="line2051">2051</span><span class="td">&nbsp;&nbsp;!&nbsp;all&nbsp;the&nbsp;Glk&nbsp;objects;&nbsp;the&nbsp;values&nbsp;in&nbsp;our&nbsp;global&nbsp;variables&nbsp;are&nbsp;all&nbsp;wrong.</span></span>
<span class="tr"><span class="th" id="line2052">2052</span><span class="td">&nbsp;&nbsp;GGRecoverObjects();</span></span>
<span class="tr"><span class="th" id="line2053">2053</span><span class="td">&nbsp;&nbsp;glk_stream_close(gg_savestr,&nbsp;0);&nbsp;!&nbsp;stream_close</span></span>
<span class="tr"><span class="th" id="line2054">2054</span><span class="td">&nbsp;&nbsp;gg_savestr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line2055">2055</span><span class="td">&nbsp;&nbsp;RESTORE_THE_GAME_RM(&#39;B&#39;);&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line2056">2056</span><span class="td">&nbsp;&nbsp;rtrue;</span></span>
<span class="tr"><span class="th" id="line2057">2057</span><span class="td">&nbsp;}</span></span>
<span class="tr"><span class="th" id="line2058">2058</span><span class="td">&nbsp;glk_stream_close(gg_savestr,&nbsp;0);&nbsp;!&nbsp;stream_close</span></span>
<span class="tr"><span class="th" id="line2059">2059</span><span class="td">&nbsp;gg_savestr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line2060">2060</span><span class="td">&nbsp;if&nbsp;(res&nbsp;==&nbsp;0)&nbsp;{&nbsp;SAVE_THE_GAME_RM(&#39;B&#39;);&nbsp;new_line;&nbsp;rtrue;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line2061">2061</span><span class="td">&nbsp;.SFailed;</span></span>
<span class="tr"><span class="th" id="line2062">2062</span><span class="td">&nbsp;SAVE_THE_GAME_RM(&#39;A&#39;);&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line2063">2063</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-verify-the-story-file-rule">Verify The Story File Rule.</h3><p><p> This is a fossil now, really, but in the days of Infocom, the 110K story file occupying an entire disc was a huge data set: floppy discs were by no means a reliable medium, and cheap hardware often used hit-and-miss components, as on the notorious Commodore 64 disc controller. If somebody experienced an apparent bug in play, it could easily be that he had a corrupt disc or was unable to read data of that density. So the VERIFY command, which took up to ten minutes on some early computers, would chug through the entire story file and compute a checksum, compare it against a known result in the header, and determine that the story file could or could not properly be read. The Z-machine provided this service as an opcode, and so Glulx followed suit.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line2079">2079</span><span class="td">[&nbsp;VERIFY_THE_STORY_FILE_R&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line2080">2080</span><span class="td">&nbsp;if&nbsp;(actor&nbsp;~=&nbsp;player)&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line2081">2081</span><span class="td">&nbsp;@verify&nbsp;res;</span></span>
<span class="tr"><span class="th" id="line2082">2082</span><span class="td">&nbsp;if&nbsp;(res&nbsp;==&nbsp;0)&nbsp;{&nbsp;VERIFY_THE_STORY_FILE_RM(&#39;A&#39;);&nbsp;new_line;&nbsp;rtrue;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line2083">2083</span><span class="td">&nbsp;VERIFY_THE_STORY_FILE_RM(&#39;B&#39;);&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line2084">2084</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-switch-transcript-on-rule">Switch Transcript On Rule.</h3><p><p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line2089">2089</span><span class="td">[&nbsp;SWITCH_TRANSCRIPT_ON_R;</span></span>
<span class="tr"><span class="th" id="line2090">2090</span><span class="td">&nbsp;if&nbsp;(actor&nbsp;~=&nbsp;player)&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line2091">2091</span><span class="td">&nbsp;if&nbsp;(gg_scriptstr&nbsp;~=&nbsp;0)&nbsp;{&nbsp;SWITCH_TRANSCRIPT_ON_RM(&#39;A&#39;);&nbsp;new_line;&nbsp;rtrue;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line2092">2092</span><span class="td">&nbsp;if&nbsp;(gg_scriptfref&nbsp;==&nbsp;0)&nbsp;{</span></span>
<span class="tr"><span class="th" id="line2093">2093</span><span class="td">&nbsp;&nbsp;gg_scriptfref&nbsp;=&nbsp;glk_fileref_create_by_prompt($102,&nbsp;$05,&nbsp;GG_SCRIPTFREF_ROCK);</span></span>
<span class="tr"><span class="th" id="line2094">2094</span><span class="td">&nbsp;&nbsp;if&nbsp;(gg_scriptfref&nbsp;==&nbsp;0)&nbsp;jump&nbsp;<a href="./Glulx.i6t.html#line2103">S1Failed</a>;</span></span>
<span class="tr"><span class="th" id="line2095">2095</span><span class="td">&nbsp;}</span></span>
<span class="tr"><span class="th" id="line2096">2096</span><span class="td">&nbsp;!&nbsp;stream_open_file</span></span>
<span class="tr"><span class="th" id="line2097">2097</span><span class="td">&nbsp;gg_scriptstr&nbsp;=&nbsp;glk_stream_open_file(gg_scriptfref,&nbsp;$05,&nbsp;GG_SCRIPTSTR_ROCK);</span></span>
<span class="tr"><span class="th" id="line2098">2098</span><span class="td">&nbsp;if&nbsp;(gg_scriptstr&nbsp;==&nbsp;0)&nbsp;jump&nbsp;<a href="./Glulx.i6t.html#line2103">S1Failed</a>;</span></span>
<span class="tr"><span class="th" id="line2099">2099</span><span class="td">&nbsp;glk_window_set_echo_stream(gg_mainwin,&nbsp;gg_scriptstr);</span></span>
<span class="tr"><span class="th" id="line2100">2100</span><span class="td">&nbsp;SWITCH_TRANSCRIPT_ON_RM(&#39;B&#39;);&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line2101">2101</span><span class="td">&nbsp;VersionSub();</span></span>
<span class="tr"><span class="th" id="line2102">2102</span><span class="td">&nbsp;return;</span></span>
<span class="tr"><span class="th" id="line2103">2103</span><span class="td">&nbsp;.S1Failed;</span></span>
<span class="tr"><span class="th" id="line2104">2104</span><span class="td">&nbsp;SWITCH_TRANSCRIPT_ON_RM(&#39;C&#39;);&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line2105">2105</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-switch-transcript-off-rule">Switch Transcript Off Rule.</h3><p><p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line2110">2110</span><span class="td">[&nbsp;SWITCH_TRANSCRIPT_OFF_R;</span></span>
<span class="tr"><span class="th" id="line2111">2111</span><span class="td">&nbsp;if&nbsp;(actor&nbsp;~=&nbsp;player)&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line2112">2112</span><span class="td">&nbsp;if&nbsp;(gg_scriptstr&nbsp;==&nbsp;0)&nbsp;{&nbsp;SWITCH_TRANSCRIPT_OFF_RM(&#39;A&#39;);&nbsp;new_line;&nbsp;rtrue;&nbsp;}</span></span>
<span class="tr"><span class="th" id="line2113">2113</span><span class="td">&nbsp;SWITCH_TRANSCRIPT_OFF_RM(&#39;B&#39;);&nbsp;new_line;</span></span>
<span class="tr"><span class="th" id="line2114">2114</span><span class="td">&nbsp;glk_stream_close(gg_scriptstr,&nbsp;0);&nbsp;!&nbsp;stream_close</span></span>
<span class="tr"><span class="th" id="line2115">2115</span><span class="td">&nbsp;gg_scriptstr&nbsp;=&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line2116">2116</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-announce-story-file-version-rule">Announce Story File Version Rule.</h3><p><p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line2121">2121</span><span class="td">[&nbsp;ANNOUNCE_STORY_FILE_VERSION_R&nbsp;ix;</span></span>
<span class="tr"><span class="th" id="line2122">2122</span><span class="td">&nbsp;if&nbsp;(actor&nbsp;~=&nbsp;player)&nbsp;rfalse;</span></span>
<span class="tr"><span class="th" id="line2123">2123</span><span class="td">&nbsp;Banner();</span></span>
<span class="tr"><span class="th" id="line2124">2124</span><span class="td">&nbsp;print&nbsp;&quot;Identification&nbsp;number:&nbsp;&quot;;</span></span>
<span class="tr"><span class="th" id="line2125">2125</span><span class="td">&nbsp;for&nbsp;(ix=6:&nbsp;ix&nbsp;&lt;=&nbsp;UUID_ARRAY-&gt;0:&nbsp;ix++)&nbsp;print&nbsp;(char)&nbsp;UUID_ARRAY-&gt;ix;</span></span>
<span class="tr"><span class="th" id="line2126">2126</span><span class="td">&nbsp;print&nbsp;&quot;^&quot;;</span></span>
<span class="tr"><span class="th" id="line2127">2127</span><span class="td">&nbsp;@gestalt&nbsp;1&nbsp;0&nbsp;ix;</span></span>
<span class="tr"><span class="th" id="line2128">2128</span><span class="td">&nbsp;print&nbsp;&quot;Interpreter&nbsp;version&nbsp;&quot;,&nbsp;ix&nbsp;/&nbsp;$10000,&nbsp;&quot;.&quot;,&nbsp;(ix&nbsp;&amp;&nbsp;$FF00)&nbsp;/&nbsp;$100,</span></span>
<span class="tr"><span class="th" id="line2129">2129</span><span class="td">&nbsp;&quot;.&quot;,&nbsp;ix&nbsp;&amp;&nbsp;$FF,&nbsp;&quot;&nbsp;/&nbsp;&quot;;</span></span>
<span class="tr"><span class="th" id="line2130">2130</span><span class="td">&nbsp;@gestalt&nbsp;0&nbsp;0&nbsp;ix;</span></span>
<span class="tr"><span class="th" id="line2131">2131</span><span class="td">&nbsp;print&nbsp;&quot;VM&nbsp;&quot;,&nbsp;ix&nbsp;/&nbsp;$10000,&nbsp;&quot;.&quot;,&nbsp;(ix&nbsp;&amp;&nbsp;$FF00)&nbsp;/&nbsp;$100,&nbsp;&quot;.&quot;,&nbsp;ix&nbsp;&amp;&nbsp;$FF,&nbsp;&quot;&nbsp;/&nbsp;&quot;;</span></span>
<span class="tr"><span class="th" id="line2132">2132</span><span class="td">&nbsp;print&nbsp;&quot;Library&nbsp;serial&nbsp;number&nbsp;&quot;,&nbsp;(string)&nbsp;LibSerial,&nbsp;&quot;^&quot;;</span></span>
<span class="tr"><span class="th" id="line2133">2133</span><span class="td">&nbsp;#Ifdef&nbsp;LanguageVersion;</span></span>
<span class="tr"><span class="th" id="line2134">2134</span><span class="td">&nbsp;print&nbsp;(string)&nbsp;LanguageVersion,&nbsp;&quot;^&quot;;</span></span>
<span class="tr"><span class="th" id="line2135">2135</span><span class="td">&nbsp;#Endif;&nbsp;!&nbsp;LanguageVersion</span></span>
<span class="tr"><span class="th" id="line2136">2136</span><span class="td">&nbsp;ShowExtensionVersions();</span></span>
<span class="tr"><span class="th" id="line2137">2137</span><span class="td">&nbsp;say__p&nbsp;=&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line2138">2138</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-descend-to-specific-action-rule">Descend To Specific Action Rule.</h3><p><p> There are 100 or so actions, typically, and this rule is for efficiency&#39;s sake: rather than perform 100 or so comparisons to see which routine tocall, we indirect through a jump table. The routines called are the <span class="fixed">-Sub</span><br> routines: thus, for instance, if <span class="fixed"><a href="./Output.i6t.html#line240">action</a></span> is <span class="fixed">##Wait</span> then <span class="fixed">WaitSub</span> is called. It is essential that this routine not be called for fake actions: in I7 use this is guaranteed, since fake actions are not allowed into the action machinery at all.<p></p><p> Strangely, Glulx&#39;s action routines table is numbered in an off-by-one way compared to the Z-machine&#39;s: hence the <span class="fixed">+1</span>.<p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line2153">2153</span><span class="td">[&nbsp;DESCEND_TO_SPECIFIC_ACTION_R;</span></span>
<span class="tr"><span class="th" id="line2154">2154</span><span class="td">&nbsp;indirect(#actions_table--&gt;(action+1));</span></span>
<span class="tr"><span class="th" id="line2155">2155</span><span class="td">&nbsp;rtrue;</span></span>
<span class="tr"><span class="th" id="line2156">2156</span><span class="td">];</span></span>
</div><div class='text'>
<h3 id="#glulx-veneer">Veneer.</h3><p><p></p><p></div><div class="pre">
<span class="tr"><span class="th" id="line2161">2161</span><span class="td">[&nbsp;Unsigned__Compare&nbsp;x&nbsp;y;</span></span>
<span class="tr"><span class="th" id="line2162">2162</span><span class="td">&nbsp;@jleu&nbsp;x&nbsp;y&nbsp;?lesseq;</span></span>
<span class="tr"><span class="th" id="line2163">2163</span><span class="td">&nbsp;return&nbsp;1;</span></span>
<span class="tr"><span class="th" id="line2164">2164</span><span class="td">&nbsp;.lesseq;</span></span>
<span class="tr"><span class="th" id="line2165">2165</span><span class="td">&nbsp;@jeq&nbsp;x&nbsp;y&nbsp;?equal;</span></span>
<span class="tr"><span class="th" id="line2166">2166</span><span class="td">&nbsp;return&nbsp;-1;</span></span>
<span class="tr"><span class="th" id="line2167">2167</span><span class="td">&nbsp;.equal;</span></span>
<span class="tr"><span class="th" id="line2168">2168</span><span class="td">&nbsp;return&nbsp;0;</span></span>
<span class="tr"><span class="th" id="line2169">2169</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line2170">2170</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line2171">2171</span><span class="td">[&nbsp;RT__ChLDW&nbsp;x&nbsp;y;</span></span>
<span class="tr"><span class="th" id="line2172">2172</span><span class="td">&nbsp;@aload&nbsp;x&nbsp;y&nbsp;sp;</span></span>
<span class="tr"><span class="th" id="line2173">2173</span><span class="td">&nbsp;@return&nbsp;sp;</span></span>
<span class="tr"><span class="th" id="line2174">2174</span><span class="td">];</span></span>
<span class="tr"><span class="th" id="line2175">2175</span><span class="td"></span></span>
<span class="tr"><span class="th" id="line2176">2176</span><span class="td">[&nbsp;RT__ChLDB&nbsp;x&nbsp;y;</span></span>
<span class="tr"><span class="th" id="line2177">2177</span><span class="td">&nbsp;@aloadb&nbsp;x&nbsp;y&nbsp;sp;</span></span>
<span class="tr"><span class="th" id="line2178">2178</span><span class="td">&nbsp;@return&nbsp;sp;</span></span>
<span class="tr"><span class="th" id="line2179">2179</span><span class="td">];</span></span>
</div><footer><hr><p><em>From I6T lib 6/12N &copy; Graham Nelson and published under the <a href="https://github.com/zedlopez/standard_rules/blob/main/LICENSE.md">Artistic License 2.0</a>. Distributed with <a href="http://inform7.com/">Inform 7 6M62</a>.</em></p></footer></body></html>
